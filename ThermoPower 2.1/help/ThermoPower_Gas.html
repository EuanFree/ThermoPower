<HTML>
<HEAD>
<TITLE>ThermoPower.Gas</TITLE>
<META name="HTML-Generator" content="Dymola">
<META name="description" content="&quot;Models of components with ideal gases as working fluid&quot;">
</HEAD>
<BODY><P>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Gas<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="ThermoPower.Gas"></A><A HREF="ThermoPower.html#ThermoPower"
>ThermoPower</A>.Gas</H2>
<B>Models of components with ideal gases as working fluid</B>
<P>
<H3>Information</H3>
<PRE></pre>
This package contains models of physical processes and components using ideal gases as working fluid.
<p>All models with dynamic equations provide initialisation support. Set the <tt>initOpt</tt> parameter to the appropriate value:
<ul>
<li><tt>Choices.Init.Options.noInit</tt>: no initialisation
<li><tt>Choices.Init.Options.steadyState</tt>: full steady-state initialisation
<li><tt>Choices.Init.Options.steadyStateNoP</tt>: steady-state initialisation (except pressure)
<li><tt>Choices.Init.Options.steadyStateNoT</tt>: steady-state initialisation (except temperature)
</ul>
The latter options can be useful when two or more components are connected directly so that they will have the same pressure or temperature, to avoid over-specified systems of initial equations.
<pre></PRE><P>
<H3>Package Content</H3><p>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2 >
<TR><TH >Name</TH><TH>Description</TH></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.FlangeS.png" ALT="ThermoPower.Gas.Flange" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.Flange"
>Flange</A>
</TD><TD>Generic flange connector for gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.FlangeAS.png" ALT="ThermoPower.Gas.FlangeA" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A>
</TD><TD>A-type flange connector for gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.FlangeBS.png" ALT="ThermoPower.Gas.FlangeB" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A>
</TD><TD>B-type flange connector for gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.SourcePS.png" ALT="ThermoPower.Gas.SourceP" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.SourceP"
>SourceP</A>
</TD><TD>Pressure source for gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.SinkPS.png" ALT="ThermoPower.Gas.SinkP" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.SinkP"
>SinkP</A>
</TD><TD>Pressure sink for gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.SourceWS.png" ALT="ThermoPower.Gas.SourceW" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.SourceW"
>SourceW</A>
</TD><TD>Flowrate source for gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.SinkWS.png" ALT="ThermoPower.Gas.SinkW" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.SinkW"
>SinkW</A>
</TD><TD>Flowrate sink for gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.ThroughWS.png" ALT="ThermoPower.Gas.ThroughW" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.ThroughW"
>ThroughW</A>
</TD><TD>Prescribes the flow rate across the component</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.PlenumS.png" ALT="ThermoPower.Gas.Plenum" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.Plenum"
>Plenum</A>
</TD><TD>Rigid adiabatic volume</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.PlenumS.png" ALT="ThermoPower.Gas.Header" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.Header"
>Header</A>
</TD><TD>Header with metal walls for gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.MixerS.png" ALT="ThermoPower.Gas.Mixer" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.Mixer"
>Mixer</A>
</TD><TD>Mixer with metal walls for gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.FlowJoinS.png" ALT="ThermoPower.Gas.FlowJoin" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlowJoin"
>FlowJoin</A>
</TD><TD>Joins two gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.FlowSplitS.png" ALT="ThermoPower.Gas.FlowSplit" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlowSplit"
>FlowSplit</A>
</TD><TD>Splits a gas flow in two</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.PressDropLinS.png" ALT="ThermoPower.Gas.PressDropLin" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.PressDropLin"
>PressDropLin</A>
</TD><TD>Linear pressure drop for gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.PressDropLinS.png" ALT="ThermoPower.Gas.PressDrop" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.PressDrop"
>PressDrop</A>
</TD><TD>Pressure drop for gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.SensTS.png" ALT="ThermoPower.Gas.SensT" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.SensT"
>SensT</A>
</TD><TD>Temperature sensor for gas</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.SensWS.png" ALT="ThermoPower.Gas.SensW" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.SensW"
>SensW</A>
</TD><TD>Mass Flowrate sensor for gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.SensPS.png" ALT="ThermoPower.Gas.SensP" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.SensP"
>SensP</A>
</TD><TD>Pressure sensor for gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.SensQS.png" ALT="ThermoPower.Gas.SensQ" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.SensQ"
>SensQ</A>
</TD><TD>Volume Flow Rate sensor for gas flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.ValveLinS.png" ALT="ThermoPower.Gas.ValveLin" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.ValveLin"
>ValveLin</A>
</TD><TD>Valve for gas flows with linear pressure drop</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.ValveLinS.png" ALT="ThermoPower.Gas.Valve" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.Valve"
>Valve</A>
</TD><TD>Valve for gas flow</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.Flow1DS.png" ALT="ThermoPower.Gas.Flow1D" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.Flow1D"
>Flow1D</A>
</TD><TD>1-dimensional fluid flow model for gas (finite volumes)</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.f_colebrookS.png" ALT="ThermoPower.Gas.f_colebrook" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.f_colebrook"
>f_colebrook</A>
</TD><TD>Fanning friction factor for water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.CombustionChamberBaseS.png" ALT="ThermoPower.Gas.CombustionChamberBase" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.CombustionChamberBase"
>CombustionChamberBase</A>
</TD><TD>Combustion Chamber</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.CombustionChamberBaseS.png" ALT="ThermoPower.Gas.CombustionChamber" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.CombustionChamber"
>CombustionChamber</A>
</TD><TD>Combustion Chamber</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.CompressorBaseS.png" ALT="ThermoPower.Gas.CompressorBase" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.CompressorBase"
>CompressorBase</A>
</TD><TD>Gas compressor</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.CompressorBaseS.png" ALT="ThermoPower.Gas.Compressor" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.Compressor"
>Compressor</A>
</TD><TD>Gas compressor</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.TurbineBaseS.png" ALT="ThermoPower.Gas.TurbineBase" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.TurbineBase"
>TurbineBase</A>
</TD><TD>Gas Turbine</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.TurbineBaseS.png" ALT="ThermoPower.Gas.Turbine" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.Turbine"
>Turbine</A>
</TD><TD>Gas Turbine</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.TurbineBaseS.png" ALT="ThermoPower.Gas.TurbineStodola" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.TurbineStodola"
>TurbineStodola</A>
</TD><TD>Gas Turbine</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.GTunitBaseS.png" ALT="ThermoPower.Gas.GTunitBase" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.GTunitBase"
>GTunitBase</A>
</TD><TD>Gas Turbine</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.GTunitBaseS.png" ALT="ThermoPower.Gas.GTunitExhaustBase" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.GTunitExhaustBase"
>GTunitExhaustBase</A>
</TD><TD>Adds computation of exhaust composition to GTunitBase</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.GTunitBaseS.png" ALT="ThermoPower.Gas.GTunit_ISO" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.GTunit_ISO"
>GTunit_ISO</A>
</TD><TD>Gas Turbine</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.GTunitBaseS.png" ALT="ThermoPower.Gas.GTunit" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.GTunit"
>GTunit</A>
</TD><TD>Gas Turbine</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.FanBaseS.png" ALT="ThermoPower.Gas.FanBase" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FanBase"
>FanBase</A>
</TD><TD>Base model for fans</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Gas.FanMechS.png" ALT="ThermoPower.Gas.FanMech" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FanMech"
>FanMech</A>
</TD><TD>&nbsp;</TD></TR>
</TABLE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Flange<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.FlangeI.png" ALT="ThermoPower.Gas.Flange" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.Flange"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.Flange</H2>
<B>Generic flange connector for gas flows</B><p>
<H3>Information</H3>
<PRE></pre>
<p>Can be connected either to a type-A (<tt>FlangeA</tt>) or to a type B (<tt>FlangeB</tt>) connector.
<pre></PRE>
<H3>Contents</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>p</TD><TD>Pressure [Pa]</TD></TR>
<TR><TD>flow <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>w</TD><TD>Mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hAB</TD><TD>Enthalpy of fluid flowing from A to B [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hBA</TD><TD>Enthalpy of fluid flowing from B to A [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>MassFraction</A></TD><TD>XAB[Medium.nXi]</TD><TD>[kg/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>MassFraction</A></TD><TD>XBA[Medium.nXi]</TD><TD>[kg/kg]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">connector</font> Flange <font color="darkgreen">&quot;Generic flange connector for gas flows&quot;</font>
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p <font color="darkgreen">&quot;Pressure&quot;</font>;
  <font color="blue">flow </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass flowrate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hAB <font color="darkgreen">&quot;Enthalpy of fluid flowing from A to B&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hBA <font color="darkgreen">&quot;Enthalpy of fluid flowing from B to A&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>Medium.MassFraction</A> XAB[Medium.nXi];
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>Medium.MassFraction</A> XBA[Medium.nXi];

<font color="blue">end </font>Flange;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE FlangeA<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.FlangeAI.png" ALT="ThermoPower.Gas.FlangeA" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.FlangeA"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.FlangeA</H2>
<B>A-type flange connector for gas flows</B><p>
<H3>Information</H3>
<PRE></pre>
<p> Must always be connected to a single type-B connector <tt>FlangeB</tt>.
<pre></PRE>
<H3>Contents</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>p</TD><TD>Pressure [Pa]</TD></TR>
<TR><TD>flow <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>w</TD><TD>Mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hAB</TD><TD>Specific enthalpy of fluid going out [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hBA</TD><TD>Specific enthalpy of entering fluid [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>MassFraction</A></TD><TD>XAB[Medium.nXi]</TD><TD>Composition of fluid going out [kg/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>MassFraction</A></TD><TD>XBA[Medium.nXi]</TD><TD>Composition of entering fluid [kg/kg]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">connector</font> FlangeA <font color="darkgreen">&quot;A-type flange connector for gas flows&quot;</font>
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p <font color="darkgreen">&quot;Pressure&quot;</font>;
  <font color="blue">flow </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass flowrate&quot;</font>;
  <font color="blue">output </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hAB <font color="darkgreen">&quot;Specific enthalpy of fluid going out&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hBA <font color="darkgreen">&quot;Specific enthalpy of entering fluid&quot;</font>;
  <font color="blue">output </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>Medium.MassFraction</A> XAB[Medium.nXi] <font color="darkgreen">&quot;Composition of fluid going out&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>Medium.MassFraction</A> XBA[Medium.nXi] <font color="darkgreen">&quot;Composition of entering fluid&quot;</font>;
<font color="blue">end </font>FlangeA;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE FlangeB<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.FlangeBI.png" ALT="ThermoPower.Gas.FlangeB" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.FlangeB"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.FlangeB</H2>
<B>B-type flange connector for gas flows</B><p>
<H3>Information</H3>
<PRE></pre>
<p> Must always be connected to a single type-A connector <tt>FlangeA</tt>.
<pre></PRE>
<H3>Contents</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>p</TD><TD>Pressure [Pa]</TD></TR>
<TR><TD>flow <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>w</TD><TD>Mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hAB</TD><TD>Specific enthalpy of entering fluid [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hBA</TD><TD>Specific enthalpy of fluid going out [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>MassFraction</A></TD><TD>XAB[Medium.nXi]</TD><TD>Composition of entering fluid [kg/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>MassFraction</A></TD><TD>XBA[Medium.nXi]</TD><TD>Composition of fluid going out [kg/kg]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">connector</font> FlangeB <font color="darkgreen">&quot;B-type flange connector for gas flows&quot;</font>
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p <font color="darkgreen">&quot;Pressure&quot;</font>;
  <font color="blue">flow </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass flowrate&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hAB <font color="darkgreen">&quot;Specific enthalpy of entering fluid&quot;</font>;
  <font color="blue">output </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hBA <font color="darkgreen">&quot;Specific enthalpy of fluid going out&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>Medium.MassFraction</A> XAB[Medium.nXi] <font color="darkgreen">&quot;Composition of entering fluid&quot;</font>;
  <font color="blue">output </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>Medium.MassFraction</A> XBA[Medium.nXi] <font color="darkgreen">&quot;Composition of fluid going out&quot;</font>;
<font color="blue">end </font>FlangeB;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SourceP<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.SourcePI.png" ALT="ThermoPower.Gas.SourceP" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.SourceP"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.SourceP</H2>
<B>Pressure source for gas flows</B><p>
<IMG SRC="ThermoPower.Gas.SourcePD.png" ALT="ThermoPower.Gas.SourceP">
<H3>Information</H3>
<PRE></pre>
<p><b>Modelling options</b></p>
<p>The actual gas used in the component is determined by the replaceable <tt>Medium</tt> package.In the case of multiple componet, variable composition gases, the nominal gas composition is given by <tt>Xnom</tt>, whose default value is <tt>Medium.reference_X</tt> .
<p>If <tt>R</tt> is set to zero, the pressure source is ideal; otherwise, the outlet pressure decreases proportionally to the outgoing flowrate.</p>
<p>If the <tt>in_p</tt> connector is wired, then the source pressure is given by the corresponding signal, otherwise it is fixed to <tt>p0</tt>.</p>
<p>If the <tt>in_T</tt> connector is wired, then the source temperature is given by the corresponding signal, otherwise it is fixed to <tt>T</tt>.</p>
<p>If the <tt>in_X</tt> connector is wired, then the source massfraction is given by the corresponding signal, otherwise it is fixed to <tt>Xnom</tt>.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>p0</TD><TD>101325</TD><TD>Nominal pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.HydraulicResistance"
>HydraulicResistance</A></TD><TD>R</TD><TD>0</TD><TD>Hydraulic resistance [Pa/(kg/s)]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>T</TD><TD>300</TD><TD>Nominal temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xnom[Medium.nX]</TD><TD>Medium.reference_X</TD><TD>Nominal gas composition [1]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>flange</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_p</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_T</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_X[Medium.nX]</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SourceP <font color="darkgreen">&quot;Pressure source for gas flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.SourceP"
>Icons.Gas.SourceP</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas(p(start=p0),T(start=T),Xi(start=Xnom[1:Medium.nXi]));
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> p0=101325 <font color="darkgreen">&quot;Nominal pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.HydraulicResistance"
>HydraulicResistance</A> R=0 <font color="darkgreen">&quot;Hydraulic resistance&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> T=300 <font color="darkgreen">&quot;Nominal temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A> Xnom[Medium.nX]=Medium.reference_X <font color="darkgreen">
    &quot;Nominal gas composition&quot;</font>;

  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> flange(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_p;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_T;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_X[Medium.nX];
<font color="blue">equation </font>
  <font color="blue">if </font>R == 0<font color="blue"> then</font>
    flange.p = gas.p;
  <font color="blue">else</font>
    flange.p = gas.p + flange.w*R;
  <font color="blue">end if</font>;

  gas.p = in_p;
  <font color="blue">if </font><font color="red">cardinality</font>(in_p)==0<font color="blue"> then</font>
    in_p = p0 <font color="darkgreen">&quot;Pressure set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  gas.T = in_T;
  <font color="blue">if </font><font color="red">cardinality</font>(in_T)==0<font color="blue"> then</font>
    in_T = T <font color="darkgreen">&quot;Temperature set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  gas.Xi = in_X[1:Medium.nXi];
  <font color="blue">if </font><font color="red">cardinality</font>(in_X)==0<font color="blue"> then</font>
    in_X = Xnom <font color="darkgreen">&quot;Composition set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  flange.hBA = gas.h;
  flange.XBA = gas.Xi;

<font color="blue">end </font>SourceP;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SinkP<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.SinkPI.png" ALT="ThermoPower.Gas.SinkP" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.SinkP"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.SinkP</H2>
<B>Pressure sink for gas flows</B><p>
<IMG SRC="ThermoPower.Gas.SinkPD.png" ALT="ThermoPower.Gas.SinkP">
<H3>Information</H3>
<PRE></pre>
<p><b>Modelling options</b></p>
<p>The actual gas used in the component is determined by the replaceable <tt>Medium</tt> package. In the case of multiple component, variable composition gases, the nominal gas composition is given by <tt>Xnom</tt>, whose default value is <tt>Medium.reference_X</tt> .
<p>If <tt>R</tt> is set to zero, the pressure sink is ideal; otherwise, the inlet pressure increases proportionally to the outgoing flowrate.</p>
<p>If the <tt>in_p</tt> connector is wired, then the source pressure is given by the corresponding signal, otherwise it is fixed to <tt>p0</tt>.</p>
<p>If the <tt>in_T</tt> connector is wired, then the source temperature is given by the corresponding signal, otherwise it is fixed to <tt>T</tt>.</p>
<p>If the <tt>in_X</tt> connector is wired, then the source massfraction is given by the corresponding signal, otherwise it is fixed to <tt>Xnom</tt>.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>p0</TD><TD>101325</TD><TD>Nominal pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>T</TD><TD>300</TD><TD>Nominal temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xnom[Medium.nX]</TD><TD>Medium.reference_X</TD><TD>Nominal gas composition [1]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.HydraulicResistance"
>HydraulicResistance</A></TD><TD>R</TD><TD>0</TD><TD>Hydraulic Resistance [Pa/(kg/s)]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>flange</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_p</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_T</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_X[Medium.nX]</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SinkP <font color="darkgreen">&quot;Pressure sink for gas flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.SourceP"
>Icons.Gas.SourceP</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas(p(start=p0),T(start=T),Xi(start=Xnom[1:Medium.nXi]));
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> p0=101325 <font color="darkgreen">&quot;Nominal pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> T=300 <font color="darkgreen">&quot;Nominal temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A> Xnom[Medium.nX]=Medium.reference_X <font color="darkgreen">
    &quot;Nominal gas composition&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.HydraulicResistance"
>HydraulicResistance</A> R=0 <font color="darkgreen">&quot;Hydraulic Resistance&quot;</font>;

  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> flange(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_p;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_T;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_X[Medium.nX];
<font color="blue">equation </font>
  <font color="blue">if </font>R == 0<font color="blue"> then</font>
    flange.p = gas.p;
  <font color="blue">else</font>
    flange.p = gas.p + flange.w*R;
  <font color="blue">end if</font>;

  gas.p = in_p;
  <font color="blue">if </font><font color="red">cardinality</font>(in_p)==0<font color="blue"> then</font>
    in_p = p0 <font color="darkgreen">&quot;Pressure set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  gas.T = in_T;
  <font color="blue">if </font><font color="red">cardinality</font>(in_T)==0<font color="blue"> then</font>
    in_T =T <font color="darkgreen">&quot;Temperature set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  gas.Xi = in_X[1:Medium.nXi];
  <font color="blue">if </font><font color="red">cardinality</font>(in_X)==0<font color="blue"> then</font>
    in_X = Xnom <font color="darkgreen">&quot;Composition set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  flange.hAB = gas.h;
  flange.XAB = gas.Xi;

<font color="blue">end </font>SinkP;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SourceW<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.SourceWI.png" ALT="ThermoPower.Gas.SourceW" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.SourceW"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.SourceW</H2>
<B>Flowrate source for gas flows</B><p>
<IMG SRC="ThermoPower.Gas.SourceWD.png" ALT="ThermoPower.Gas.SourceW">
<H3>Information</H3>
<PRE></pre>
<p><b>Modelling options</b></p>
<p>The actual gas used in the component is determined by the replaceable <tt>Medium</tt> package. In the case of multiple component, variable composition gases, the nominal gas composition is given by <tt>Xnom</tt>,whose default value is <tt>Medium.reference_X</tt> .
<p>If <tt>G</tt> is set to zero, the flowrate source is ideal; otherwise, the outgoing flowrate decreases proportionally to the outlet pressure.</p>
<p>If the <tt>in_w0</tt> connector is wired, then the source massflowrate is given by the corresponding signal, otherwise it is fixed to <tt>w0</tt>.</p>
<p>If the <tt>in_T</tt> connector is wired, then the source temperature is given by the corresponding signal, otherwise it is fixed to <tt>T</tt>.</p>
<p>If the <tt>in_X</tt> connector is wired, then the source massfraction is given by the corresponding signal, otherwise it is fixed to <tt>Xnom</tt>.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>p0</TD><TD>101325</TD><TD>Nominal pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>T</TD><TD>300</TD><TD>Nominal temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xnom[Medium.nX]</TD><TD>Medium.reference_X</TD><TD>Nominal gas composition [1]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>w0</TD><TD>0</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.HydraulicConductance"
>HydraulicConductance</A></TD><TD>G</TD><TD>0</TD><TD>HydraulicConductance [(kg/s)/Pa]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>flange</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_w0</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_T</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_X[Medium.nX]</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SourceW <font color="darkgreen">&quot;Flowrate source for gas flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.SourceW"
>Icons.Gas.SourceW</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas(p(start=p0),T(start=T),Xi(start=Xnom[1:Medium.nXi]));
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> p0=101325 <font color="darkgreen">&quot;Nominal pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> T=300 <font color="darkgreen">&quot;Nominal temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A> Xnom[Medium.nX]=Medium.reference_X <font color="darkgreen">
    &quot;Nominal gas composition&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w0=0 <font color="darkgreen">&quot;Nominal mass flowrate&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.HydraulicConductance"
>HydraulicConductance</A> G=0 <font color="darkgreen">&quot;HydraulicConductance&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w;

  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> flange(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_w0;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_T;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_X[Medium.nX];
<font color="blue">equation </font>

  <font color="blue">if </font>G == 0<font color="blue"> then</font>
    flange.w = -w;
  <font color="blue">else</font>
    flange.w = -w + (flange.p - p0)*G;
  <font color="blue">end if</font>;

  w = in_w0;
  <font color="blue">if </font><font color="red">cardinality</font>(in_w0)==0<font color="blue"> then</font>
    in_w0 = w0 <font color="darkgreen">&quot;Flow rate set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  gas.T = in_T;
  <font color="blue">if </font><font color="red">cardinality</font>(in_T)==0<font color="blue"> then</font>
    in_T = T <font color="darkgreen">&quot;Temperature set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  gas.Xi = in_X[1:Medium.nXi];
  <font color="blue">if </font><font color="red">cardinality</font>(in_X)==0<font color="blue"> then</font>
    in_X = Xnom <font color="darkgreen">&quot;Composition set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  flange.p = gas.p;
  flange.hBA = gas.h;
  flange.XBA = gas.Xi;

<font color="blue">end </font>SourceW;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SinkW<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.SinkWI.png" ALT="ThermoPower.Gas.SinkW" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.SinkW"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.SinkW</H2>
<B>Flowrate sink for gas flows</B><p>
<IMG SRC="ThermoPower.Gas.SinkWD.png" ALT="ThermoPower.Gas.SinkW">
<H3>Information</H3>
<PRE></pre>
<p>The actual gas used in the component is determined by the replaceable <tt>GasModel</tt> model. In the case of multiple component, variable composition gases, the nominal gas composition is given by <tt>Xnom</tt>, whose default value is <tt>Medium.reference_X</tt> .
<p>If <tt>G</tt> is set to zero, the flowrate source is ideal; otherwise, the incoming flowrate increases proportionally to the outlet pressure.</p>
<p>If the <tt>in_w0</tt> connector is wired, then the source massflowrate is given by the corresponding signal, otherwise it is fixed to <tt>w0</tt>.</p>
<p>If the <tt>in_T</tt> connector is wired, then the source temperature is given by the corresponding signal, otherwise it is fixed to <tt>T</tt>.</p>
<p>If the <tt>in_X</tt> connector is wired, then the source massfraction is given by the corresponding signal, otherwise it is fixed to <tt>Xnom</tt>.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>p0</TD><TD>101325</TD><TD>Nominal pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>T</TD><TD>300</TD><TD>Nominal Temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xnom[Medium.nX]</TD><TD>Medium.reference_X</TD><TD>Nominal gas composition [1]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>w0</TD><TD>0</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.HydraulicConductance"
>HydraulicConductance</A></TD><TD>G</TD><TD>0</TD><TD>Hydraulic Conductance [(kg/s)/Pa]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_w0</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_T</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_X[Medium.nX]</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>flange</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SinkW <font color="darkgreen">&quot;Flowrate sink for gas flows&quot;</font>

  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.SourceW"
>Icons.Gas.SourceW</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas(p(start=p0),T(start=T),Xi(start=Xnom[1:Medium.nXi]));
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> p0=101325 <font color="darkgreen">&quot;Nominal pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> T=300 <font color="darkgreen">&quot;Nominal Temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A> Xnom[Medium.nX]=Medium.reference_X <font color="darkgreen">
    &quot;Nominal gas composition&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w0=0 <font color="darkgreen">&quot;Nominal mass flowrate&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.HydraulicConductance"
>HydraulicConductance</A> G=0 <font color="darkgreen">&quot;Hydraulic Conductance&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_w0;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_T;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_X[Medium.nX];

  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> flange(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
<font color="blue">equation </font>
  <font color="blue">if </font>G == 0<font color="blue"> then</font>
    flange.w = w;
  <font color="blue">else</font>
    flange.w = w + (flange.p - p0)*G;
  <font color="blue">end if</font>;

  w = in_w0;
  <font color="blue">if </font><font color="red">cardinality</font>(in_w0)==0<font color="blue"> then</font>
    in_w0 = w0 <font color="darkgreen">&quot;Flow rate set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  gas.T = in_T;
  <font color="blue">if </font><font color="red">cardinality</font>(in_T)==0<font color="blue"> then</font>
    in_T = T <font color="darkgreen">&quot;Temperature set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  gas.Xi = in_X[1:Medium.nXi];
  <font color="blue">if </font><font color="red">cardinality</font>(in_X)==0<font color="blue"> then</font>
    in_X = Xnom <font color="darkgreen">&quot;Composition set by parameter&quot;</font>;
  <font color="blue">end if</font>;

 flange.p = gas.p;
 flange.hAB = gas.h;
 flange.XAB = gas.Xi;

<font color="blue">end </font>SinkW;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ThroughW<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.ThroughWI.png" ALT="ThermoPower.Gas.ThroughW" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.ThroughW"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.ThroughW</H2>
<B>Prescribes the flow rate across the component</B><p>
<IMG SRC="ThermoPower.Gas.ThroughWD.png" ALT="ThermoPower.Gas.ThroughW">
<H3>Information</H3>
<PRE></pre>
<p><b>Modelling options</b></p>
<p>The actual gas used in the component is determined by the replaceable <tt>Medium</tt> package. In the case of multiple component, variable composition gases, the nominal gas composition is given by <tt>Xnom</tt>,whose default value is <tt>Medium.reference_X</tt> .
<p>If <tt>G</tt> is set to zero, the flowrate source is ideal; otherwise, the outgoing flowrate decreases proportionally to the outlet pressure.</p>
<p>If the <tt>in_w0</tt> connector is wired, then the source massflowrate is given by the corresponding signal, otherwise it is fixed to <tt>w0</tt>.</p>
<p>If the <tt>in_T</tt> connector is wired, then the source temperature is given by the corresponding signal, otherwise it is fixed to <tt>T</tt>.</p>
<p>If the <tt>in_X</tt> connector is wired, then the source massfraction is given by the corresponding signal, otherwise it is fixed to <tt>Xnom</tt>.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>w0</TD><TD>0</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_w0</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ThroughW <font color="darkgreen">&quot;Prescribes the flow rate across the component&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.SourceW"
>Icons.Gas.SourceW</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w0=0 <font color="darkgreen">&quot;Nominal mass flowrate&quot;</font>;

  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_w0;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass flow rate&quot;</font>;

<font color="blue">equation </font>
  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  inlet.w = w <font color="darkgreen">&quot;Flow characteristics&quot;</font>;

  w = in_w0;
  <font color="blue">if </font><font color="red">cardinality</font>(in_w0) == 0<font color="blue"> then</font>
    in_w0 = w0 <font color="darkgreen">&quot;Flow rate set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Energy and partial mass balance</font>
  inlet.hAB = outlet.hAB;
  inlet.hBA = outlet.hBA;
  inlet.XAB = outlet.XAB;
  inlet.XBA = outlet.XBA;

<font color="blue">end </font>ThroughW;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Plenum<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.PlenumI.png" ALT="ThermoPower.Gas.Plenum" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.Plenum"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.Plenum</H2>
<B>Rigid adiabatic volume</B><p>
<IMG SRC="ThermoPower.Gas.PlenumD.png" ALT="ThermoPower.Gas.Plenum">
<H3>Information</H3>
<PRE></pre>
<p>This model describes a rigid, adiabatic control volume.
<p><b>Modelling options</b></p>
<p>The actual gas used in the component is determined by the replaceable <tt>Medium</tt> package. In the case of multiple component, variable composition gases, the start composition is given by <tt>Xstart</tt>, whose default value is <tt>Medium.reference_X</tt> .
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V</TD><TD>&nbsp;</TD><TD>Inner volume [m3]</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>HT</A></TD><TD>thermalPort</TD><TD>redeclare Thermal.HT thermal...</TD><TD>&nbsp;</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>101325</TD><TD>Pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart</TD><TD>300</TD><TD>Temperature start value [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Medium.nX]</TD><TD>Medium.reference_X</TD><TD>Start gas composition [1]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>HT</A></TD><TD>thermalPort</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Plenum <font color="darkgreen">&quot;Rigid adiabatic volume&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.Mixer"
>Icons.Gas.Mixer</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas(
    p(start=pstart, stateSelect=StateSelect.prefer),
    T(start=Tstart, stateSelect=StateSelect.prefer),
    Xi(start=Xstart[1:Medium.nXi], stateSelect=StateSelect.prefer));
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> V <font color="darkgreen">&quot;Inner volume&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstart=101325 <font color="darkgreen">&quot;Pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tstart=300 <font color="darkgreen">&quot;Temperature start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A> Xstart[Medium.nX]=Medium.reference_X <font color="darkgreen">
    &quot;Start gas composition&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Choices.Init.Options.Temp</A> initOpt=Choices.Init.Options.noInit <font color="darkgreen">
    &quot;Initialisation option&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> M <font color="darkgreen">&quot;Total mass&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.InternalEnergy"
>InternalEnergy</A> E <font color="darkgreen">&quot;Total internal energy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hi <font color="darkgreen">&quot;Inlet specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> ho <font color="darkgreen">&quot;Outlet specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>Medium.MassFraction</A> Xi_i[Medium.nXi] <font color="darkgreen">&quot;Inlet composition&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>Medium.MassFraction</A> Xi_o[Medium.nXi] <font color="darkgreen">&quot;Outlet composition&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A> Tr <font color="darkgreen">&quot;Residence Time&quot;</font>;

  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <font color="blue">replaceable </font><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>Thermal.HT</A> thermalPort;
<font color="blue">equation </font>
  M = gas.d*V <font color="darkgreen">&quot;Gas mass&quot;</font>;
  E = M*gas.u <font color="darkgreen">&quot;Gas internal energy&quot;</font>;
  <font color="red">der</font>(M) = inlet.w + outlet.w <font color="darkgreen">&quot;Mass balance&quot;</font>;
  <font color="red">der</font>(E) = inlet.w*hi + outlet.w*ho + thermalPort.Q_flow <font color="darkgreen">&quot;Energy balance&quot;</font>;
  <font color="blue">for </font>j<font color="blue"> in </font>1:Medium.nXi<font color="blue"> loop</font>
    M*<font color="red">der</font>(gas.Xi[j]) = inlet.w*(Xi_i[j] - gas.Xi[j]) + outlet.w*(Xi_o[j] - gas.Xi[j]) <font color="darkgreen">
      &quot;Independent component mass balance&quot;</font>;
  <font color="blue">end for</font>;

  <font color="darkgreen">// Boundary conditions  </font>
  <font color="blue">if </font>inlet.w &gt;= 0<font color="blue"> then</font>
    hi = inlet.hBA;
    Xi_i = inlet.XBA;
  <font color="blue">else</font>
    hi = gas.h;
    Xi_i = gas.Xi;
  <font color="blue">end if</font>;
  <font color="blue">if </font>outlet.w &gt;= 0<font color="blue"> then</font>
    ho = outlet.hAB;
    Xi_o = outlet.XAB;
  <font color="blue">else</font>
    ho = gas.h;
    Xi_o = gas.Xi;
  <font color="blue">end if</font>;
  inlet.hAB = gas.h;
  inlet.XAB = gas.Xi;
  outlet.hBA = gas.h;
  outlet.XBA = gas.Xi;
  inlet.p = gas.p;
  outlet.p = gas.p;
  thermalPort.T = gas.T;

  Tr=<font color="red">noEvent</font>(M/<font color="red">max</font>(<font color="red">abs</font>(outlet.w),Modelica.Constants.eps)) <font color="darkgreen">&quot;Residence time&quot;</font>;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="darkgreen">// Initial conditions</font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="red">der</font>(gas.p) = 0;
    <font color="red">der</font>(gas.T) = 0;
    <font color="red">der</font>(gas.Xi)=<font color="red">zeros</font>(Medium.nXi);
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyStateNoP<font color="blue"> then</font>
    <font color="red">der</font>(gas.T) = 0;
    <font color="red">der</font>(gas.Xi)=<font color="red">zeros</font>(Medium.nXi);
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;
<font color="blue">end </font>Plenum;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Header<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.PlenumI.png" ALT="ThermoPower.Gas.Header" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.Header"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.Header</H2>
<B>Header with metal walls for gas flows</B><p>
<IMG SRC="ThermoPower.Gas.PlenumD.png" ALT="ThermoPower.Gas.Header">
<H3>Information</H3>
<PRE></pre>
<p>This model describes a constant volume buffer with metal walls. The metal wall temperature and the heat transfer coefficient between the wall and the fluid are uniform. The wall is thermally insulated from the outside.</p>
<p>If the inlet or the outlet are connected to a bank of tubes, the model can actually represent a collector or a distributor.</p>
<p><b>Modelling options</b></p>
<p>The actual gas used in the component is determined by the replaceable <tt>Medium</tt> package. In the case of multiple component, variable composition gases, the start composition is given by <tt>Xstart</tt>, whose default value is <tt>Medium.reference_X</tt> .
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tmstart</TD><TD>300</TD><TD>Metal wall start temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V</TD><TD>&nbsp;</TD><TD>Inner volume [m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>S</TD><TD>0</TD><TD>Inner surface [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>gamma</TD><TD>0</TD><TD>Heat Transfer Coefficient [W/(m2.K)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>HeatCapacity</A></TD><TD>Cm</TD><TD>0</TD><TD>Metal Heat Capacity [J/K]</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>HT</A></TD><TD>thermalPort</TD><TD>redeclare Thermal.HT thermal...</TD><TD>&nbsp;</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>101325</TD><TD>Pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart</TD><TD>300</TD><TD>Temperature start value [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Medium.nX]</TD><TD>Medium.reference_X</TD><TD>Start gas composition [1]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>HT</A></TD><TD>thermalPort</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Header <font color="darkgreen">&quot;Header with metal walls for gas flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.Mixer"
>Icons.Gas.Mixer</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas(
    p(start=pstart, stateSelect=StateSelect.prefer),
    T(start=Tstart, stateSelect=StateSelect.prefer),
    Xi(start=Xstart[1:Medium.nXi], stateSelect=StateSelect.prefer));
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tmstart=300 <font color="darkgreen">&quot;Metal wall start temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> V <font color="darkgreen">&quot;Inner volume&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> S=0 <font color="darkgreen">&quot;Inner surface&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma=0 <font color="darkgreen">&quot;Heat Transfer Coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>HeatCapacity</A> Cm=0 <font color="darkgreen">&quot;Metal Heat Capacity&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstart=101325 <font color="darkgreen">&quot;Pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tstart=300 <font color="darkgreen">&quot;Temperature start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A> Xstart[Medium.nX]=Medium.reference_X <font color="darkgreen">
    &quot;Start gas composition&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Choices.Init.Options.Temp</A> initOpt=Choices.Init.Options.noInit <font color="darkgreen">
    &quot;Initialisation option&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> M <font color="darkgreen">&quot;Gas total mass&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.InternalEnergy"
>InternalEnergy</A> E <font color="darkgreen">&quot;Gas total energy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hi <font color="darkgreen">&quot;Inlet specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> ho <font color="darkgreen">&quot;Outlet specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>Medium.MassFraction</A> Xi_i[Medium.nX] <font color="darkgreen">&quot;Inlet composition&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>Medium.MassFraction</A> Xi_o[Medium.nX] <font color="darkgreen">&quot;Outlet composition&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tm(start=Tmstart) <font color="darkgreen">&quot;Wall temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A> Tr <font color="darkgreen">&quot;Residence Time&quot;</font>;

  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <font color="blue">replaceable </font><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>Thermal.HT</A> thermalPort;
<font color="blue">equation </font>
  M = gas.d*V <font color="darkgreen">&quot;Gas mass&quot;</font>;
  E = gas.u*M <font color="darkgreen">&quot;Gas internal energy&quot;</font>;
  <font color="red">der</font>(M) = inlet.w + outlet.w <font color="darkgreen">&quot;Mass balance&quot;</font>;
  <font color="red">der</font>(E) = inlet.w*hi + outlet.w*ho - gamma*S*(gas.T - Tm)
           + thermalPort.Q_flow <font color="darkgreen">&quot;Energy balance&quot;</font>;
  <font color="blue">for </font>j<font color="blue"> in </font>1:Medium.nXi<font color="blue"> loop</font>
    M*<font color="red">der</font>(gas.Xi[j]) = inlet.w*(Xi_i[j] - gas.Xi[j]) + outlet.w*(Xi_o[j] - gas.Xi[j]) <font color="darkgreen">
      &quot;Independent component mass balance&quot;</font>;
  <font color="blue">end for</font>;
  <font color="blue">if </font>Cm &gt; 0<font color="blue"> and </font>gamma &gt; 0<font color="blue"> then</font>
    Cm*<font color="red">der</font>(Tm) = gamma*S*(gas.T - Tm) <font color="darkgreen">&quot;Metal wall energy balance&quot;</font>;
  <font color="blue">else</font>
    Tm = gas.T;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Boundary conditions</font>
  <font color="blue">if </font>inlet.w &gt;= 0<font color="blue"> then</font>
    hi = inlet.hBA;
    Xi_i = inlet.XBA;
  <font color="blue">else</font>
    hi = gas.h;
    Xi_i = gas.Xi;
  <font color="blue">end if</font>;
  <font color="blue">if </font>outlet.w &gt;= 0<font color="blue"> then</font>
    ho = outlet.hAB;
    Xi_o = outlet.XAB;
  <font color="blue">else</font>
    ho = gas.h;
    Xi_o = gas.Xi;
  <font color="blue">end if</font>;
  inlet.p = gas.p;
  inlet.hAB = gas.h;
  inlet.XAB = gas.Xi;
  outlet.p = gas.p;
  outlet.hBA = gas.h;
  outlet.XBA = gas.Xi;
  thermalPort.T = gas.T;

  Tr=<font color="red">noEvent</font>(M/<font color="red">max</font>(<font color="red">abs</font>(outlet.w),Modelica.Constants.eps)) <font color="darkgreen">&quot;Residence time&quot;</font>;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="darkgreen">// Initial conditions</font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="red">der</font>(gas.p) = 0;
    <font color="red">der</font>(gas.T) = 0;
    <font color="red">der</font>(gas.Xi)=<font color="red">zeros</font>(Medium.nXi);
    <font color="blue">if </font>(Cm &gt; 0<font color="blue"> and </font>gamma &gt;0)<font color="blue"> then</font>
      <font color="red">der</font>(Tm) = 0;
    <font color="blue">end if</font>;
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyStateNoP<font color="blue"> then</font>
    <font color="red">der</font>(gas.T) = 0;
    <font color="red">der</font>(gas.Xi)=<font color="red">zeros</font>(Medium.nXi);
    <font color="blue">if </font>(Cm &gt; 0<font color="blue"> and </font>gamma &gt;0)<font color="blue"> then</font>
      <font color="red">der</font>(Tm) = 0;
    <font color="blue">end if</font>;
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;
<font color="blue">end </font>Header;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Mixer<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.MixerI.png" ALT="ThermoPower.Gas.Mixer" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.Mixer"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.Mixer</H2>
<B>Mixer with metal walls for gas flows</B><p>
<IMG SRC="ThermoPower.Gas.MixerD.png" ALT="ThermoPower.Gas.Mixer">
<H3>Information</H3>
<PRE></pre>
<p>This model describes a constant volume mixer with metal walls. The metal wall temperature and the heat transfer coefficient between the wall and the fluid are uniform. The wall is thermally insulated from the outside.</p>
<p><b>Modelling options</b></p>
<p>The actual gas used in the component is determined by the replaceable <tt>Medium</tt> package. In the case of multiple component, variable composition gases, the start composition is given by <tt>Xstart</tt>, whose default value is <tt>Medium.reference_X</tt>.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V</TD><TD>&nbsp;</TD><TD>Inner volume [m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>S</TD><TD>0</TD><TD>Inner surface [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>gamma</TD><TD>0</TD><TD>Heat Transfer Coefficient [W/(m2.K)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>HeatCapacity</A></TD><TD>Cm</TD><TD>0</TD><TD>Metal heat capacity [J/K]</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>HT</A></TD><TD>thermalPort</TD><TD>redeclare Thermal.HT thermal...</TD><TD>&nbsp;</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>101325</TD><TD>Pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart</TD><TD>300</TD><TD>Temperature start value [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Medium.nX]</TD><TD>Medium.reference_X</TD><TD>Start gas composition [1]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>Tmstart</TD><TD>300</TD><TD>Metal wall start temperature [K]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>in1</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>out</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>in2</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>HT</A></TD><TD>thermalPort</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Mixer <font color="darkgreen">&quot;Mixer with metal walls for gas flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.Mixer"
>Icons.Gas.Mixer</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas(
    p(start=pstart, stateSelect=StateSelect.prefer),
    T(start=Tstart, stateSelect=StateSelect.prefer),
    Xi(start=Xstart[1:Medium.nXi], stateSelect=StateSelect.prefer));
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> V <font color="darkgreen">&quot;Inner volume&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> S=0 <font color="darkgreen">&quot;Inner surface&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma=0 <font color="darkgreen">&quot;Heat Transfer Coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>HeatCapacity</A> Cm=0 <font color="darkgreen">&quot;Metal heat capacity&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstart=101325 <font color="darkgreen">&quot;Pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tstart=300 <font color="darkgreen">&quot;Temperature start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A> Xstart[Medium.nX]=Medium.reference_X <font color="darkgreen">
    &quot;Start gas composition&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A> Tmstart=300 <font color="darkgreen">&quot;Metal wall start temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Choices.Init.Options.Temp</A> initOpt=Choices.Init.Options.noInit <font color="darkgreen">
    &quot;Initialisation option&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> M <font color="darkgreen">&quot;Gas total mass&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.InternalEnergy"
>InternalEnergy</A> E <font color="darkgreen">&quot;Gas total energy&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tm(start=Tmstart) <font color="darkgreen">&quot;Wall temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hi1 <font color="darkgreen">&quot;Inlet 1 specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hi2 <font color="darkgreen">&quot;Inlet 2 specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> ho <font color="darkgreen">&quot;Outlet specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>Medium.MassFraction</A> Xi1[Medium.nX] <font color="darkgreen">&quot;Inlet 1 composition&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>Medium.MassFraction</A> Xi2[Medium.nX] <font color="darkgreen">&quot;Inlet 2 composition&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFraction"
>Medium.MassFraction</A> Xo[Medium.nX] <font color="darkgreen">&quot;Outlet composition&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A> Tr <font color="darkgreen">&quot;Residence time&quot;</font>;

  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> in1(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> out(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> in2(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);

  <font color="blue">replaceable </font><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>Thermal.HT</A> thermalPort;
<font color="blue">equation </font>
  M = gas.d*V <font color="darkgreen">&quot;Gas mass&quot;</font>;
  E = M*gas.u <font color="darkgreen">&quot;Gas internal energy&quot;</font>;
  <font color="red">der</font>(M) = in1.w + in2.w + out.w <font color="darkgreen">&quot;Mass balance&quot;</font>;
  <font color="red">der</font>(E) = in1.w*hi1 + in2.w*hi2 + out.w*ho - gamma*S*(gas.T - Tm)
     + thermalPort.Q_flow <font color="darkgreen">&quot;Energy balance&quot;</font>;
  <font color="blue">for </font>j<font color="blue"> in </font>1:Medium.nX<font color="blue"> loop</font>
    M*<font color="red">der</font>(gas.X[j]) = in1.w*(Xi1[j] - gas.X[j]) + in2.w*(Xi2[j] - gas.X[j])
       + out.w*(Xo[j] - gas.X[j]) <font color="darkgreen">&quot;Independent component mass balance&quot;</font>;
  <font color="blue">end for</font>;
  <font color="blue">if </font>Cm &gt; 0<font color="blue"> and </font>gamma &gt; 0<font color="blue"> then</font>
    Cm*<font color="red">der</font>(Tm) = gamma*S*(gas.T - Tm) <font color="darkgreen">&quot;Metal wall energy balance&quot;</font>;
  <font color="blue">else</font>
    Tm = gas.T;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Boundary conditions</font>
  <font color="blue">if </font>in1.w &gt;= 0<font color="blue"> then</font>
    hi1 = in1.hBA;
    Xi1 = in1.XBA;
  <font color="blue">else</font>
    hi1 = gas.h;
    Xi1 = gas.X;
  <font color="blue">end if</font>;
  <font color="blue">if </font>in2.w &gt;= 0<font color="blue"> then</font>
    hi2 = in2.hBA;
    Xi2 = in2.XBA;
  <font color="blue">else</font>
    hi2 = gas.h;
    Xi2 = gas.X;
  <font color="blue">end if</font>;
  <font color="blue">if </font>out.w &gt;= 0<font color="blue"> then</font>
    ho = out.hAB;
    Xo = out.XAB;
  <font color="blue">else</font>
    ho = gas.h;
    Xo = gas.X;
  <font color="blue">end if</font>;
  in1.p   = gas.p;
  in1.hAB = gas.h;
  in1.XAB = gas.X;
  in2.p   = gas.p;
  in2.hAB = gas.h;
  in2.XAB = gas.X;
  out.p   = gas.p;
  out.hBA = gas.h;
  out.XBA = gas.X;
  thermalPort.T = gas.T;

  Tr=<font color="red">noEvent</font>(M/<font color="red">max</font>(<font color="red">abs</font>(out.w),Modelica.Constants.eps)) <font color="darkgreen">&quot;Residence time&quot;</font>;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="darkgreen">// Initial conditions</font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="red">der</font>(gas.p) = 0;
    <font color="red">der</font>(gas.T) = 0;
    <font color="red">der</font>(gas.Xi)=<font color="red">zeros</font>(Medium.nXi);
    <font color="blue">if </font>(Cm &gt; 0<font color="blue"> and </font>gamma &gt;0)<font color="blue"> then</font>
      <font color="red">der</font>(Tm) = 0;
    <font color="blue">end if</font>;
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyStateNoP<font color="blue"> then</font>
    <font color="red">der</font>(gas.T) = 0;
    <font color="red">der</font>(gas.Xi)=<font color="red">zeros</font>(Medium.nXi);
    <font color="blue">if </font>(Cm &gt; 0<font color="blue"> and </font>gamma &gt;0)<font color="blue"> then</font>
      <font color="red">der</font>(Tm) = 0;
    <font color="blue">end if</font>;
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;
<font color="blue">end </font>Mixer;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE FlowJoin<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.FlowJoinI.png" ALT="ThermoPower.Gas.FlowJoin" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.FlowJoin"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.FlowJoin</H2>
<B>Joins two gas flows</B><p>
<IMG SRC="ThermoPower.Gas.FlowJoinD.png" ALT="ThermoPower.Gas.FlowJoin">
<H3>Information</H3>
<PRE></pre>
<p>This component allows to join two separate flows into one. The model is based on mass and energy balance equations, without any mass or energy buildup, and without any pressure drop between the inlet and the outlets.
<p><b>Modelling options</b></p>
<p> If <tt>rev_inlet1</tt>, <tt>rev_inlet2</tt> or <tt>rev_outlet</tt> is true, the respective flows reversal is allowed. If at least ona among these parameters is false, it is possible to set <tt>checkFlowDirection</tt>.</p>
<p>If <tt>checkFlowDirection</tt> is true, when the flow reversal happen where it is not allowed, the error message is showed.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>rev_inlet1</TD><TD>true</TD><TD>Allow flow reversal at inlet1</TD></TR>
<TR><TD>Boolean</TD><TD>rev_inlet2</TD><TD>true</TD><TD>Allow flow reversal at inlet2</TD></TR>
<TR><TD>Boolean</TD><TD>rev_outlet</TD><TD>true</TD><TD>Allow flow reversal at outlet</TD></TR>
<TR><TD>Boolean</TD><TD>checkFlowDirection</TD><TD>false</TD><TD>Check flow direction</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet1</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet2</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> FlowJoin <font color="darkgreen">&quot;Joins two gas flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.FlowJoin"
>Icons.Gas.FlowJoin</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wzero=1e-9 <font color="darkgreen">
    &quot;Small flowrate to avoid singularity in computing the outlet enthalpy and composition&quot;</font>;
  <font color="blue">parameter </font>Boolean rev_inlet1 = true <font color="darkgreen">&quot;Allow flow reversal at inlet1&quot;</font>;
  <font color="blue">parameter </font>Boolean rev_inlet2 = true <font color="darkgreen">&quot;Allow flow reversal at inlet2&quot;</font>;
  <font color="blue">parameter </font>Boolean rev_outlet = true <font color="darkgreen">&quot;Allow flow reversal at outlet&quot;</font>;
  <font color="blue">parameter </font>Boolean checkFlowDirection = false <font color="darkgreen">&quot;Check flow direction&quot;</font>;
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> inlet1(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> inlet2(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
<font color="blue">equation </font>
  inlet1.w + inlet2.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;

  <font color="darkgreen">// Momentum balance</font>
  inlet1.p = outlet.p;
  inlet2.p = outlet.p;

  <font color="darkgreen">// Energy balance</font>
  outlet.hBA = <font color="blue">if </font>(inlet2.w &lt; 0<font color="blue"> and </font>rev_inlet2)<font color="blue"> then </font>inlet1.hBA<font color="blue"> else </font><font color="blue">if </font>(inlet1.w &lt; 0<font color="blue"> and </font>rev_inlet1)<font color="blue"> then </font>inlet2.hBA<font color="blue"> else </font>(
    inlet1.hBA*(inlet1.w + wzero) + inlet2.hBA*(inlet2.w + wzero))/(inlet1.w + 2*wzero + inlet2.w);
  inlet1.hAB = <font color="blue">if </font>(inlet2.w &lt; 0<font color="blue"> and </font>rev_inlet2)<font color="blue"> then </font>outlet.hAB<font color="blue"> else </font><font color="blue">if </font>(outlet.w &lt; 0<font color="blue"> or </font><font color="blue">not </font>rev_outlet)<font color="blue"> then </font>inlet2.hBA<font color="blue"> else </font>(
    outlet.hAB*(outlet.w + wzero) + inlet2.hBA*(inlet2.w + wzero))/(outlet.w + 2*wzero + inlet2.w);
  inlet2.hAB = <font color="blue">if </font>(inlet1.w &lt; 0<font color="blue"> and </font>rev_inlet1)<font color="blue"> then </font>outlet.hAB<font color="blue"> else </font><font color="blue">if </font>(outlet.w &lt; 0<font color="blue"> or </font><font color="blue">not </font>rev_outlet)<font color="blue"> then </font>inlet1.hBA<font color="blue"> else </font>(
    outlet.hAB*(outlet.w + wzero) + inlet1.hBA*(inlet1.w + wzero))/(outlet.w + 2*wzero + inlet1.w);

  <font color="darkgreen">// Independent component mass balances</font>
  outlet.XBA = <font color="blue">if </font>(inlet2.w &lt; 0<font color="blue"> and </font>rev_inlet2)<font color="blue"> then </font>inlet1.XBA<font color="blue"> else </font><font color="blue">if </font>(inlet1.w &lt; 0<font color="blue"> and </font>rev_inlet1)<font color="blue"> then </font>inlet2.XBA<font color="blue"> else </font>(
    inlet1.XBA*(inlet1.w + wzero) + inlet2.XBA*(inlet2.w + wzero))/(inlet1.w + 2*wzero + inlet2.w);
  inlet1.XAB = <font color="blue">if </font>(inlet2.w &lt; 0<font color="blue"> and </font>rev_inlet2)<font color="blue"> then </font>outlet.XAB<font color="blue"> else </font><font color="blue">if </font>(outlet.w &lt; 0<font color="blue"> or </font><font color="blue">not </font>rev_outlet)<font color="blue"> then </font>inlet2.XBA<font color="blue"> else </font>(
    outlet.XAB*(outlet.w + wzero) + inlet2.XBA*(inlet2.w + wzero))/(outlet.w + 2*wzero + inlet2.w);
  inlet2.XAB = <font color="blue">if </font>(inlet1.w &lt; 0<font color="blue"> and </font>rev_inlet1)<font color="blue"> then </font>outlet.XAB<font color="blue"> else </font><font color="blue">if </font>(outlet.w &lt; 0<font color="blue"> or </font><font color="blue">not </font>rev_outlet)<font color="blue"> then </font>inlet1.XBA<font color="blue"> else </font>(
    outlet.XAB*(outlet.w + wzero) + inlet1.XBA*(inlet1.w + wzero))/(outlet.w + 2*wzero + inlet1.w);

  <font color="darkgreen">//Check flow direction</font>
  <font color="red">assert</font>( <font color="blue">not </font>checkFlowDirection<font color="blue"> or </font>((rev_inlet1<font color="blue"> or </font>inlet1.w &gt;= 0)<font color="blue"> and </font>
                                     (rev_inlet2<font color="blue"> or </font>inlet2.w &gt;= 0)<font color="blue"> and </font>
                                     (rev_outlet<font color="blue"> or </font>outlet.w &lt;= 0)),
                                    &quot;Flow reversal not supported&quot;);

<font color="blue">end </font>FlowJoin;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE FlowSplit<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.FlowSplitI.png" ALT="ThermoPower.Gas.FlowSplit" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.FlowSplit"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.FlowSplit</H2>
<B>Splits a gas flow in two</B><p>
<IMG SRC="ThermoPower.Gas.FlowSplitD.png" ALT="ThermoPower.Gas.FlowSplit">
<H3>Information</H3>
<PRE></pre>
<p>This component allows to split a single flow in two ones. The model is based on mass and energy balance equations, without any mass or energy buildup, and without any pressure drop between the inlet and the outlets.
<p><b>Modelling options</b></p>
<p> If <tt>rev_inlet</tt>, <tt>rev_outlet1</tt> or <tt>rev_outlet2</tt> is true, the respective flows reversal is allowed. If at least ona among these parameters is false, it is possible to set <tt>checkFlowDirection</tt>.</p>
<p>If <tt>checkFlowDirection</tt> is true, when the flow reversal happen where it is not allowed, the error message is showed.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>rev_inlet</TD><TD>true</TD><TD>Allow flow reversal at inlet</TD></TR>
<TR><TD>Boolean</TD><TD>rev_outlet1</TD><TD>true</TD><TD>Allow flow reversal at outlet1</TD></TR>
<TR><TD>Boolean</TD><TD>rev_outlet2</TD><TD>true</TD><TD>Allow flow reversal at outlet2</TD></TR>
<TR><TD>Boolean</TD><TD>checkFlowDirection</TD><TD>false</TD><TD>Check flow direction</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet1</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet2</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> FlowSplit <font color="darkgreen">&quot;Splits a gas flow in two&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.FlowSplit"
>Icons.Gas.FlowSplit</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wzero=1e-9 <font color="darkgreen">
    &quot;Small flowrate to avoid singularity in computing the outlet enthalpy and composition&quot;</font>;
  <font color="blue">parameter </font>Boolean rev_inlet = true <font color="darkgreen">&quot;Allow flow reversal at inlet&quot;</font>;
  <font color="blue">parameter </font>Boolean rev_outlet1 = true <font color="darkgreen">&quot;Allow flow reversal at outlet1&quot;</font>;
  <font color="blue">parameter </font>Boolean rev_outlet2 = true <font color="darkgreen">&quot;Allow flow reversal at outlet2&quot;</font>;
  <font color="blue">parameter </font>Boolean checkFlowDirection = false <font color="darkgreen">&quot;Check flow direction&quot;</font>;
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> outlet1(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> outlet2(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
<font color="blue">equation </font>
  inlet.w+outlet1.w+outlet2.w=0 <font color="darkgreen">&quot;Mass balance&quot;</font>;

  <font color="darkgreen">// Momentum balance</font>
  outlet1.p=inlet.p;
  outlet2.p=inlet.p;

  <font color="darkgreen">// Energy balance</font>
  outlet1.hBA= <font color="blue">if </font>(inlet.w&lt;0<font color="blue"> and </font>rev_inlet)<font color="blue"> then </font>outlet2.hAB<font color="blue"> else </font><font color="blue">if </font>(outlet2.w&lt;0<font color="blue"> or </font><font color="blue">not </font>rev_outlet2)<font color="blue"> then </font>inlet.hBA<font color="blue"> else </font>
    (inlet.hBA*(inlet.w+wzero)+outlet2.hAB*(outlet2.w+wzero))/(inlet.w+2*wzero+outlet2.w);
  outlet2.hBA= <font color="blue">if </font>(inlet.w&lt;0<font color="blue"> and </font>rev_inlet)<font color="blue"> then </font>outlet1.hAB<font color="blue"> else </font><font color="blue">if </font>(outlet1.w&lt;0<font color="blue"> or </font><font color="blue">not </font>rev_outlet1)<font color="blue"> then </font>inlet.hBA<font color="blue"> else </font>
    (inlet.hBA*(inlet.w+wzero)+outlet1.hAB*(outlet1.w+wzero))/(inlet.w+2*wzero+outlet1.w);
  inlet.hAB= <font color="blue">if </font>(outlet1.w&lt;0<font color="blue"> or </font><font color="blue">not </font>rev_outlet1)<font color="blue"> then </font>outlet2.hAB<font color="blue"> else </font><font color="blue">if </font>(outlet2.w&lt;0<font color="blue"> or </font><font color="blue">not </font>rev_outlet2)<font color="blue"> then </font>outlet1.hAB<font color="blue"> else </font>
    (outlet1.hAB*(outlet1.w+wzero)+outlet2.hAB*(outlet2.w+wzero))/(outlet1.w+2*wzero+outlet2.w);

  <font color="darkgreen">// Independent component mass balances</font>
  outlet1.XBA= <font color="blue">if </font>(inlet.w&lt;0<font color="blue"> and </font>rev_inlet)<font color="blue"> then </font>outlet2.XAB<font color="blue"> else </font><font color="blue">if </font>(outlet2.w&lt;0<font color="blue"> or </font><font color="blue">not </font>rev_outlet2)<font color="blue"> then </font>inlet.XBA<font color="blue"> else </font>
    (inlet.XBA*(inlet.w+wzero)+outlet2.XAB*(outlet2.w+wzero))/(inlet.w+2*wzero+outlet2.w);
  outlet2.XBA= <font color="blue">if </font>(inlet.w&lt;0<font color="blue"> and </font>rev_inlet)<font color="blue"> then </font>outlet1.XAB<font color="blue"> else </font><font color="blue">if </font>(outlet1.w&lt;0<font color="blue"> or </font><font color="blue">not </font>rev_outlet1)<font color="blue"> then </font>inlet.XBA<font color="blue"> else </font>
    (inlet.XBA*(inlet.w+wzero)+outlet1.XAB*(outlet1.w+wzero))/(inlet.w+2*wzero+outlet1.w);
  inlet.XAB= <font color="blue">if </font>(outlet1.w&lt;0<font color="blue"> or </font><font color="blue">not </font>rev_outlet1)<font color="blue"> then </font>outlet2.XAB<font color="blue"> else </font><font color="blue">if </font>(outlet2.w&lt;0<font color="blue"> or </font><font color="blue">not </font>rev_outlet2)<font color="blue"> then </font>outlet1.XAB<font color="blue"> else </font>
    (outlet1.XAB*(outlet1.w+wzero)+outlet2.XAB*(outlet2.w+wzero))/(outlet1.w+2*wzero+outlet2.w);

  <font color="darkgreen">//Check flow direction</font>
  <font color="red">assert</font>( <font color="blue">not </font>checkFlowDirection<font color="blue"> or </font>((rev_inlet<font color="blue"> or </font>inlet.w &gt;= 0)<font color="blue"> and </font>
                                     (rev_outlet1<font color="blue"> or </font>outlet1.w &lt;= 0)<font color="blue"> and </font>
                                     (rev_outlet2<font color="blue"> or </font>outlet2.w &lt;= 0)),
                                    &quot;Flow reversal not supported&quot;);

<font color="blue">end </font>FlowSplit;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE PressDropLin<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.PressDropLinI.png" ALT="ThermoPower.Gas.PressDropLin" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.PressDropLin"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.PressDropLin</H2>
<B>Linear pressure drop for gas flows</B><p>
<IMG SRC="ThermoPower.Gas.PressDropLinD.png" ALT="ThermoPower.Gas.PressDropLin">
<H3>Information</H3>
<PRE></pre>
<p>This very simple model provides a pressure drop which is proportional to the flowrate, without computing any fluid property.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.HydraulicResistance"
>HydraulicResistance</A></TD><TD>R</TD><TD>&nbsp;</TD><TD>Hydraulic resistance [Pa/(kg/s)]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> PressDropLin <font color="darkgreen">&quot;Linear pressure drop for gas flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.Tube"
>Icons.Gas.Tube</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.HydraulicResistance"
>HydraulicResistance</A> R <font color="darkgreen">&quot;Hydraulic resistance&quot;</font>;

  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);

<font color="blue">equation </font>
  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  inlet.p - outlet.p = R*inlet.w <font color="darkgreen">&quot;Flow characteristics&quot;</font>;

  <font color="darkgreen">// Boundary conditions</font>
  inlet.hAB = outlet.hAB;
  inlet.XAB = outlet.XAB;
  inlet.hBA = outlet.hBA;
  inlet.XBA = outlet.XBA;
<font color="blue">end </font>PressDropLin;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE PressDrop<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.PressDropLinI.png" ALT="ThermoPower.Gas.PressDrop" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.PressDrop"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.PressDrop</H2>
<B>Pressure drop for gas flows</B><p>
<IMG SRC="ThermoPower.Gas.PressDropLinD.png" ALT="ThermoPower.Gas.PressDrop">
<H3>Information</H3>
<PRE></pre>
<p>The pressure drop across the inlet and outlet connectors is computed according to a turbulent friction model, i.e. is proportional to the squared velocity of the fluid. The friction coefficient can be specified directly, or by giving an operating point, or as a multiple of the kinetic pressure. The correction coefficient <tt>Kfc</tt> can be used to modify the friction coefficient, e.g. to fit some experimental operating point.</p>
<p>A small linear pressure drop is added to avoid numerical singularities at low or zero flowrate. The <tt>wnom</tt> parameter must be always specified; the additional linear pressure drop is such that it is equal to the turbulent pressure drop when the flowrate is equal to <tt>wnf*wnom</tt> (the default value is 1% of the nominal flowrate).
<p><b>Modelling options</b></p>
<p>The actual gas used in the component is determined by the replaceable <tt>Medium</tt> package. In the case of multiple component, variable composition gases, the start composition is given by <tt>Xstart</tt>, whose default value is <tt>Medium.reference_X</tt>.
<p>The following options are available to specify the friction coefficient:
<ul><li><tt>FFtype = 0</tt>: the hydraulic friction coefficient <tt>Kf</tt> is used directly.</li>
<li><tt>FFtype = 1</tt>: the hydraulic friction coefficient is specified by the nominal operating point (<tt>wnom</tt>,<tt>dpnom</tt>, <tt>rhonom</tt>).</li>
<li><tt>FFtype = 2</tt>: the pressure drop is <tt>K</tt> times the kinetic pressure.</li></ul>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_PressDrop_FFtypes.html#ThermoPower.Choices.PressDrop.FFtypes.Temp"
>Temp</A></TD><TD>FFtype</TD><TD>FFtypes.Kf</TD><TD>Friction factor type</TD></TR>
<TR><TD>Real</TD><TD>Kf</TD><TD>0</TD><TD>Hydraulic resistance coefficient [Pa.kg/m^3/(kg/s)^2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>0</TD><TD>Nominal pressure drop [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>0</TD><TD>Nominal density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>K</TD><TD>0</TD><TD>Kinetic resistance coefficient (DP=K*rho*velocity^2/2)</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>0</TD><TD>Cross-section [m2]</TD></TR>
<TR><TD>Real</TD><TD>wnf</TD><TD>0.01</TD><TD>Fraction of nominal flow rate at which linear friction equals turbulent friction</TD></TR>
<TR><TD>Real</TD><TD>Kfc</TD><TD>1</TD><TD>Friction factor correction coefficient</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>101325</TD><TD>Start pressure value [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart</TD><TD>300</TD><TD>Start temperature value [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Medium.nX]</TD><TD>Medium.reference_X</TD><TD>Start gas composition [1]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> PressDrop <font color="darkgreen">&quot;Pressure drop for gas flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.Tube"
>Icons.Gas.Tube</A>;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_PressDrop_FFtypes.html#ThermoPower.Choices.PressDrop.FFtypes"
>ThermoPower.Choices.PressDrop.FFtypes</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas(
     p(start=pstart), T(start=Tstart),
     Xi(start=Xstart[1:Medium.nXi]));
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wnom <font color="darkgreen">&quot;Nominal mass flowrate&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_PressDrop_FFtypes.html#ThermoPower.Choices.PressDrop.FFtypes.Temp"
>FFtypes.Temp</A> FFtype = FFtypes.Kf <font color="darkgreen">&quot;Friction factor type&quot;</font>;
  <font color="blue">parameter </font>Real Kf(fixed = <font color="blue">if </font>FFtype == FFtypes.Kf<font color="blue"> then </font>true<font color="blue"> else </font>false,
    unit = &quot;Pa.kg/m^3/(kg/s)^2&quot;)=0 <font color="darkgreen">&quot;Hydraulic resistance coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> dpnom=0 <font color="darkgreen">&quot;Nominal pressure drop&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A> rhonom=0 <font color="darkgreen">&quot;Nominal density&quot;</font>;
  <font color="blue">parameter </font>Real K=0 <font color="darkgreen">&quot;Kinetic resistance coefficient (DP=K*rho*velocity^2/2)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> A=0 <font color="darkgreen">&quot;Cross-section&quot;</font>;
  <font color="blue">parameter </font>Real wnf=0.01 <font color="darkgreen">
    &quot;Fraction of nominal flow rate at which linear friction equals turbulent friction&quot;</font>;
  <font color="blue">parameter </font>Real Kfc=1 <font color="darkgreen">&quot;Friction factor correction coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstart=101325 <font color="darkgreen">&quot;Start pressure value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tstart=300 <font color="darkgreen">&quot;Start temperature value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A> Xstart[Medium.nX]=Medium.reference_X <font color="darkgreen">
    &quot;Start gas composition&quot;</font>;
<font color="blue">protected </font>
  <font color="blue">parameter </font>Real Kfl(fixed=false) <font color="darkgreen">&quot;Linear friction coefficient&quot;</font>;
<font color="blue">public </font>
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium, w(start=wnom));
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium, w(start=-wnom));
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="darkgreen">// Set Kf if FFtype &lt;&gt; FFtypes.Kf</font>
  <font color="blue">if </font>FFtype == FFtypes.OpPoint<font color="blue"> then</font>
    Kf = dpnom*rhonom/wnom^2*Kfc;
  <font color="blue">elseif </font>FFtype == FFtypes.Kinetic<font color="blue"> then</font>
    Kf = K/(2*A^2)*Kfc;
  <font color="blue">end if</font>;
  Kfl = wnom*wnf*Kf <font color="darkgreen">&quot;Linear friction factor&quot;</font>;
  <font color="red">assert</font>(Kf &gt;= 0, &quot;Negative friction coefficient&quot;);
<font color="blue">equation </font>
  <font color="darkgreen">// Set fluid properties</font>
  <font color="blue">if </font>inlet.w &gt;= 0<font color="blue"> then</font>
    gas.p = inlet.p;
    gas.h = inlet.hBA;
    gas.Xi = inlet.XBA;
  <font color="blue">else</font>
    gas.p = outlet.p;
    gas.h = outlet.hAB;
    gas.Xi = outlet.XAB;
  <font color="blue">end if</font>;

  inlet.p - outlet.p =<font color="red"> noEvent</font>(Kf*<font color="red">abs</font>(inlet.w) + Kfl)*inlet.w/gas.d <font color="darkgreen">
    &quot;Flow characteristics&quot;</font>;
  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;

  <font color="darkgreen">// Energy balance</font>
  inlet.hAB = outlet.hAB;
  inlet.hBA = outlet.hBA;

  <font color="darkgreen">// Independent component mass balances</font>
  inlet.XAB = outlet.XAB;
  inlet.XBA = outlet.XBA;
<font color="blue">end </font>PressDrop;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SensT<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.SensTI.png" ALT="ThermoPower.Gas.SensT" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.SensT"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.SensT</H2>
<B>Temperature sensor for gas</B><p>
<IMG SRC="ThermoPower.Gas.SensTD.png" ALT="ThermoPower.Gas.SensT">
<H3>Information</H3>
<PRE></pre>
<p>This component can be inserted in a hydraulic circuit to measure the temperature of the fluid flowing through it.
<p>Flow reversal is supported.
<p><b>Modelling options</p></b>
<p>The actual gas used in the component is determined by the replaceable <tt>Medium</tt> package.
<pre></PRE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD>output <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>T</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SensT <font color="darkgreen">&quot;Temperature sensor for gas&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.SensThrough"
>Icons.Gas.SensThrough</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas;
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> T;
<font color="blue">equation </font>
  inlet.w + outlet.w=0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  inlet.p = outlet.p <font color="darkgreen">&quot;Momentum balance&quot;</font>;

  <font color="darkgreen">// Energy balance</font>
  inlet.hAB = outlet.hAB;
  inlet.hBA = outlet.hBA;

  <font color="darkgreen">// Independent composition mass balances</font>
  inlet.XAB = outlet.XAB;
  inlet.XBA = outlet.XBA;

  <font color="darkgreen">// Set gas properties</font>
  inlet.p=gas.p;
  <font color="blue">if </font>inlet.w &gt;= 0<font color="blue"> then</font>
    gas.h = inlet.hBA;
    gas.Xi = inlet.XBA;
  <font color="blue">else</font>
    gas.h = inlet.hAB;
    gas.Xi = inlet.XAB;
  <font color="blue">end if</font>;

  T = gas.T <font color="darkgreen">&quot;Sensor output&quot;</font>;
<font color="blue">end </font>SensT;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SensW<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.SensWI.png" ALT="ThermoPower.Gas.SensW" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.SensW"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.SensW</H2>
<B>Mass Flowrate sensor for gas flows</B><p>
<IMG SRC="ThermoPower.Gas.SensWD.png" ALT="ThermoPower.Gas.SensW">
<H3>Information</H3>
<PRE></pre>
<p>This component can be inserted in a hydraulic circuit to measure the flowrate of the fluid flowing through it.
<p>Flow reversal is supported.
<pre></PRE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD>output <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>w</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SensW <font color="darkgreen">&quot;Mass Flowrate sensor for gas flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.SensThrough"
>Icons.Gas.SensThrough</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> w;

<font color="blue">equation </font>
  inlet.w + outlet.w=0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  inlet.p = outlet.p <font color="darkgreen">&quot;Momentum balance&quot;</font>;

  <font color="darkgreen">// Energy balance</font>
  inlet.hBA=outlet.hBA;
  inlet.hAB=outlet.hAB;

  <font color="darkgreen">// Independent composition mass balances</font>
  inlet.XBA=outlet.XBA;
  inlet.XAB=outlet.XAB;

  w=inlet.w <font color="darkgreen">&quot;Sensor output&quot;</font>;
<font color="blue">end </font>SensW;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SensP<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.SensPI.png" ALT="ThermoPower.Gas.SensP" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.SensP"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.SensP</H2>
<B>Pressure sensor for gas flows</B><p>
<IMG SRC="ThermoPower.Gas.SensPD.png" ALT="ThermoPower.Gas.SensP">
<H3>Information</H3>
<PRE></pre>
<p>This component can be connected to any A-type or B-type connector to measure the pressure of the fluid flowing through it.
<pre></PRE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>output <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>p</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.Flange"
>Flange</A></TD><TD>flange</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SensP <font color="darkgreen">&quot;Pressure sensor for gas flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.SensP"
>Icons.Gas.SensP</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> p;
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.Flange"
>Flange</A> flange(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
<font color="blue">equation </font>
  flange.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  flange.p = p <font color="darkgreen">&quot;Sensor output&quot;</font>;
<font color="blue">end </font>SensP;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SensQ<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.SensQI.png" ALT="ThermoPower.Gas.SensQ" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.SensQ"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.SensQ</H2>
<B>Volume Flow Rate sensor for gas flows</B><p>
<IMG SRC="ThermoPower.Gas.SensQD.png" ALT="ThermoPower.Gas.SensQ">
<H3>Information</H3>
<PRE></pre>
<p>This component can be inserted in a hydraulic circuit to measure the flowrate of the fluid flowing through it.
<p>Flow reversal is supported.
<pre></PRE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD>output <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>q</TD><TD>Volume flow rate</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SensQ <font color="darkgreen">&quot;Volume Flow Rate sensor for gas flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.SensThrough"
>Icons.Gas.SensThrough</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas <font color="darkgreen">&quot;Gas properties&quot;</font>;
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> q <font color="darkgreen">&quot;Volume flow rate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass flow rate&quot;</font>;
<font color="blue">equation </font>
  inlet.w + outlet.w=0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  inlet.p = outlet.p <font color="darkgreen">&quot;Momentum balance&quot;</font>;
  w = inlet.w;

  <font color="darkgreen">// Energy balance</font>
  inlet.hBA=outlet.hBA;
  inlet.hAB=outlet.hAB;

  <font color="darkgreen">// Independent composition mass balances</font>
  inlet.XBA=outlet.XBA;
  inlet.XAB=outlet.XAB;

  <font color="darkgreen">// Gas properties</font>
  gas.p = inlet.p;
  gas.h =<font color="red">  noEvent</font>(<font color="blue">if </font>w &gt;= 0<font color="blue"> then </font>inlet.hBA<font color="blue"> else </font>outlet.hAB);
  gas.Xi =<font color="red"> noEvent</font>(<font color="blue">if </font>w &gt;= 0<font color="blue"> then </font>inlet.XBA<font color="blue"> else </font>outlet.XAB);

  q = inlet.w/gas.d <font color="darkgreen">&quot;Sensor output&quot;</font>;
<font color="blue">end </font>SensQ;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ValveLin<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.ValveLinI.png" ALT="ThermoPower.Gas.ValveLin" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.ValveLin"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.ValveLin</H2>
<B>Valve for gas flows with linear pressure drop</B><p>
<IMG SRC="ThermoPower.Gas.ValveLinD.png" ALT="ThermoPower.Gas.ValveLin">
<H3>Information</H3>
<PRE></pre>
<p>This very simple model provides a pressure drop which is proportional to the flowrate and to the <tt>cmd</tt> signal, without computing any fluid property.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.HydraulicConductance"
>HydraulicConductance</A></TD><TD>Kv</TD><TD>&nbsp;</TD><TD>Hydraulic conductance [(kg/s)/Pa]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>cmd</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ValveLin <font color="darkgreen">&quot;Valve for gas flows with linear pressure drop&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.Valve"
>Icons.Gas.Valve</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.HydraulicConductance"
>HydraulicConductance</A> Kv <font color="darkgreen">&quot;Hydraulic conductance&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass flowrate&quot;</font>;
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> cmd;
<font color="blue">equation </font>
  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  inlet.w = w;
  w = Kv*cmd*(inlet.p-outlet.p) <font color="darkgreen">&quot;Flow characteristics&quot;</font>;

  <font color="darkgreen">// Energy balance</font>
  inlet.hBA=outlet.hBA;
  inlet.hAB=outlet.hAB;

  <font color="darkgreen">// Independent components mass balance</font>
  inlet.XBA=outlet.XBA;
  inlet.XAB=outlet.XAB;
<font color="blue">end </font>ValveLin;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Valve<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.ValveLinI.png" ALT="ThermoPower.Gas.Valve" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.Valve"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.Valve</H2>
<B>Valve for gas flow</B><p>
<IMG SRC="ThermoPower.Gas.ValveD.png" ALT="ThermoPower.Gas.Valve">
<H3>Information</H3>
<PRE></pre>
<p>This model is based on the IEC 534/ISA S.75 standards for valve sizing, compressible fluid.
<p>The model optionally supports reverse flow conditions (assuming symmetrical behaviour) or check valve operation, and has been suitably modified to avoid numerical singularities at zero pressure drop.
<p>The model operating range include choked flow operation, due to sonic conditions in the vena contracta.
<p>The flow characteristic can be customised.
<p><b>Modelling options</b></p>
<p>The actual gas used in the component is determined by the replaceable <tt>Medium</tt> package. In the case of multiple component, variable composition gases, the start composition is given by <tt>Xstart</tt>,whose default value is <tt>Medium.reference_X</tt>.
<p>The following options are available to specify the valve flow coefficient in fully open conditions:
<ul><li><tt>CvData = 0</tt>: the flow coefficient is given by the metric Av coefficient <tt>Av</tt> (m^2).
<li><tt>CvData = 1</tt>: the flow coefficient is given by the metric Kv coefficient <tt>Kv</tt> (m^3/h).
<li><tt>CvData = 2</tt>: the flow coefficient is given by the US Cv coefficient <tt>Cv</tt> (USG/min).
<li><tt>CvData = 3</tt>: the flow coefficient must be specified by an additional initial equation (e.g. w=0.5); the start value given by Av is used to initialise the numerical solution of the equation.
</ul>
<p>The nominal inlet pressure <tt>pnom</tt> and pressure drop <tt>dpnom</tt> must always be specified; to avoid numerical singularities, the flow characteristic is modified for pressure drops less than <tt>b*dpnom</tt> (the default value is 1% of the nominal pressure drop). Increase this parameter if numerical instabilities occur in valves with very low pressure drops.
<p>If <tt>CheckValve</tt> is true, then the flow is stopped when the outlet pressure is higher than the inlet pressure; otherwise, reverse flow takes place.
<p>The default flow characteristic <tt>FlowChar</tt> is linear; this can be replaced by any user-defined function (e.g. equal percentage, quick opening, etc.).
<p>The product Fk*xt is given by the parameter <tt>Fxtnom</tt>, and is assumed constant by default. The relative change of the xt coefficient with the valve opening can be specified by customising the <tt>xtfun</tt> function.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Choices_Valve_CvTypes.html#ThermoPower.Choices.Valve.CvTypes.Temp"
>Temp</A></TD><TD>CvData</TD><TD>CvTypes.Av</TD><TD>Selection of flow coefficient</TD></TR>
<TR><TD>Boolean</TD><TD>CheckValve</TD><TD>false</TD><TD>Reverse flow stopped</TD></TR>
<TR><TD>Real</TD><TD>b</TD><TD>0.01</TD><TD>Regularisation factor</TD></TR>
<TR><TD>Real</TD><TD>Fxt_full</TD><TD>0.5</TD><TD>Fk*xt critical ratio at full opening</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Flow Coefficient</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>Av</TD><TD>0</TD><TD>Av (metric) flow coefficient [m2]</TD></TR>
<TR><TD>Real</TD><TD>Kv</TD><TD>0</TD><TD>Kv (metric) flow coefficient [m^3/h]</TD></TR>
<TR><TD>Real</TD><TD>Cv</TD><TD>0</TD><TD>Cv (US) flow coefficient [USG/min]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal operating point</TD></TR>
<TR><TD>Real</TD><TD>pnom</TD><TD>&nbsp;</TD><TD>Nominal inlet pressure</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>&nbsp;</TD><TD>Nominal pressure drop [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>0</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>1000</TD><TD>Nominal density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>thetanom</TD><TD>1</TD><TD>Nominal valve opening</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pin_start</TD><TD>pnom</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pout_start</TD><TD>pnom - dpnom</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart</TD><TD>300</TD><TD>Start temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Medium.nX]</TD><TD>Medium.reference_X</TD><TD>Start gas composition [1]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>theta</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Valve <font color="darkgreen">&quot;Valve for gas flow&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.Valve"
>Icons.Gas.Valve</A>;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_Valve_CvTypes.html#ThermoPower.Choices.Valve.CvTypes"
>ThermoPower.Choices.Valve.CvTypes</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas(p(start=pin_start),T(start=Tstart),
                            Xi(start=Xstart[1:Medium.nXi]),
                            d(start=pnom/(8314/30*Tstart)));
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Valve_CvTypes.html#ThermoPower.Choices.Valve.CvTypes.Temp"
>CvTypes.Temp</A> CvData = CvTypes.Av <font color="darkgreen">&quot;Selection of flow coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> Av(fixed = <font color="blue">if </font>CvData==CvTypes.Av<font color="blue"> then </font>true<font color="blue"> else </font>false,
    start = wnom/(<font color="red">sqrt</font>(rhonom*dpnom))*<font color="red">FlowChar</font>(thetanom))=0 <font color="darkgreen">
    &quot;Av (metric) flow coefficient&quot;</font>;
  <font color="blue">parameter </font>Real Kv(unit=&quot;m^3/h&quot;)=0 <font color="darkgreen">&quot;Kv (metric) flow coefficient&quot;</font>;
  <font color="blue">parameter </font>Real Cv(unit=&quot;USG/min&quot;)=0 <font color="darkgreen">&quot;Cv (US) flow coefficient&quot;</font>;
  <font color="blue">parameter </font>Real pnom <font color="darkgreen">&quot;Nominal inlet pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> dpnom <font color="darkgreen">&quot;Nominal pressure drop&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wnom=0 <font color="darkgreen">&quot;Nominal mass flowrate&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A> rhonom = 1000 <font color="darkgreen">&quot;Nominal density&quot;</font>;
  <font color="blue">parameter </font>Real thetanom = 1 <font color="darkgreen">&quot;Nominal valve opening&quot;</font>;
  <font color="blue">parameter </font>Boolean CheckValve=false <font color="darkgreen">&quot;Reverse flow stopped&quot;</font>;
  <font color="blue">parameter </font>Real b=0.01 <font color="darkgreen">&quot;Regularisation factor&quot;</font>;

  <font color="blue">replaceable </font><font color="blue">function</font> FlowChar = <A HREF="ThermoPower_Functions_ValveCharacteristics.html#ThermoPower.Functions.ValveCharacteristics.linear"
>Functions.ValveCharacteristics.linear</A>
    <font color="blue">extends </font>Functions.ValveCharacteristics.baseFun <font color="darkgreen">&quot;Flow characteristic&quot;</font>;
  <font color="blue">parameter </font>Real Fxt_full=0.5 <font color="darkgreen">&quot;Fk*xt critical ratio at full opening&quot;</font>;
  <font color="blue">replaceable </font><font color="blue">function</font> xtfun = <A HREF="ThermoPower_Functions_ValveCharacteristics.html#ThermoPower.Functions.ValveCharacteristics.one"
>Functions.ValveCharacteristics.one</A>
    <font color="blue">extends </font>Functions.ValveCharacteristics.baseFun <font color="darkgreen">
    &quot;Critical ratio characteristic&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pin_start = pnom <font color="darkgreen">&quot;Inlet pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pout_start = pnom-dpnom <font color="darkgreen">&quot;Inlet pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tstart=300 <font color="darkgreen">&quot;Start temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A> Xstart[Medium.nX]=Medium.reference_X <font color="darkgreen">
    &quot;Start gas composition&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass Flow Rate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> dp <font color="darkgreen">&quot;Pressure drop&quot;</font>;
  Real Fxt;
  Real x <font color="darkgreen">&quot;Pressure drop ratio&quot;</font>;
  Real xs <font color="darkgreen">&quot;Saturated pressure drop ratio&quot;</font>;
  Real Y <font color="darkgreen">&quot;Compressibility factor&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p <font color="darkgreen">&quot;Inlet pressure&quot;</font>;
<font color="blue">protected </font>
  <font color="blue">function</font> sqrtR = <A HREF="ThermoPower_Functions.html#ThermoPower.Functions.sqrtReg"
>Functions.sqrtReg</A>(delta = b*dpnom);
  <font color="blue">parameter </font>Real Fxt_nom(fixed=false) <font color="darkgreen">&quot;Nominal Fxt&quot;</font>;
  <font color="blue">parameter </font>Real x_nom(fixed=false) <font color="darkgreen">&quot;Nominal pressure drop ratio&quot;</font>;
  <font color="blue">parameter </font>Real xs_nom(fixed=false) <font color="darkgreen">&quot;Nominal saturated pressure drop ratio&quot;</font>;
  <font color="blue">parameter </font>Real Y_nom(fixed=false) <font color="darkgreen">&quot;Nominal compressibility factor&quot;</font>;

<font color="blue">public </font>
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium, w(start=wnom), p(start=pin_start));
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium, w(start=-wnom), p(start=pout_start));
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> theta;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>CvData == CvTypes.Kv<font color="blue"> then</font>
    Av = 2.7778e-5*Kv;
  <font color="blue">elseif </font>CvData == CvTypes.Cv<font color="blue"> then</font>
    Av = 2.4027e-5*Cv;
  <font color="blue">end if</font>;
  <font color="red">assert</font>(CvData&gt;=0<font color="blue"> and </font>CvData&lt;=3, &quot;Invalid CvData&quot;);

  <font color="blue">if </font>CvData == CvTypes.OpPoint<font color="blue"> then</font>
    <font color="darkgreen">// Determination of Av by the nominal operating point conditions</font>
    Fxt_nom = Fxt_full*<font color="red">xtfun</font>(thetanom);
    x_nom = dpnom/pnom;
    xs_nom =<font color="red"> smooth</font>(0, <font color="blue">if </font>x_nom &gt; Fxt_nom<font color="blue"> then </font>Fxt_nom<font color="blue"> else </font>x_nom);
    Y_nom = 1 -<font color="red"> abs</font>(xs_nom)/(3*Fxt_nom);
    wnom =<font color="red"> FlowChar</font>(thetanom)*Av*Y_nom*<font color="red">sqrt</font>(rhonom)*<font color="red">sqrtR</font>(pnom*xs_nom);
  <font color="blue">else</font>
    <font color="darkgreen">// Dummy values</font>
    Fxt_nom = 0;
    x_nom = 0;
    xs_nom = 0;
    Y_nom = 0;
  <font color="blue">end if</font>;
<font color="blue">equation </font>
  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  w = inlet.w;

  <font color="darkgreen">// Fluid properties</font>
  gas.p = inlet.p;
  gas.h = inlet.hBA;
  gas.Xi = inlet.XBA;

  p =<font color="red"> noEvent</font>(<font color="blue">if </font>inlet.p&gt;=outlet.p<font color="blue"> then </font>inlet.p<font color="blue"> else </font>outlet.p);
  Fxt = Fxt_full*<font color="red">xtfun</font>(theta);
  dp = inlet.p - outlet.p;
  x = dp/p;
  xs =<font color="red"> noEvent</font>(<font color="red">smooth</font>(0, <font color="blue">if </font>x &lt; -Fxt<font color="blue"> then </font>-Fxt<font color="blue"> else </font><font color="blue">if </font>x &gt; Fxt<font color="blue"> then </font>Fxt<font color="blue"> else </font>x));
  Y =<font color="red"> noEvent</font>(1 -<font color="red"> abs</font>(xs)/(3*Fxt));
  <font color="blue">if </font>CheckValve<font color="blue"> then</font>
    w =<font color="red"> FlowChar</font>(theta)*Av*Y*<font color="red">sqrt</font>(gas.d)*
        <font color="red">noEvent</font>(<font color="red">smooth</font>(0, <font color="blue">if </font>xs&gt;=0<font color="blue"> then </font><font color="red">sqrtR</font>(p*xs)<font color="blue"> else </font>0));
  <font color="blue">else</font>
    w =<font color="red"> FlowChar</font>(theta)*Av*Y*<font color="red">sqrt</font>(gas.d)*<font color="red">sqrtR</font>(p*xs);
  <font color="blue">end if</font>;

  <font color="darkgreen">// Energy balance</font>
  inlet.hAB = outlet.hAB;
  inlet.hBA = outlet.hBA;

  <font color="darkgreen">// Mass balances of independent components</font>
  inlet.XAB = outlet.XAB;
  inlet.XBA = outlet.XBA;

<font color="blue">end </font>Valve;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Flow1D<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.Flow1DI.png" ALT="ThermoPower.Gas.Flow1D" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.Flow1D"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.Flow1D</H2>
<B>1-dimensional fluid flow model for gas (finite volumes)</B><p>
<IMG SRC="ThermoPower.Gas.Flow1DD.png" ALT="ThermoPower.Gas.Flow1D">
<H3>Information</H3>
<PRE></pre>
<p>This model describes the flow of a gas in a rigid tube. The basic modelling assumptions are:
<ul>
<li>Uniform velocity is assumed on the cross section, leading to a 1-D distributed parameter model.
<li>Turbulent friction is always assumed; a small linear term is added to avoid numerical singularities at zero flowrate. The friction effects are not accurately computed in the laminar and transitional flow regimes, which however should not be an issue in most power generation applications.
<li>The model is based on dynamic mass, momentum, and energy balances. The dynamic momentum term can be switched off, to avoid the fast oscillations that can arise from its coupling with the mass balance (sound wave dynamics).
<li>The longitudinal heat diffusion term is neglected.
<li>The energy balance equation is written by assuming a uniform pressure distribution; the pressure drop is lumped either at the inlet or at the outlet.
<li>The fluid flow can exchange thermal power through the lateral surface, which is represented by the <tt>wall</tt> connector. The actual heat flux must be computed by a connected component (heat transfer computation module).
</ul>
<p>The mass, momentum and energy balance equation are discretised with the finite volume method. The state variables are one pressure, one flowrate (optional), N-1 temperatures, and either one or N-1 gas composition vectors.
<p>The turbulent friction factor can be either assumed as a constant, or computed by Colebrook's equation. In the former case, the friction factor can be supplied directly, or given implicitly by a specified operating point. In any case, the multiplicative correction coefficient <tt>Kfc</tt> can be used to modify the friction coefficient, e.g. to fit experimental data.
<p>A small linear pressure drop is added to avoid numerical singularities at low or zero flowrate. The <tt>wnom</tt> parameter must be always specified: the additional linear pressure drop is such that it is equal to the turbulent pressure drop when the flowrate is equal to <tt>wnf*wnom</tt> (the default value is 1% of the nominal flowrate). Increase <tt>wnf</tt> if numerical problems occur in tubes with very low pressure drops.
<p>Flow reversal is fully supported.
<p><b>Modelling options</b></p>
<p>The actual gas used in the component is determined by the replaceable <tt>Medium</tt> package.In the case of multiple component, variable composition gases, the start composition is given by <tt>Xstart</tt>, whose default value is <tt>Medium.reference_X</tt>.
<p>Thermal variables (enthalpy, temperature, density) are computed in <tt>N</tt> equally spaced nodes, including the inlet (node 1) and the outlet (node N); <tt>N</tt> must be greater than or equal to 2.
<p>if <tt>UniformComposition</tt> is true, then a uniform compostion is assumed for the gas through the entire tube lenght; otherwise, the gas compostion is computed in <tt>N</tt> equally spaced nodes, as in the case of thermal variables.
<p>The following options are available to specify the friction coefficient:
<ul><li><tt>FFtype = FFtypes.Kfnom</tt>: the hydraulic friction coefficient <tt>Kf</tt> is set directly to <tt>Kfnom</tt>.
<li><tt>FFtype = FFtypes.OpPoint</tt>: the hydraulic friction coefficient is specified by a nominal operating point (<tt>wnom</tt>,<tt>dpnom</tt>, <tt>rhonom</tt>).
<li><tt>FFtype = FFtypes.Cfnom</tt>: the friction coefficient is computed by giving the (constant) value of the Fanning friction factor <tt>Cfnom</tt>.
<li><tt>FFtype = FFtypes.Colebrook</tt>: the Fanning friction factor is computed by Colebrook's equation (assuming Re > 2100, e.g. turbulent flow).
<li><tt>FFtype = FFtypes.NoFriction</tt>: no friction is assumed across the pipe.</ul>
<p>If <tt>QuasiStatic</tt> is set to true, the dynamic terms are neglected in the mass, momentum, and energy balances, i.e., quasi-static behaviour is modelled. It is also possible to neglect only the dynamic momentum term by setting <tt>DynamicMomentum = false</tt>.
<p>If <tt>HydraulicCapacitance = 2</tt> (default option) then the mass buildup term depending on the pressure is lumped at the outlet, while the optional momentum buildup term depending on the flowrate is lumped at the inlet; therefore, the state variables are the outlet pressure and the inlet flowrate. If <tt>HydraulicCapacitance = 1</tt> the reverse takes place.
<p>Start values for the pressure and flowrate state variables are specified by <tt>pstart</tt>, <tt>wstart</tt>. The start values for the node temperatures are linearly distributed from <tt>Tstartin</tt> at the inlet to <tt>Tstartout</tt> at the outlet. The (uniform) start value of the gas composition is specified by <tt>Xstart</tt>.
<p>A bank of <tt>Nt</tt> identical tubes working in parallel can be modelled by setting <tt>Nt > 1</tt>. The geometric parameters always refer to a <i>single</i> tube.
<p>This models makes the temperature and external heat flow distributions available to connected components through the <tt>wall</tt> connector. If other variables (e.g. the heat transfer coefficient) are needed by external components to compute the actual heat flow, the <tt>wall</tt> connector can be replaced by an extended version of the <tt>DHT</tt> connector.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>2</TD><TD>Number of nodes for thermal variables</TD></TR>
<TR><TD>Integer</TD><TD>Nt</TD><TD>1</TD><TD>Number of tubes in parallel</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Distance"
>Distance</A></TD><TD>L</TD><TD>&nbsp;</TD><TD>Tube length [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A></TD><TD>H</TD><TD>0</TD><TD>Elevation of outlet over inlet [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Cross-sectional area (single tube) [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>omega</TD><TD>&nbsp;</TD><TD>Perimeter of heat transfer surface (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>Dhyd</TD><TD>&nbsp;</TD><TD>Hydraulic Diameter (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate (total) [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes.Temp"
>Temp</A></TD><TD>FFtype</TD><TD>&nbsp;</TD><TD>Friction Factor Type</TD></TR>
<TR><TD>Real</TD><TD>Kfnom</TD><TD>0</TD><TD>Nominal hydraulic resistance coefficient</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>0</TD><TD>Nominal pressure drop [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>0</TD><TD>Nominal inlet density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>Cfnom</TD><TD>0</TD><TD>Nominal Fanning friction factor</TD></TR>
<TR><TD>Real</TD><TD>e</TD><TD>0</TD><TD>Relative roughness (ratio roughness/diameter)</TD></TR>
<TR><TD>Boolean</TD><TD>DynamicMomentum</TD><TD>false</TD><TD>Inertial phenomena accounted for</TD></TR>
<TR><TD>Boolean</TD><TD>UniformComposition</TD><TD>true</TD><TD>Uniform gas composition is assumed</TD></TR>
<TR><TD>Boolean</TD><TD>QuasiStatic</TD><TD>false</TD><TD>Quasi-static model (mass, energy and momentum static balances</TD></TR>
<TR><TD>Integer</TD><TD>HydraulicCapacitance</TD><TD>2</TD><TD>1: Upstream, 2: Downstream</TD></TR>
<TR><TD>Boolean</TD><TD>avoidInletEnthalpyDerivative</TD><TD>true</TD><TD>Avoid inlet enthalpy derivative</TD></TR>
<TR><TD>Real</TD><TD>wnf</TD><TD>0.01</TD><TD>Fraction of nominal flow rate at which linear friction equals turbulent friction</TD></TR>
<TR><TD>Real</TD><TD>Kfc</TD><TD>1</TD><TD>Friction factor correction coefficient</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHT"
>DHT</A></TD><TD>wall</TD><TD>redeclare Thermal.DHT wall(N...</TD><TD>&nbsp;</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstartin</TD><TD>300</TD><TD>Inlet temperature start value [K]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstartout</TD><TD>300</TD><TD>Outlet temperature start value [K]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart[N]</TD><TD>linspace(Tstartin, Tstartout...</TD><TD>Start value of temperature vector (initialized by default) [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>101325</TD><TD>Pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[nX]</TD><TD>Medium.reference_X</TD><TD>Start gas composition [1]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHT"
>DHT</A></TD><TD>wall</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Flow1D <font color="darkgreen">
  &quot;1-dimensional fluid flow model for gas (finite volumes)&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.Tube"
>Icons.Gas.Tube</A>;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes"
>ThermoPower.Choices.Flow1D.FFtypes</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium=<A HREF="ThermoPower_Media_GenericGas.html#ThermoPower.Media.GenericGas"
>Media.GenericGas</A>;
  <font color="blue">parameter </font>Integer N(min=2) = 2 <font color="darkgreen">&quot;Number of nodes for thermal variables&quot;</font>;
  <font color="blue">parameter </font>Integer Nt=1 <font color="darkgreen">&quot;Number of tubes in parallel&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Distance"
>Distance</A> L <font color="darkgreen">&quot;Tube length&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A> H=0 <font color="darkgreen">&quot;Elevation of outlet over inlet&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> A <font color="darkgreen">&quot;Cross-sectional area (single tube)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> omega <font color="darkgreen">&quot;Perimeter of heat transfer surface (single tube)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> Dhyd <font color="darkgreen">&quot;Hydraulic Diameter (single tube)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wnom <font color="darkgreen">&quot;Nominal mass flowrate (total)&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes.Temp"
>FFtypes.Temp</A> FFtype <font color="darkgreen">&quot;Friction Factor Type&quot;</font>;
  <font color="blue">parameter </font>Real Kfnom=0 <font color="darkgreen">&quot;Nominal hydraulic resistance coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> dpnom=0 <font color="darkgreen">&quot;Nominal pressure drop&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A> rhonom=0 <font color="darkgreen">&quot;Nominal inlet density&quot;</font>;
  <font color="blue">parameter </font>Real Cfnom=0 <font color="darkgreen">&quot;Nominal Fanning friction factor&quot;</font>;
  <font color="blue">parameter </font>Real e=0 <font color="darkgreen">&quot;Relative roughness (ratio roughness/diameter)&quot;</font>;
  <font color="blue">parameter </font>Boolean DynamicMomentum=false <font color="darkgreen">&quot;Inertial phenomena accounted for&quot;</font>;
  <font color="blue">parameter </font>Boolean UniformComposition=true <font color="darkgreen">
    &quot;Uniform gas composition is assumed&quot;</font>;
  <font color="blue">parameter </font>Boolean QuasiStatic=false <font color="darkgreen">
    &quot;Quasi-static model (mass, energy and momentum static balances&quot;</font>;
  <font color="blue">parameter </font>Integer HydraulicCapacitance=2 <font color="darkgreen">&quot;1: Upstream, 2: Downstream&quot;</font>;
  <font color="blue">parameter </font>Boolean avoidInletEnthalpyDerivative = true <font color="darkgreen">
    &quot;Avoid inlet enthalpy derivative&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tstartin=300 <font color="darkgreen">&quot;Inlet temperature start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tstartout=300 <font color="darkgreen">&quot;Outlet temperature start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tstart[N]=<font color="red">linspace</font>(Tstartin,Tstartout,N) <font color="darkgreen">
    &quot;Start value of temperature vector (initialized by default)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstart=101325 <font color="darkgreen">&quot;Pressure start value&quot;</font>;
  <font color="blue">parameter </font>Real wnf=0.01 <font color="darkgreen">
    &quot;Fraction of nominal flow rate at which linear friction equals turbulent friction&quot;</font>;
  <font color="blue">parameter </font>Real Kfc=1 <font color="darkgreen">&quot;Friction factor correction coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A> Xstart[nX]=Medium.reference_X <font color="darkgreen">&quot;Start gas composition&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Choices.Init.Options.Temp</A> initOpt=Choices.Init.Options.noInit <font color="darkgreen">
    &quot;Initialisation option&quot;</font>;
<font color="blue">protected </font>
  <font color="blue">parameter </font>Integer nXi=Medium.nXi <font color="darkgreen">&quot;number of independent mass fractions&quot;</font>;
  <font color="blue">parameter </font>Integer nX=Medium.nX <font color="darkgreen">&quot;total number of mass fractions&quot;</font>;
  <font color="blue">constant </font>Real g=Modelica.Constants.g_n;
<font color="blue">public </font>
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> infl(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium, w(start=wnom));
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> outfl(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium, w(start=-wnom));
  <font color="blue">replaceable </font><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHT"
>Thermal.DHT</A> wall(N=N);
<font color="blue">public </font>
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas[N](
    p(start=<font color="red">ones</font>(N)*pstart),
    T(start=Tstart),
    state(p(start=<font color="red">ones</font>(N)*pstart),
    T(start=<font color="red">ones</font>(N)*Tstartin+(0:(N-1))/(N-1)*(Tstartout-Tstartin)))) <font color="darkgreen">
    &quot;Gas nodal properties&quot;</font>;
  <font color="darkgreen">  // Xi(start=fill(Xstart[1:nXi],N)),</font>
  <font color="darkgreen">  // X(start=fill(Xstart,N)),</font>
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> Dpfric <font color="darkgreen">&quot;Pressure drop due to friction&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> omega_hyd <font color="darkgreen">&quot;Wet perimeter (single tube)&quot;</font>;
  Real Kf <font color="darkgreen">&quot;Friction factor&quot;</font>;
  Real Kfl <font color="darkgreen">&quot;Linear friction factor&quot;</font>;
  Real dwdt <font color="darkgreen">&quot;Time derivative of mass flow rate&quot;</font>;
  Real Cf <font color="darkgreen">&quot;Fanning friction factor&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w(start=wnom/Nt) <font color="darkgreen">&quot;Mass flowrate (single tube)&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Ttilde[N - 1](
    start=<font color="red">ones</font>(N - 1)*Tstartin + (1:(N - 1))/(N - 1)*(Tstartout - Tstartin),
    stateSelect=StateSelect.prefer) <font color="darkgreen">&quot;Temperature state variables&quot;</font>;
  Real Xtilde[<font color="blue">if </font>UniformComposition<font color="blue"> or </font>Medium.fixedX<font color="blue"> then </font>1<font color="blue"> else </font>N - 1, nX](
      start=<font color="red">ones</font>(<font color="red">size</font>(Xtilde, 1),<font color="red"> size</font>(Xtilde, 2))*<font color="red">diagonal</font>(Xstart[1:nX]),
      stateSelect=StateSelect.prefer) <font color="darkgreen">&quot;Composition state variables&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wbar[N - 1](<font color="blue">each </font>start=wnom/Nt);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Velocity</A> u[N] <font color="darkgreen">&quot;Fluid velocity&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> p(start=pstart, stateSelect=StateSelect.prefer);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A> Tr <font color="darkgreen">&quot;Residence time&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> M <font color="darkgreen">&quot;Gas Mass&quot;</font>;
  Real Q <font color="darkgreen">&quot;Total heat flow through the wall (all Nt tubes)&quot;</font>;
<font color="blue">protected </font>
  <font color="blue">parameter </font>Real dzdx = H/L <font color="darkgreen">&quot;Slope&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> l = L/(N - 1) <font color="darkgreen">&quot;Length of a single volume&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A> rhobar[N - 1] <font color="darkgreen">&quot;Fluid average density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificVolume"
>SpecificVolume</A> vbar[N - 1] <font color="darkgreen">&quot;Fluid average specific volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlux"
>HeatFlux</A> phibar[N - 1] <font color="darkgreen">&quot;Average heat flux&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByPressure"
>DerDensityByPressure</A> drbdp[N - 1] <font color="darkgreen">&quot;Derivative of average density by pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByTemperature"
>DerDensityByTemperature</A> drbdT1[N - 1] <font color="darkgreen">
    &quot;Derivative of average density by left temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByTemperature"
>DerDensityByTemperature</A> drbdT2[N - 1] <font color="darkgreen">
    &quot;Derivative of average density by right temperature&quot;</font>;
  Real drbdX1[N - 1, nX](unit=&quot;kg/m3&quot;) <font color="darkgreen">
    &quot;Derivative of average density by left composition&quot;</font>;
  Real drbdX2[N - 1, nX](unit=&quot;kg/m3&quot;) <font color="darkgreen">
    &quot;Derivative of average density by right composition&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificHeatCapacity"
>Medium.SpecificHeatCapacity</A> cvbar[N - 1] <font color="darkgreen">&quot;Average cv&quot;</font>;
  Real dMdt[N - 1] <font color="darkgreen">&quot;Derivative of mass in a finite volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificHeatCapacity"
>Medium.SpecificHeatCapacity</A> cv[N];
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.DerDensityByTemperature"
>Medium.DerDensityByTemperature</A> dddT[N] <font color="darkgreen">&quot;Derivative of density by temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.DerDensityByPressure"
>Medium.DerDensityByPressure</A> dddp[N] <font color="darkgreen">&quot;Derivative of density by pressure&quot;</font>;
  Real dddX[N,nX](unit=&quot;kg/m3&quot;) <font color="darkgreen">&quot;Derivative of density by composition&quot;</font>;
<font color="blue">equation </font>
<font color="darkgreen">//All equations are referred to a single tube</font>
  <font color="darkgreen">// Friction factor selection</font>
  omega_hyd = 4*A/Dhyd;
  <font color="blue">if </font>FFtype == FFtypes.Kfnom<font color="blue"> then</font>
    Kf = Kfnom*Kfc;
    Cf = 2*Kf*A^3/(omega_hyd*L);
  <font color="blue">elseif </font>FFtype == FFtypes.OpPoint<font color="blue"> then</font>
    Kf = dpnom*rhonom/(wnom/Nt)^2*Kfc;
    Cf = 2*Kf*A^3/(omega_hyd*L);
  <font color="blue">elseif </font>FFtype == FFtypes.Cfnom<font color="blue"> then</font>
    Kf = Cfnom*omega_hyd*L/(2*A^3)*Kfc;
    Cf = Cfnom*Kfc;
  <font color="blue">elseif </font>FFtype == FFtypes.Colebrook<font color="blue"> then</font>
    Cf=<font color="red">f_colebrook</font>(w,Dhyd/A,e,
          <font color="red">Medium.dynamicViscosity</font>(gas[<font color="red">integer</font>(N/2)].state))*Kfc;
    Kf = Cf*omega_hyd*L/(2*A^3);
  <font color="blue">elseif </font>FFtype == FFtypes.NoFriction<font color="blue"> then</font>
    Cf = 0;
    Kf = 0;
  <font color="blue">end if</font>;
  <font color="red">assert</font>(Kf&gt;=0, &quot;Negative friction coefficient&quot;);
  Kfl = wnom/Nt*wnf*Kf <font color="darkgreen">&quot;Linear friction factor&quot;</font>;

  <font color="darkgreen">// Dynamic momentum term</font>
  dwdt = <font color="blue">if </font>DynamicMomentum<font color="blue"> and </font><font color="blue">not </font>QuasiStatic<font color="blue"> then </font>
            <font color="red">der</font>(w)<font color="blue"> else </font>0;

  <font color="red">sum</font>(dMdt) = (infl.w + outfl.w)/Nt <font color="darkgreen">&quot;Mass balance&quot;</font>;
  L/A*dwdt + (outfl.p - infl.p) + Dpfric = 0 <font color="darkgreen">&quot;Momentum balance&quot;</font>;
  Dpfric = (<font color="blue">if </font>FFtype == FFtypes.NoFriction<font color="blue"> then </font>0<font color="blue"> else </font>
            <font color="red">noEvent</font>(Kf*<font color="red">abs</font>(w) + Kfl)*w*<font color="red">sum</font>(vbar)/(N - 1)) <font color="darkgreen">
    &quot;Pressure drop due to friction&quot;</font>;
  <font color="blue">for </font>j<font color="blue"> in </font>1:N - 1<font color="blue"> loop</font>
    <font color="blue">if </font><font color="blue">not </font>QuasiStatic<font color="blue"> then</font>
      <font color="darkgreen">// Dynamic mass and energy balances</font>
      A*l*rhobar[j]*cvbar[j]*<font color="red">der</font>(Ttilde[j]) + wbar[j]*(gas[j + 1].h - gas[j].h) =
        l*omega*phibar[j] <font color="darkgreen">&quot;Energy balance&quot;</font>;
      dMdt[j] = A*l*(drbdp[j]*<font color="red">der</font>(p)+
                     drbdT1[j]*<font color="red">der</font>(gas[j].T) + drbdT2[j]*<font color="red">der</font>(gas[j+1].T) +
                     <font color="red">vector</font>(drbdX1[j, :])*<font color="red">vector</font>(<font color="red">der</font>(gas[j].X))+
                     <font color="red">vector</font>(drbdX2[j, :])*<font color="red">vector</font>(<font color="red">der</font>(gas[j+1].X))) <font color="darkgreen">
        &quot;Mass balance&quot;</font>;
<font color="darkgreen">/*
      dMdt[j] = A*l*(drbdT[j]*der(Ttilde[j]) + drbdp[j]*der(p) + vector(drbdX[j, :])*
      vector(der(Xtilde[if UniformComposition then 1 else j, :])))
      &quot;Mass balance&quot;;
*/</font>
      <font color="darkgreen">// Average volume quantities</font>
      <font color="blue">if </font>avoidInletEnthalpyDerivative<font color="blue"> and </font>j == 1<font color="blue"> then</font>
      <font color="darkgreen">// first volume properties computed by the volume outlet properties</font>
        rhobar[j] = gas[j+1].d;
        drbdp[j] = dddp[j+1];
        drbdT1[j] = 0;
        drbdT2[j] = dddT[j+1];
        drbdX1[j, :] =<font color="red"> zeros</font>(<font color="red">size</font>(Xtilde,2));
        drbdX2[j, :] = dddX[j+1,:];
      <font color="blue">else</font>
      <font color="darkgreen">// volume properties computed by averaging</font>
        rhobar[j] = (gas[j].d + gas[j+1].d)/2;
        drbdp[j] = (dddp[j] + dddp[j+1])/2;
        drbdT1[j] = dddT[j]/2;
        drbdT2[j] = dddT[j+1]/2;
        drbdX1[j, :] = dddX[j,:]/2;
        drbdX2[j, :] = dddX[j+1,:]/2;
      <font color="blue">end if</font>;
      vbar[j] = 1/rhobar[j];
      wbar[j] = infl.w/Nt -<font color="red"> sum</font>(dMdt[1:j - 1]) - dMdt[j]/2;
      cvbar[j]=(cv[j]+cv[j+1])/2;
    <font color="blue">else</font>
      <font color="darkgreen">// Static mass and energy balances</font>
      wbar[j]*(gas[j + 1].h - gas[j].h) = l*omega*phibar[j] <font color="darkgreen">&quot;Energy balance&quot;</font>;
      dMdt[j] = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
      <font color="darkgreen">// Dummy values for unused average quantities</font>
      rhobar[j] = 0;
      drbdp[j] = 0;
      drbdT1[j] = 0;
      drbdT2[j] = 0;
      drbdX1[j, :] =<font color="red"> zeros</font>(nX);
      drbdX2[j, :] =<font color="red"> zeros</font>(nX);
      vbar[j] = 0;
      wbar[j] = infl.w/Nt;
      cvbar[j]= 0;
    <font color="blue">end if</font>;
  <font color="blue">end for</font>;
  Q = Nt*l*omega*<font color="red">sum</font>(phibar) <font color="darkgreen">&quot;Total heat flow through the lateral boundary&quot;</font>;
  <font color="blue">if </font>Medium.fixedX<font color="blue"> then</font>
    Xtilde =<font color="red"> fill</font>(Medium.reference_X, 1);
  <font color="blue">elseif </font>QuasiStatic<font color="blue"> then</font>
    Xtilde =<font color="red"> fill</font>(<font color="blue">if </font>w&gt;=0<font color="blue"> then </font>infl.XBA<font color="blue"> else </font>outfl.XAB,<font color="red"> size</font>(Xtilde,1)) <font color="darkgreen">
      &quot;Gas composition equal to actual inlet&quot;</font>;
  <font color="blue">elseif </font>UniformComposition<font color="blue"> then</font>
    <font color="red">der</font>(Xtilde[1, :]) = 1/L*<font color="red">sum</font>(u)/N*(gas[1].X - gas[N].X) <font color="darkgreen">
      &quot;Partial mass balance for the whole pipe&quot;</font>;
  <font color="blue">else</font>
    <font color="blue">for </font>j<font color="blue"> in </font>1:N - 1<font color="blue"> loop</font>
      <font color="red">der</font>(Xtilde[j, :]) = (u[j + 1] + u[j])/(2*l)*(gas[j].X - gas[j + 1].X) <font color="darkgreen">
        &quot;Partial mass balance for single volume&quot;</font>;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;
  <font color="blue">for </font>j<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    u[j] = w/(gas[j].d*A) <font color="darkgreen">&quot;Gas velocity&quot;</font>;
    gas[j].p = p;
  <font color="blue">end for</font>;
  <font color="darkgreen">// Fluid property computations</font>
  <font color="blue">for </font>j<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    <font color="blue">if </font><font color="blue">not </font>QuasiStatic<font color="blue"> then</font>
        cv[j]  =<font color="red">Medium.heatCapacity_cv</font>(gas[j].state);
      dddT[j]  =<font color="red">Medium.density_derT_p</font>(gas[j].state);
      dddp[j]  =<font color="red">Medium.density_derp_T</font>(gas[j].state);
      <font color="blue">if </font>nX &gt; 0<font color="blue"> then</font>
        dddX[j,:]=<font color="red">Medium.density_derX</font>(gas[j].state);
      <font color="blue">end if</font>;
    <font color="blue">else</font>
      <font color="darkgreen">// Dummy values (not needed by dynamic equations)</font>
        cv[j]  = 0;
      dddT[j]  = 0;
      dddp[j]  = 0;
      dddX[j,:]=<font color="red"> zeros</font>(nX);
    <font color="blue">end if</font>;
  <font color="blue">end for</font>;

  <font color="darkgreen">// Selection of representative pressure and flow rate variables</font>
  <font color="blue">if </font>HydraulicCapacitance == 1<font color="blue"> then</font>
    p = infl.p;
    w = -outfl.w/Nt;
  <font color="blue">else</font>
    p = outfl.p;
    w = infl.w/Nt;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Boundary conditions</font>
  infl.hAB = gas[1].h;
  outfl.hBA = gas[N].h;
  infl.XAB = gas[1].Xi;
  outfl.XBA = gas[N].Xi;

    gas[1].h = infl.hBA;
    gas[2:N].T = Ttilde;
    gas[1].Xi = infl.XBA;
    <font color="blue">for </font>j<font color="blue"> in </font>2:N<font color="blue"> loop</font>
      gas[j].Xi = Xtilde[<font color="blue">if </font>UniformComposition<font color="blue"> then </font>1<font color="blue"> else </font>j - 1, 1:nXi];
    <font color="blue">end for</font>;
<font color="darkgreen">/*
  if w &gt;= 0 then
    gas[1].h = infl.hBA;
    gas[2:N].T = Ttilde;
    gas[1].Xi = infl.XBA;
    for j in 2:N loop
      gas[j].Xi = Xtilde[if UniformComposition then 1 else j - 1, 1:nXi];
    end for;
  else
    gas[N].h = outfl.hAB;
    gas[1:N - 1].T = Ttilde;
    gas[N].Xi = outfl.XAB;
    for j in 1:N - 1 loop
      gas[j].Xi = Xtilde[if UniformComposition then 1 else j, 1:nXi];
    end for;
  end if;
*/</font>

  gas.T = wall.T;
  phibar = (wall.phi[1:N - 1] + wall.phi[2:N])/2;

  M=<font color="red">sum</font>(rhobar)*A*l <font color="darkgreen">&quot;Total gas mass&quot;</font>;
  Tr=<font color="red">noEvent</font>(M/<font color="red">max</font>(infl.w/Nt,Modelica.Constants.eps)) <font color="darkgreen">&quot;Residence time&quot;</font>;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> or </font>QuasiStatic<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="blue">if </font>(<font color="blue">not </font>Medium.singleState)<font color="blue"> then</font>
      <font color="red">der</font>(p) = 0;
    <font color="blue">end if</font>;
    <font color="red">der</font>(Ttilde) =<font color="red"> zeros</font>(N-1);
    <font color="blue">if </font>(<font color="blue">not </font>Medium.fixedX)<font color="blue"> then</font>
      <font color="red">der</font>(Xtilde) =<font color="red"> zeros</font>(<font color="red">size</font>(Xtilde,1),<font color="red"> size</font>(Xtilde,2));
    <font color="blue">end if</font>;
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyStateNoP<font color="blue"> then</font>
    <font color="red">der</font>(Ttilde) =<font color="red"> zeros</font>(N-1);
    <font color="blue">if </font>(<font color="blue">not </font>Medium.fixedX)<font color="blue"> then</font>
      <font color="red">der</font>(Xtilde) =<font color="red"> zeros</font>(<font color="red">size</font>(Xtilde,1),<font color="red"> size</font>(Xtilde,2));
    <font color="blue">end if</font>;
 <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;

<font color="blue">end </font>Flow1D;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE f_colebrook<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="ThermoPower.Gas.f_colebrook"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.f_colebrook</H2>
<B>Fanning friction factor for water/steam flows</B><p>
<H3>Information</H3>
<PRE></pre>
<p>The Fanning friction factor is computed by Colebrook's equation, assuming turbulent, one-phase flow. For low Reynolds numbers, the limit value for turbulent flow is returned.
<p><b>Revision history:</b></p>
<ul>
<li><i>1 Oct 2003</i>
    by <a href="mailto:francesco.casella@polimi.it">Francesco Casella</a>:<br>
       First release.</li>
</ul>
<pre></PRE>
<H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>w</TD><TD>&nbsp;</TD><TD>[kg/s]</TD></TR>
<TR><TD>Real</TD><TD>D_A</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>e</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>mu</TD><TD>&nbsp;</TD><TD>[Pa.s]</TD></TR>
</TABLE>
<H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>f</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> f_colebrook <font color="darkgreen">&quot;Fanning friction factor for water/steam flows&quot;</font>
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w;
  <font color="blue">input </font>Real D_A;
  <font color="blue">input </font>Real e;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A> mu;
  <font color="blue">output </font>Real f;
<font color="blue">protected </font>
  Real Re;
<font color="blue">algorithm </font>
  Re := w*D_A/mu;
  Re := <font color="blue">if </font>Re &gt; 2100<font color="blue"> then </font>Re<font color="blue"> else </font>2100;
  f := 0.332/(<font color="red">log</font>(e/3.7 + 5.47/Re^0.9)^2);
<font color="blue">end </font>f_colebrook;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE CombustionChamberBase<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.CombustionChamberBaseI.png" ALT="ThermoPower.Gas.CombustionChamberBase" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.CombustionChamberBase"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.CombustionChamberBase</H2>
<B>Combustion Chamber</B><p>
<IMG SRC="ThermoPower.Gas.CombustionChamberBaseD.png" ALT="ThermoPower.Gas.CombustionChamberBase">
<H3>Information</H3>
<PRE></pre>
This is the model-base of a Combustion Chamber, with a constant volume.
<p>The metal wall temperature and the heat transfer coefficient between the wall and the fluid are uniform. The wall is thermally insulated from the outside. It has been assumed that inlet gases are premixed before entering in the volume.
<p><b>Modelling options</b></p>
<p>This model has three different Medium models to characterize the inlet air, fuel, and flue gas exhaust.
<p>If <tt>gamma = 0</tt>, the thermal effects of the surrounding walls are neglected.
</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V</TD><TD>&nbsp;</TD><TD>Inner volume [m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>S</TD><TD>0</TD><TD>Inner surface [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>gamma</TD><TD>0</TD><TD>Heat Transfer Coefficient [W/(m2.K)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>HeatCapacity</A></TD><TD>Cm</TD><TD>0</TD><TD>Metal Heat Capacity [J/K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>HH</TD><TD>&nbsp;</TD><TD>Lower Heating value of fuel [J/kg]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>Tmstart</TD><TD>300</TD><TD>Metal wall start temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>101325</TD><TD>Pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart</TD><TD>300</TD><TD>Temperature start value [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Exhaust.nX]</TD><TD>Exhaust.reference_X</TD><TD>Start flue gas composition [1]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>ina</TD><TD>inlet air</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inf</TD><TD>inlet fuel</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>out</TD><TD>flue gas</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> CombustionChamberBase <font color="darkgreen">&quot;Combustion Chamber&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.Mixer"
>Icons.Gas.Mixer</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Air=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Fuel=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Exhaust=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> V <font color="darkgreen">&quot;Inner volume&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> S=0 <font color="darkgreen">&quot;Inner surface&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma=0 <font color="darkgreen">&quot;Heat Transfer Coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>HeatCapacity</A> Cm=0 <font color="darkgreen">&quot;Metal Heat Capacity&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A> Tmstart=300 <font color="darkgreen">&quot;Metal wall start temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> HH <font color="darkgreen">&quot;Lower Heating value of fuel&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstart=101325 <font color="darkgreen">&quot;Pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tstart=300 <font color="darkgreen">&quot;Temperature start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A> Xstart[Exhaust.nX]=Exhaust.reference_X <font color="darkgreen">
    &quot;Start flue gas composition&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Choices.Init.Options.Temp</A> initOpt=Choices.Init.Options.noInit <font color="darkgreen">
    &quot;Initialisation option&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Exhaust.BaseProperties</A> fluegas(p(start=pstart),T(start=Tstart),
                                 X(start=Xstart[1:Exhaust.nXi]));
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> M <font color="darkgreen">&quot;Gas total mass&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> MX[Exhaust.nXi] <font color="darkgreen">&quot;Partial flue gas masses&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.InternalEnergy"
>InternalEnergy</A> E <font color="darkgreen">&quot;Gas total energy&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tm(start=Tmstart) <font color="darkgreen">&quot;Wall temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Air.SpecificEnthalpy</A> hia <font color="darkgreen">&quot;Air specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Fuel.SpecificEnthalpy</A> hif <font color="darkgreen">&quot;Fuel specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Exhaust.SpecificEnthalpy</A> ho <font color="darkgreen">&quot;Outlet specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> HR <font color="darkgreen">&quot;Heat rate&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A> Tr <font color="darkgreen">&quot;Residence time&quot;</font>;
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> ina(<font color="blue">redeclare </font><font color="blue">package</font> Medium = <A HREF="ThermoPower_Gas_Air.html#ThermoPower.Gas.CombustionChamberBase.Air"
>Air</A>) <font color="darkgreen">&quot;inlet air&quot;</font>;
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> inf(<font color="blue">redeclare </font><font color="blue">package</font> Medium = <A HREF="ThermoPower_Gas_Fuel.html#ThermoPower.Gas.CombustionChamberBase.Fuel"
>Fuel</A>) <font color="darkgreen">&quot;inlet fuel&quot;</font>;
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> out(<font color="blue">redeclare </font><font color="blue">package</font> Medium = <A HREF="ThermoPower_Gas_Exhaust.html#ThermoPower.Gas.CombustionChamberBase.Exhaust"
>Exhaust</A>) <font color="darkgreen">&quot;flue gas&quot;</font>;
<font color="blue">equation </font>
  M=fluegas.d*V <font color="darkgreen">&quot;Gas mass&quot;</font>;
  E=fluegas.u*M <font color="darkgreen">&quot;Gas energy&quot;</font>;
  MX = fluegas.Xi*M <font color="darkgreen">&quot;Component masses&quot;</font>;
  HR = inf.w*HH;
  <font color="red">der</font>(M) = ina.w+inf.w+out.w <font color="darkgreen">&quot;Gas mass balance&quot;</font>;
  <font color="red">der</font>(E) = ina.w*hia+inf.w*hif+out.w*ho+HR-gamma*S*(fluegas.T - Tm) <font color="darkgreen">
    &quot;Gas energy balance&quot;</font>;
  <font color="blue">if </font>Cm &gt; 0<font color="blue"> and </font>gamma &gt; 0<font color="blue"> then</font>
    Cm*<font color="red">der</font>(Tm) = gamma*S*(fluegas.T - Tm) <font color="darkgreen">&quot;Metal wall energy balance&quot;</font>;
  <font color="blue">else</font>
    Tm = fluegas.T;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Set gas properties</font>
  out.p=fluegas.p;
  out.hBA=fluegas.h;
  out.XBA=fluegas.Xi;

  <font color="darkgreen">// Boundary conditions</font>
  ina.p   = fluegas.p;
  ina.hAB = 0;
  ina.XAB=Air.reference_X;
  inf.p   = fluegas.p;
  inf.hAB = 0;
  inf.XAB=Fuel.reference_X;
  <font color="red">assert</font>(ina.w &gt;= 0,&quot;The model does not support flow reversal&quot;);
   hia = ina.hBA;
  <font color="red">assert</font>(inf.w &gt;=0, &quot;The model does not support flow reversal&quot;);
   hif = inf.hBA;
  <font color="red">assert</font>(out.w &lt;=0, &quot;The model does not support flow reversal&quot;);
   ho = fluegas.h;

  Tr=<font color="red">noEvent</font>(M/<font color="red">max</font>(<font color="red">abs</font>(out.w),Modelica.Constants.eps));
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="darkgreen">// Initial conditions</font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="red">der</font>(fluegas.p) = 0;
    <font color="red">der</font>(fluegas.T) = 0;
    <font color="red">der</font>(fluegas.Xi)=<font color="red">zeros</font>(Exhaust.nXi);
    <font color="blue">if </font>(Cm &gt; 0<font color="blue"> and </font>gamma &gt;0)<font color="blue"> then</font>
      <font color="red">der</font>(Tm) = 0;
    <font color="blue">end if</font>;
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyStateNoP<font color="blue"> then</font>
    <font color="red">der</font>(fluegas.T) = 0;
    <font color="red">der</font>(fluegas.Xi)=<font color="red">zeros</font>(Exhaust.nXi);
    <font color="blue">if </font>(Cm &gt; 0<font color="blue"> and </font>gamma &gt;0)<font color="blue"> then</font>
      <font color="red">der</font>(Tm) = 0;
    <font color="blue">end if</font>;
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;

<font color="blue">end </font>CombustionChamberBase;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE CombustionChamber<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.CombustionChamberBaseI.png" ALT="ThermoPower.Gas.CombustionChamber" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.CombustionChamber"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.CombustionChamber</H2>
<B>Combustion Chamber</B><p>
<IMG SRC="ThermoPower.Gas.CombustionChamberBaseD.png" ALT="ThermoPower.Gas.CombustionChamber">
<H3>Information</H3>
<PRE></pre>
This model extends the CombustionChamber Base model, with the definition of the gases.
<p>In particular, the air inlet uses the <tt>Media.Air</tt> medium model, the fuel input uses the <tt>Media.NaturalGas</tt> medium model, and the flue gas outlet uses the <tt>Medium.FlueGas</tt> medium model.
<p>The composition of the outgoing gas is determined by the mass balance of every component, taking into account the combustion reaction CH4+2O2--->2H2O+CO2.</p>
<p>The model assumes complete combustion, so that it is only valid if the oxygen flow at the air inlet is greater than the stoichiometric flow corresponding to the flow at the fuel inlet.</p>

<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Air</TD><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>&nbsp;</TD></TR>
<TR><TD colspan="2">replaceable package Fuel</TD><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>&nbsp;</TD></TR>
<TR><TD colspan="2">replaceable package Exhaust</TD><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V</TD><TD>&nbsp;</TD><TD>Inner volume [m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>S</TD><TD>0</TD><TD>Inner surface [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>gamma</TD><TD>0</TD><TD>Heat Transfer Coefficient [W/(m2.K)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>HeatCapacity</A></TD><TD>Cm</TD><TD>0</TD><TD>Metal Heat Capacity [J/K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>HH</TD><TD>&nbsp;</TD><TD>Lower Heating value of fuel [J/kg]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>Tmstart</TD><TD>300</TD><TD>Metal wall start temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>101325</TD><TD>Pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart</TD><TD>300</TD><TD>Temperature start value [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Exhaust.nX]</TD><TD>Exhaust.reference_X</TD><TD>Start flue gas composition [1]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Air</TD><TD>&nbsp;</TD></TR>
<TR><TD colspan="2">replaceable package Fuel</TD><TD>&nbsp;</TD></TR>
<TR><TD colspan="2">replaceable package Exhaust</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>ina</TD><TD>inlet air</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inf</TD><TD>inlet fuel</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>out</TD><TD>flue gas</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> CombustionChamber <font color="darkgreen">&quot;Combustion Chamber&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.CombustionChamberBase"
>CombustionChamberBase</A>(
  <font color="blue">redeclare </font><font color="blue">package</font> Air=<A HREF="ThermoPower_Media_Air.html#ThermoPower.Media.Air"
>Media.Air</A> <font color="darkgreen">&quot;O2, H2O, Ar, N2&quot;</font>,
  <font color="blue">redeclare </font><font color="blue">package</font> Fuel=<A HREF="ThermoPower_Media_NaturalGas.html#ThermoPower.Media.NaturalGas"
>Media.NaturalGas</A> <font color="darkgreen">&quot;N2, CO2, CH4&quot;</font>,
  <font color="blue">redeclare </font><font color="blue">package</font> Exhaust=<A HREF="ThermoPower_Media_FlueGas.html#ThermoPower.Media.FlueGas"
>Media.FlueGas</A> <font color="darkgreen">&quot;O2, Ar, H2O, CO2, N2&quot;</font>);
  Real wcomb(<font color="blue">final </font>quantity=&quot;MolarFlowRate&quot;, unit=&quot;mol/s&quot;) <font color="darkgreen">
    &quot;Molar Combustion rate (CH4)&quot;</font>;
  Real lambda <font color="darkgreen">
    &quot;Stoichiometric ratio (&gt;1 if air flow is greater than stoichiometric)&quot;</font>;

<font color="blue">equation </font>
  wcomb=inf.w*inf.XBA[3]/Fuel.data[3].MM <font color="darkgreen">&quot;Combustion molar flow rate&quot;</font>;
  lambda= (ina.w*ina.XBA[1]/Air.data[1].MM) / (2 * wcomb);
  <font color="red">assert</font>(lambda &gt;=1, &quot;Not enough oxygen flow&quot;);
  <font color="red">der</font>(MX[1])=ina.w*ina.XBA[1] + out.w*fluegas.X[1] - 2*wcomb*Exhaust.data[1].MM <font color="darkgreen">&quot;oxygen&quot;</font>;
  <font color="red">der</font>(MX[2])=ina.w*ina.XBA[3] + out.w*fluegas.X[2] <font color="darkgreen">&quot;argon&quot;</font>;
  <font color="red">der</font>(MX[3])=ina.w*ina.XBA[2] + out.w*fluegas.X[3] + 2*wcomb*Exhaust.data[3].MM <font color="darkgreen">&quot;water&quot;</font>;
  <font color="red">der</font>(MX[4])=inf.w*inf.XBA[2] + out.w*fluegas.X[4] + wcomb*Exhaust.data[4].MM <font color="darkgreen">
    &quot;carbondioxide&quot;</font>;
  <font color="red">der</font>(MX[5])=ina.w*ina.XBA[4] + out.w*fluegas.X[5] + inf.w*inf.XBA[1] <font color="darkgreen">
    &quot;nitrogen&quot;</font>;
<font color="blue">end </font>CombustionChamber;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE CompressorBase<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.CompressorBaseI.png" ALT="ThermoPower.Gas.CompressorBase" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.CompressorBase"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.CompressorBase</H2>
<B>Gas compressor</B><p>
<IMG SRC="ThermoPower.Gas.CompressorBaseD.png" ALT="ThermoPower.Gas.CompressorBase">
<H3>Information</H3>
<PRE></pre>
<p>This is the base model for a compressor, including the interface and all equations except the actual computation of the performance characteristics. Reverse flow conditions are not supported.</p>
<p>This model does not include any shaft inertia by itself; if that is needed, connect a Modelica.Mechanics.Rotational.Inertia model to one of the shaft connectors.</p>
<p>As a base-model, it can be used both for axial and centrifugal compressors.
<p><b>Modelling options</b></p>
<p>The actual gas used in the component is determined by the replaceable <tt>Medium</tt> package. In the case of multiple component, variable composition gases, the start composition is given by <tt>Xstart</tt>, whose default value is <tt>Medium.reference_X</tt>.
<p>The following options are available to calculate the enthalpy of the outgoing gas:
<ul><li><tt>explicitIsentropicEnthalpy = true</tt>: the isentropic enthalpy <tt>hout_iso</tt> is calculated by the <tt>Medium.isentropicEnthalpy</tt> function. <li><tt>explicitIsentropicEnthalpy = false</tt>: the isentropic enthalpy is obtained by equating the specific entropy of the inlet gas <tt>gas_in</tt> and of a fictious gas state <tt>gas_iso</tt>, with the same pressure of the outgoing gas; both are computed with the function <tt>Medium.specificEntropy</tt>.</pp></ul>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>explicitIsentropicEnthalpy</TD><TD>true</TD><TD>isentropicEnthalpy function used</TD></TR>
<TR><TD>Real</TD><TD>eta_mech</TD><TD>0.98</TD><TD>mechanical efficiency</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tdes_in</TD><TD>&nbsp;</TD><TD>inlet design temperature [K]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart_in</TD><TD>&nbsp;</TD><TD>inlet start pressure [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart_out</TD><TD>&nbsp;</TD><TD>outlet start pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart_in</TD><TD>Tdes_in</TD><TD>inlet start temperature [K]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart_out</TD><TD>&nbsp;</TD><TD>outlet start temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Medium.nX]</TD><TD>Medium.reference_X</TD><TD>start gas composition [1]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Flange_a</A></TD><TD>shaft_a</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Flange_b</A></TD><TD>shaft_b</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> CompressorBase <font color="darkgreen">&quot;Gas compressor&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.Compressor"
>ThermoPower.Icons.Gas.Compressor</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <font color="blue">parameter </font>Boolean explicitIsentropicEnthalpy=true <font color="darkgreen">
    &quot;isentropicEnthalpy function used&quot;</font>;
  <font color="blue">parameter </font>Real eta_mech=0.98 <font color="darkgreen">&quot;mechanical efficiency&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> pstart_in <font color="darkgreen">&quot;inlet start pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> pstart_out <font color="darkgreen">&quot;outlet start pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>ThermoPower.AbsoluteTemperature</A> Tdes_in <font color="darkgreen">&quot;inlet design temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>ThermoPower.AbsoluteTemperature</A> Tstart_in = Tdes_in <font color="darkgreen">
    &quot;inlet start temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>ThermoPower.AbsoluteTemperature</A> Tstart_out <font color="darkgreen">
    &quot;outlet start temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>Modelica.SIunits.MassFraction</A> Xstart[Medium.nX]=Medium.reference_X <font color="darkgreen">
    &quot;start gas composition&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas_in(
    p(start=pstart_in),
    T(start=Tstart_in),
    Xi(start=Xstart[1:Medium.nXi]));
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas_iso(
    p(start=pstart_out),
    T(start=Tstart_out),
    Xi(start=Xstart[1:Medium.nXi]));
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hout_iso <font color="darkgreen">&quot;Outlet isentropic enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hout <font color="darkgreen">&quot;Outlet enthaply&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEntropy"
>Medium.SpecificEntropy</A> s_in <font color="darkgreen">&quot;Inlet specific entropy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> pout(start=pstart_out) <font color="darkgreen">&quot;Outlet pressure&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</A> w <font color="darkgreen">&quot;Gas flow rate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> phi <font color="darkgreen">&quot;shaft rotation angle&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>Modelica.SIunits.AngularVelocity</A> omega <font color="darkgreen">&quot;shaft angular velocity&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Torque"
>Modelica.SIunits.Torque</A> tau <font color="darkgreen">&quot;net torque acting on the compressor&quot;</font>;

  Real eta <font color="darkgreen">&quot;isentropic efficiency&quot;</font>;
  Real PR <font color="darkgreen">&quot;pressure ratio&quot;</font>;

  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>ThermoPower.Gas.FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>ThermoPower.Gas.FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> shaft_a;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Modelica.Mechanics.Rotational.Interfaces.Flange_b</A> shaft_b;

<font color="blue">equation </font>
  w = inlet.w;
  <font color="red">assert</font>(w &gt;= 0, &quot;The compressor model does not support flow reversal&quot;);
  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;

  <font color="darkgreen">// Set inlet gas properties</font>
  gas_in.p = inlet.p;
  gas_in.h = inlet.hBA;
  gas_in.Xi = inlet.XBA;

  <font color="darkgreen">// Set outlet gas properties</font>
  outlet.p = pout;
  outlet.hBA = hout;
  outlet.XBA = gas_in.Xi;

  <font color="darkgreen">// Equations for reverse flow (not used)</font>
  inlet.hAB = outlet.hAB;
  inlet.XAB = outlet.XAB;

  <font color="darkgreen">// Component mass balances</font>
  gas_iso.Xi = gas_in.Xi;

  <font color="blue">if </font>explicitIsentropicEnthalpy<font color="blue"> then</font>
     hout_iso=<font color="red">Medium.isentropicEnthalpy</font>(outlet.p,gas_in.state) <font color="darkgreen">
      &quot;Approximated isentropic enthalpy&quot;</font>;
      hout-gas_in.h= 1/eta*(hout_iso-gas_in.h);
   <font color="darkgreen">// dummy assignments</font>
    s_in=0;
    gas_iso.p=1e5;
    gas_iso.T=300;
  <font color="blue">else</font>
    <font color="darkgreen">// Properties of the gas after isentropic transformation</font>
    gas_iso.p = pout;
    s_in=<font color="red">Medium.specificEntropy</font>(gas_in.state);
    s_in=<font color="red">Medium.specificEntropy</font>(gas_iso.state);
    hout - gas_in.h = 1/eta*(gas_iso.h - gas_in.h);
    <font color="darkgreen">// dummy assignment</font>
    hout_iso=0;
  <font color="blue">end if</font>;

  w*(hout - gas_in.h)*eta_mech = tau*omega <font color="darkgreen">&quot;Energy balance&quot;</font>;
  PR=pout/gas_in.p <font color="darkgreen">&quot;Pressure ratio&quot;</font>;

  <font color="darkgreen">// Mechanical boundary conditions  </font>
  shaft_a.phi = phi;
  shaft_b.phi = phi;
  shaft_a.tau + shaft_b.tau = tau;
  <font color="red">der</font>(phi) = omega;
<font color="blue">end </font>CompressorBase;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Compressor<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.CompressorBaseI.png" ALT="ThermoPower.Gas.Compressor" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.Compressor"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.Compressor</H2>
<B>Gas compressor</B><p>
<IMG SRC="ThermoPower.Gas.CompressorD.png" ALT="ThermoPower.Gas.Compressor">
<H3>Information</H3>
<PRE></pre>
This model adds the performance characteristics to the Compressor_Base model, by means of 2D interpolation tables.</p>
<p>The perfomance characteristics are specified by two characteristic equations: the first relates the flow number <tt>phic</tt>, the pressure ratio <tt>PR</tt> and the referred speed <tt>N_T</tt>; the second relates the efficiency <tt>eta</tt>, the flow number <tt>phic</tt>, and the referred speed <tt>N_T</tt> [1]. To avoid singularities, the two characteristic equations are expressed in parametric form by adding a further variable <tt>beta</tt> (method of beta lines [2]).
<p>The performance maps are thus tabulated into three differents tables, <tt>tablePhic</tt>,  <tt>tablePR</tt> and <tt>tableEta</tt>, which express <tt>phic</tt>, <tt>PR</tt> and <tt>eta</tt> as a function of <tt>N_T</tt> and <tt>beta</tt>, respectively, where <tt>N_T</tt> is the first row while <tt>beta</tt> is the first column. The referred speed <tt>N_T</tt> is defined as a percentage of the design referred speed and <tt>beta</tt> are arbitrary lines, usually drawn parallel to the surge-line on the performance maps.
<p><tt>Modelica.Blocks.Tables.CombiTable2D</tt> interpolates the tables to obtain values of referred flow, pressure ratio and efficiency at given levels of referred speed and beta.
<p><b>Modelling options</b></p>
<p>The following options are available to determine how the table is defined:
<ul><li><tt>Table = 0</tt>: the table is explicitly supplied as matrix parameter.
<li><tt>Table = 1</tt>: the table is read from a file; the string <tt>fileName</tt> contains the path to the files where the tables are stored, either in ASCII or Matlab binary format.
</ul>
<p><b>References:</b></p>
<ol>
<li>S. L. Dixon: <i>Fluid mechanics, thermodynamics of turbomachinery</i>, Oxford, Pergamon press, 1966, pp. 213.
<li>P. P. Walsh, P. Fletcher: <i>Gas Turbine Performance</i>, 2nd ed., Oxford, Blackwell, 2004, pp. 646.
</ol>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>&nbsp;</TD></TR>
<TR><TD>Boolean</TD><TD>explicitIsentropicEnthalpy</TD><TD>true</TD><TD>isentropicEnthalpy function used</TD></TR>
<TR><TD>Real</TD><TD>eta_mech</TD><TD>0.98</TD><TD>mechanical efficiency</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tdes_in</TD><TD>&nbsp;</TD><TD>inlet design temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>AngularVelocity</A></TD><TD>Ndesign</TD><TD>&nbsp;</TD><TD>Design velocity [rad/s]</TD></TR>
<TR><TD>Real</TD><TD>tablePhic[:, :]</TD><TD>fill(0, 0, 2)</TD><TD>Table for phic(N_T,beta)</TD></TR>
<TR><TD>Real</TD><TD>tableEta[:, :]</TD><TD>fill(0, 0, 2)</TD><TD>Table for eta(N_T,beta)</TD></TR>
<TR><TD>Real</TD><TD>tablePR[:, :]</TD><TD>fill(0, 0, 2)</TD><TD>Table for eta(N_T,beta)</TD></TR>
<TR><TD>String</TD><TD>fileName</TD><TD>&quot;noName&quot;</TD><TD>File where matrix is stored</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes.Temp"
>Temp</A></TD><TD>Table</TD><TD>&nbsp;</TD><TD>Selection of the way of definition of table matrix</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart_in</TD><TD>&nbsp;</TD><TD>inlet start pressure [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart_out</TD><TD>&nbsp;</TD><TD>outlet start pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart_in</TD><TD>Tdes_in</TD><TD>inlet start temperature [K]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart_out</TD><TD>&nbsp;</TD><TD>outlet start temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Medium.nX]</TD><TD>Medium.reference_X</TD><TD>start gas composition [1]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Flange_a</A></TD><TD>shaft_a</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Flange_b</A></TD><TD>shaft_b</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Compressor <font color="darkgreen">&quot;Gas compressor&quot;</font>
 <font color="blue">extends </font><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.CompressorBase"
>CompressorBase</A>;
 <font color="blue">import </font><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes"
>ThermoPower.Choices.TurboMachinery.TableTypes</A>;
 <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>AngularVelocity</A> Ndesign <font color="darkgreen">&quot;Design velocity&quot;</font>;
 <font color="blue">parameter </font>Real tablePhic[:,:]=<font color="red"> fill</font>(0,0,2) <font color="darkgreen">&quot;Table for phic(N_T,beta)&quot;</font>;
 <font color="blue">parameter </font>Real tableEta[:,:]=<font color="red">fill</font>(0,0,2) <font color="darkgreen">&quot;Table for eta(N_T,beta)&quot;</font>;
 <font color="blue">parameter </font>Real tablePR[:,:]=<font color="red">fill</font>(0,0,2) <font color="darkgreen">&quot;Table for eta(N_T,beta)&quot;</font>;
 <font color="blue">parameter </font>String fileName=&quot;noName&quot; <font color="darkgreen">&quot;File where matrix is stored&quot;</font>;
 <font color="blue">parameter </font><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes.Temp"
>TableTypes.Temp</A> Table <font color="darkgreen">
    &quot;Selection of the way of definition of table matrix&quot;</font>;
 <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Tables.html#Modelica.Blocks.Tables.CombiTable2D"
>Modelica.Blocks.Tables.CombiTable2D</A> Eta(tableOnFile= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>false<font color="blue"> else </font>true,
                table=tableEta,tableName=<font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>&quot;tabEta&quot;,
                fileName=<font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>fileName,
    smoothness=Modelica.Blocks.Types.Smoothness.ContinuousDerivative);
 <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Tables.html#Modelica.Blocks.Tables.CombiTable2D"
>Modelica.Blocks.Tables.CombiTable2D</A> PressRatio(tableOnFile= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>false<font color="blue"> else </font>true,
                table=tablePR, tableName=<font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>&quot;tabPR&quot;,
                fileName=<font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>fileName,
    smoothness=Modelica.Blocks.Types.Smoothness.ContinuousDerivative);
 <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Tables.html#Modelica.Blocks.Tables.CombiTable2D"
>Modelica.Blocks.Tables.CombiTable2D</A> Phic(tableOnFile= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>false<font color="blue"> else </font>true,
                table=tablePhic, tableName=<font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>&quot;tabPhic&quot;,
                fileName=<font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>fileName,
    smoothness=Modelica.Blocks.Types.Smoothness.ContinuousDerivative);
 Real N_T <font color="darkgreen">&quot;Referred speed &quot;</font>;
 Real N_T_design <font color="darkgreen">&quot;Referred design velocity&quot;</font>;
 Real phic(<font color="blue">final </font>unit = &quot;(kg/s)*(T^0.5)/Pa&quot;) <font color="darkgreen">&quot;Flow number &quot;</font>;
 Real beta(start=<font color="red">integer</font>(<font color="red">size</font>(tablePhic,1)/2)) <font color="darkgreen">&quot;Number of beta line&quot;</font>;

<font color="blue">equation </font>
  N_T_design=Ndesign/<font color="red">sqrt</font>(Tdes_in) <font color="darkgreen">&quot;Referred design velocity&quot;</font>;
  N_T = 100*omega/(<font color="red">sqrt</font>(gas_in.T)*N_T_design) <font color="darkgreen">
    &quot;Referred speed definition, as percentage of design velocity&quot;</font>;
  phic = w*<font color="red">sqrt</font>(gas_in.T)/(gas_in.p) <font color="darkgreen">&quot;Flow number definition&quot;</font>;

  <font color="darkgreen">// phic = Phic(beta, N_T)</font>
  Phic.u1=beta;
  Phic.u2=N_T;
  phic=Phic.y;

  <font color="darkgreen">// eta = Eta(beta, N_T)</font>
  Eta.u1=beta;
  Eta.u2=N_T;
  eta=Eta.y;

  <font color="darkgreen">// PR = PressRatio(beta, N_T)</font>
  PressRatio.u1=beta;
  PressRatio.u2=N_T;
  PR=PressRatio.y;
<font color="blue">end </font>Compressor;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE TurbineBase<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.TurbineBaseI.png" ALT="ThermoPower.Gas.TurbineBase" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.TurbineBase"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.TurbineBase</H2>
<B>Gas Turbine</B><p>
<IMG SRC="ThermoPower.Gas.TurbineBaseD.png" ALT="ThermoPower.Gas.TurbineBase">
<H3>Information</H3>
<PRE></pre>
<p>This is the base model for a turbine, including the interface and all equations except the actual computation of the performance characteristics. Reverse flow conditions are not supported.</p>
<p>This model does not include any shaft inertia by itself; if that is needed, connect a Modelica.Mechanics.Rotational.Inertia model to one of the shaft connectors.</p>
<p>As a base-model, it can be used both for axial and radial turbines.
<p><b>Modelling options</b></p>
<p>The actual gas used in the component is determined by the replaceable <tt>Medium</tt> package. In the case of multiple component, variable composition gases, the start composition is given by <tt>Xstart</tt>, whose default value is <tt>Medium.reference_X</tt>.
<p>The following options are available to calculate the enthalpy of the outgoing gas:
<ul><li><tt>explicitIsentropicEnthalpy = true</tt>: the isentropic enthalpy <tt>hout_iso</tt> is calculated by the <tt>Medium.isentropicEnthalpy</tt> function. <li><tt>explicitIsentropicEnthalpy = false</tt>: the isentropic enthalpy is determined by equating the specific entropy of the inlet gas <tt>gas_in</tt> and of a fictious gas state <tt>gas_iso</tt>, with the same pressure of the outgoing gas; both are computed with the function <tt>Medium.specificEntropy</tt>.</pp></ul>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>explicitIsentropicEnthalpy</TD><TD>true</TD><TD>isentropicEnthalpy function used</TD></TR>
<TR><TD>Real</TD><TD>eta_mech</TD><TD>0.98</TD><TD>mechanical efficiency</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tdes_in</TD><TD>&nbsp;</TD><TD>inlet design temperature [K]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart_in</TD><TD>&nbsp;</TD><TD>inlet start pressure [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart_out</TD><TD>&nbsp;</TD><TD>outlet start pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart_in</TD><TD>Tdes_in</TD><TD>inlet start temperature [K]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart_out</TD><TD>&nbsp;</TD><TD>outlet start temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Medium.nX]</TD><TD>Medium.reference_X</TD><TD>start gas composition [1]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Flange_a</A></TD><TD>shaft_a</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Flange_b</A></TD><TD>shaft_b</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> TurbineBase <font color="darkgreen">&quot;Gas Turbine&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.Turbine"
>ThermoPower.Icons.Gas.Turbine</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <font color="blue">parameter </font>Boolean explicitIsentropicEnthalpy=true <font color="darkgreen">
    &quot;isentropicEnthalpy function used&quot;</font>;
  <font color="blue">parameter </font>Real eta_mech=0.98 <font color="darkgreen">&quot;mechanical efficiency&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>ThermoPower.AbsoluteTemperature</A> Tdes_in <font color="darkgreen">&quot;inlet design temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> pstart_in <font color="darkgreen">&quot;inlet start pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> pstart_out <font color="darkgreen">&quot;outlet start pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>ThermoPower.AbsoluteTemperature</A> Tstart_in = Tdes_in <font color="darkgreen">
    &quot;inlet start temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>ThermoPower.AbsoluteTemperature</A> Tstart_out <font color="darkgreen">
    &quot;outlet start temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>Modelica.SIunits.MassFraction</A> Xstart[Medium.nX]=Medium.reference_X <font color="darkgreen">
    &quot;start gas composition&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas_in(
    p(start=pstart_in),
    T(start=Tstart_in),
    Xi(start=Xstart[1:Medium.nXi]));
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Medium.BaseProperties</A> gas_iso(
    p(start=pstart_out),
    T(start=Tstart_out),
    Xi(start=Xstart[1:Medium.nXi]));

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> phi <font color="darkgreen">&quot;shaft rotation angle&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Torque"
>Modelica.SIunits.Torque</A> tau <font color="darkgreen">&quot;net torque acting on the turbine&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>Modelica.SIunits.AngularVelocity</A> omega <font color="darkgreen">&quot;shaft angular velocity&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</A> w <font color="darkgreen">&quot;Gas flow rate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEntropy"
>Medium.SpecificEntropy</A> s_in <font color="darkgreen">&quot;Inlet specific entropy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hout_iso <font color="darkgreen">&quot;Outlet isentropic enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hout <font color="darkgreen">&quot;Outlet enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> pout(start=pstart_out) <font color="darkgreen">&quot;Outlet pressure&quot;</font>;
  Real PR <font color="darkgreen">&quot;pressure ratio&quot;</font>;
  Real eta <font color="darkgreen">&quot;isoentropic efficiency&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> shaft_a;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Modelica.Mechanics.Rotational.Interfaces.Flange_b</A> shaft_b;
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>ThermoPower.Gas.FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>ThermoPower.Gas.FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
<font color="blue">equation </font>
  w = inlet.w;
  <font color="red">assert</font>(w &gt;= 0, &quot;The turbine model does not support flow reversal&quot;);
  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;

  <font color="darkgreen">// Set inlet gas properties</font>
  gas_in.p = inlet.p;
  gas_in.h = inlet.hBA;
  gas_in.Xi = inlet.XBA;

  <font color="darkgreen">// Set outlet gas properties</font>
  outlet.p = pout;
  outlet.hBA = hout;
  outlet.XBA = gas_in.Xi;

  <font color="darkgreen">// Equations for reverse flow (not used)</font>
  inlet.hAB = outlet.hAB;
  inlet.XAB = outlet.XAB;

  <font color="darkgreen">// Component mass balances</font>
  gas_iso.Xi = gas_in.Xi;

  <font color="blue">if </font>explicitIsentropicEnthalpy<font color="blue"> then</font>
     hout_iso=<font color="red">Medium.isentropicEnthalpy</font>(outlet.p,gas_in.state) <font color="darkgreen">
      &quot;Approximated isentropic enthalpy&quot;</font>;
     hout - gas_in.h = eta*(hout_iso-gas_in.h) <font color="darkgreen">&quot;Enthalpy change&quot;</font>;
    <font color="darkgreen"> //dummy assignments</font>
     s_in=0;
     gas_iso.p=1e5;
     gas_iso.T=300;
  <font color="blue">else</font>
    <font color="darkgreen"> // Properties of the gas after isentropic transformation</font>
     gas_iso.p = pout;
     s_in=<font color="red">Medium.specificEntropy</font>(gas_in.state);
     s_in=<font color="red">Medium.specificEntropy</font>(gas_iso.state);
     hout - gas_in.h = eta*(gas_iso.h - gas_in.h) <font color="darkgreen">&quot;Enthalpy change&quot;</font>;
    <font color="darkgreen"> //dummy assignment</font>
     hout_iso=0;
  <font color="blue">end if</font>;

  w*(hout - gas_in.h)*eta_mech = tau*omega <font color="darkgreen">&quot;Energy balance&quot;</font>;
  PR=gas_in.p/pout <font color="darkgreen">&quot;Pressure ratio&quot;</font>;

  <font color="darkgreen">// Mechanical boundary conditions  </font>
  shaft_a.phi = phi;
  shaft_b.phi = phi;
  shaft_a.tau + shaft_b.tau = tau;
  <font color="red">der</font>(phi) = omega;
<font color="blue">end </font>TurbineBase;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Turbine<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.TurbineBaseI.png" ALT="ThermoPower.Gas.Turbine" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.Turbine"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.Turbine</H2>
<B>Gas Turbine</B><p>
<IMG SRC="ThermoPower.Gas.TurbineD.png" ALT="ThermoPower.Gas.Turbine">
<H3>Information</H3>
<PRE></pre>
This model adds the performance characteristics to the Turbine_Base model, by means of 2D interpolation tables.
<p>The performance characteristics are described by two characteristic equations: the first relates the flow number <tt>phic</tt>, the pressure ratio <tt>PR</tt> and the referred speed <tt>N_T</tt>; the second relates the efficiency <tt>eta</tt>, the flow number <tt>phic</tt>, and the referred speed <tt>N_T</tt> [1]. </p>
<p>The performance maps are tabulated into two differents tables, <tt>tablePhic</tt> and <tt>tableEta</tt> which express <tt>phic</tt> and <tt>eta</tt> as a function of <tt>N_T</tt> and <tt>PR</tt> respectively, where <tt>N_T</tt> represents the first row and <tt>PR</tt> the first column [2]. The referred speed <tt>N_T</tt> is defined as a percentage of the design referred speed.
<p>The <tt>Modelica.Blocks.Tables.CombiTable2D</tt> interpolates the tables to obtain values of referred flow and efficiency at given levels of referred speed.
<p><b>Modelling options</b></p>
<p>The following options are available to determine how the table is defined:
<ul><li><tt>Table = 0</tt>: the table is explicitly supplied as matrix parameter.
<li><tt>Table = 1</tt>: the table is read from a file; the string <tt>fileName</tt> contains the path to the files where tables are stored, either in ASCII or Matlab binary format.
</ul>
<p><b>References:</b></p>
<ol>
<li>S. L. Dixon: <i>Fluid mechanics, thermodynamics of turbomachinery</i>, Oxford, Pergamon press, 1966, pp. 213.
<li>P. P. Walsh, P. Fletcher: <i>Gas Turbine Performance</i>, 2nd ed., Oxford, Blackwell, 2004, pp. 646.
</ol>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>&nbsp;</TD></TR>
<TR><TD>Boolean</TD><TD>explicitIsentropicEnthalpy</TD><TD>true</TD><TD>isentropicEnthalpy function used</TD></TR>
<TR><TD>Real</TD><TD>eta_mech</TD><TD>0.98</TD><TD>mechanical efficiency</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tdes_in</TD><TD>&nbsp;</TD><TD>inlet design temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>AngularVelocity</A></TD><TD>Ndesign</TD><TD>&nbsp;</TD><TD>Design speed [rad/s]</TD></TR>
<TR><TD>Real</TD><TD>tablePhic[:, :]</TD><TD>fill(0, 0, 2)</TD><TD>Table for phic(N_T,PR)</TD></TR>
<TR><TD>Real</TD><TD>tableEta[:, :]</TD><TD>fill(0, 0, 2)</TD><TD>Table for eta(N_T,PR)</TD></TR>
<TR><TD>String</TD><TD>fileName</TD><TD>&quot;NoName&quot;</TD><TD>File where matrix is stored</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes.Temp"
>Temp</A></TD><TD>Table</TD><TD>&nbsp;</TD><TD>Selection of the way of definition of table matrix</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart_in</TD><TD>&nbsp;</TD><TD>inlet start pressure [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart_out</TD><TD>&nbsp;</TD><TD>outlet start pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart_in</TD><TD>Tdes_in</TD><TD>inlet start temperature [K]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart_out</TD><TD>&nbsp;</TD><TD>outlet start temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Medium.nX]</TD><TD>Medium.reference_X</TD><TD>start gas composition [1]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Flange_a</A></TD><TD>shaft_a</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Flange_b</A></TD><TD>shaft_b</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Turbine <font color="darkgreen">&quot;Gas Turbine&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.TurbineBase"
>TurbineBase</A>;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes"
>ThermoPower.Choices.TurboMachinery.TableTypes</A>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>AngularVelocity</A> Ndesign <font color="darkgreen">&quot;Design speed&quot;</font>;
  <font color="blue">parameter </font>Real tablePhic[:,:]=<font color="red">fill</font>(0,0,2) <font color="darkgreen">&quot;Table for phic(N_T,PR)&quot;</font>;
  <font color="blue">parameter </font>Real tableEta[:,:]=<font color="red">fill</font>(0,0,2) <font color="darkgreen">&quot;Table for eta(N_T,PR)&quot;</font>;
  <font color="blue">parameter </font>String fileName=&quot;NoName&quot; <font color="darkgreen">&quot;File where matrix is stored&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes.Temp"
>TableTypes.Temp</A> Table <font color="darkgreen">
    &quot;Selection of the way of definition of table matrix&quot;</font>;

  Real N_T <font color="darkgreen">&quot;Referred speed&quot;</font>;
  Real N_T_design <font color="darkgreen">&quot;Referred design speed&quot;</font>;
  Real phic <font color="darkgreen">&quot;Flow number&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Tables.html#Modelica.Blocks.Tables.CombiTable2D"
>Modelica.Blocks.Tables.CombiTable2D</A> Phic(tableOnFile= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>false<font color="blue"> else </font>true,
              table=tablePhic, tableName= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>&quot;tabPhic&quot;,
              fileName= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font> fileName,
    smoothness=Modelica.Blocks.Types.Smoothness.ContinuousDerivative);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Tables.html#Modelica.Blocks.Tables.CombiTable2D"
>Modelica.Blocks.Tables.CombiTable2D</A> Eta(tableOnFile= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>false<font color="blue"> else </font>true,
              table=tableEta, tableName= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>&quot;tabEta&quot;,
              fileName= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font> fileName,
    smoothness=Modelica.Blocks.Types.Smoothness.ContinuousDerivative);
<font color="blue">equation </font>
  N_T_design=Ndesign/<font color="red">sqrt</font>(Tdes_in) <font color="darkgreen">&quot;Referred design velocity&quot;</font>;
  N_T = 100*omega/(<font color="red">sqrt</font>(gas_in.T)*N_T_design) <font color="darkgreen">
    &quot;Referred speed definition as percentage of design velocity&quot;</font>;
  phic = w*<font color="red">sqrt</font>(gas_in.T)/(gas_in.p) <font color="darkgreen">&quot;Flow number definition&quot;</font>;

  <font color="darkgreen">// phic = Phic(PR, N_T)</font>
  Phic.u1=PR;
  Phic.u2=N_T;
  phic=(Phic.y);

  <font color="darkgreen">// eta = Eta(PR, N_T)</font>
  Eta.u1=PR;
  Eta.u2=N_T;
  eta=Eta.y;
<font color="blue">end </font>Turbine;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE TurbineStodola<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.TurbineBaseI.png" ALT="ThermoPower.Gas.TurbineStodola" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.TurbineStodola"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.TurbineStodola</H2>
<B>Gas Turbine</B><p>
<IMG SRC="ThermoPower.Gas.TurbineStodolaD.png" ALT="ThermoPower.Gas.TurbineStodola">
<H3>Information</H3>
<PRE></pre>
This model extends the Turbine_Base model with the calculation of the performance parameters, mass flowrate, pressure ratio and efficiency.
<p>This method is based on the Stodola's law, which calculates <tt>PR</tt> as function of the inlet conditions, i.e. mass flowrate, inlet temperature and pressure.</p>
<p><b>Modelling options</b></p>
<p>The following options are available to define Stodola's constant <tt>K</tt>:
<ul><li><tt>NominalCondition = true</tt>: Stodola's constant K is specified by the nominal operating point (<tt>wnom,Tstart_in,pstart_in,pstart_out</tt>)
<li><tt>NominalCondition = false</tt>: Stodola's constant K is used directly.</ul>
<p>The following options are available to define the efficiency <tt>eta</tt>:
<ul><li><tt>fixedEta = true</tt>: the efficiency is explicitly supplied as a parameter.
<li><tt>fixedEta = false</tt>: the efficiency is a function of the pressure ratio <tt>PR</tt> and of the referred speed <tt>N_T</tt>. The function is defined by interpolation of the table <tt>tableEta</tt>, where <tt>N_T</tt> represents the first row and <tt>PR</tt> the first column of the table. The interpolation is performed by a <tt>Modelica.Blocks.Tables.CombiTable2D</tt> model.
</ul>
<p><p><p>The following options are available to select the way of definition of the table:
<ul><li><tt>Table = 0</tt>: the table is explicitly supplied as a matrix parameter.
<li><tt>Table = 1</tt>: the table is read from a file; the string <tt>fileName</tt> contains the path to the files where the table is stored, either in ASCII or Matlab binary format.
</ul>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>&nbsp;</TD></TR>
<TR><TD>Boolean</TD><TD>explicitIsentropicEnthalpy</TD><TD>true</TD><TD>isentropicEnthalpy function used</TD></TR>
<TR><TD>Real</TD><TD>eta_mech</TD><TD>0.98</TD><TD>mechanical efficiency</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tdes_in</TD><TD>&nbsp;</TD><TD>inlet design temperature [K]</TD></TR>
<TR><TD>Boolean</TD><TD>NominalCondition</TD><TD>true</TD><TD>true: K is evalueted from design operation; false: K is set as a parameter</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>AngularVelocity</A></TD><TD>Ndesign</TD><TD>&nbsp;</TD><TD>Design velocity [rad/s]</TD></TR>
<TR><TD>Real</TD><TD>tableEta[:, :]</TD><TD>fill(0, 2, 2)</TD><TD>Table for eta(N_T,PR)</TD></TR>
<TR><TD>String</TD><TD>fileName</TD><TD>&quot;NoName&quot;</TD><TD>File where matrix is stored</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes.Temp"
>Temp</A></TD><TD>Table</TD><TD>&nbsp;</TD><TD>Selection of the way of definition of table matrix</TD></TR>
<TR><TD>Boolean</TD><TD>fixedEta</TD><TD>true</TD><TD>true:eta is a parameter,
      false:eta is calculated from table</TD></TR>
<TR><TD>Real</TD><TD>eta_nom</TD><TD>0.8</TD><TD>Nominal efficiency value</TD></TR>
<TR><TD>Real</TD><TD>K</TD><TD>4.75e-3</TD><TD>Stodola's constant</TD></TR>
<TR><TD>Real</TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal massflowrate</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart_in</TD><TD>&nbsp;</TD><TD>inlet start pressure [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart_out</TD><TD>&nbsp;</TD><TD>outlet start pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart_in</TD><TD>Tdes_in</TD><TD>inlet start temperature [K]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart_out</TD><TD>&nbsp;</TD><TD>outlet start temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Medium.nX]</TD><TD>Medium.reference_X</TD><TD>start gas composition [1]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Flange_a</A></TD><TD>shaft_a</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Flange_b</A></TD><TD>shaft_b</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> TurbineStodola <font color="darkgreen">&quot;Gas Turbine&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.TurbineBase"
>TurbineBase</A>;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes"
>ThermoPower.Choices.TurboMachinery.TableTypes</A>;
  <font color="blue">parameter </font>Boolean NominalCondition=true <font color="darkgreen">
    &quot;true: K is evalueted from design operation; false: K is set as a parameter&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>AngularVelocity</A> Ndesign <font color="darkgreen">&quot;Design velocity&quot;</font>;
  <font color="blue">parameter </font>Real tableEta[:,:]=<font color="red">fill</font>(0,2,2) <font color="darkgreen">&quot;Table for eta(N_T,PR)&quot;</font>;
  <font color="blue">parameter </font>String fileName=&quot;NoName&quot; <font color="darkgreen">&quot;File where matrix is stored&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes.Temp"
>TableTypes.Temp</A> Table <font color="darkgreen">
    &quot;Selection of the way of definition of table matrix&quot;</font>;
  <font color="blue">parameter </font>Boolean fixedEta=true <font color="darkgreen">&quot;true:eta is a parameter,
      false:eta is calculated from table&quot;</font>;
  <font color="blue">parameter </font>Real eta_nom=0.8 <font color="darkgreen">&quot;Nominal efficiency value&quot;</font>;
  <font color="blue">parameter </font>Real K( fixed = <font color="blue">if </font>(NominalCondition ==false)<font color="blue"> then </font>true<font color="blue"> else </font>false)=4.75e-3 <font color="darkgreen">
    &quot;Stodola's constant&quot;</font>;
  <font color="blue">parameter </font>Real wnom <font color="darkgreen">&quot;Nominal massflowrate&quot;</font>;

  Real N_T <font color="darkgreen">&quot;Referred speed&quot;</font>;
  Real N_T_design <font color="darkgreen">&quot;Referred design speed&quot;</font>;
  Real phic <font color="darkgreen">&quot;Flow number&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Tables.html#Modelica.Blocks.Tables.CombiTable2D"
>Modelica.Blocks.Tables.CombiTable2D</A> Eta(tableOnFile= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>false<font color="blue"> else </font>true,
              table=tableEta, tableName= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>&quot;tabEta&quot;,
              fileName= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font> fileName,
    smoothness=Modelica.Blocks.Types.Smoothness.ContinuousDerivative);

<font color="blue">initial </font><font color="blue">equation </font>
  <font color="darkgreen">// set K if NominalCondition is true</font>
  <font color="blue">if </font>NominalCondition<font color="blue"> then</font>
    wnom*<font color="red">sqrt</font>(Tstart_in)/pstart_in=K*<font color="red">sqrt</font>(1-(pstart_out/pstart_in)^2) <font color="darkgreen">
      &quot;Stodola's constant evaluated from design operation&quot;</font>;
  <font color="blue">end if</font>;

<font color="blue">equation </font>
  N_T_design=Ndesign/<font color="red">sqrt</font>(Tdes_in) <font color="darkgreen">&quot;Referred design velocity&quot;</font>;
  N_T = 100*omega/(<font color="red">sqrt</font>(gas_in.T)*N_T_design) <font color="darkgreen">
    &quot;Referred speed definition as percentage of design velocity&quot;</font>;
  phic = w*<font color="red">sqrt</font>(gas_in.T)/(gas_in.p) <font color="darkgreen">&quot;Flow number definition&quot;</font>;

  <font color="darkgreen">// phic = function(PR, K)</font>
  phic=K*<font color="red">sqrt</font>(1-(1/PR)^2);

  <font color="darkgreen">// eta = Eta(PR, N_T)</font>
  Eta.u1=PR;
  Eta.u2=N_T;

  <font color="blue">if </font>fixedEta<font color="blue"> then</font>
     eta=eta_nom;
  <font color="blue">else</font>
     eta=Eta.y;
  <font color="blue">end if</font>;
<font color="blue">end </font>TurbineStodola;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE GTunitBase<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.GTunitBaseI.png" ALT="ThermoPower.Gas.GTunitBase" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.GTunitBase"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.GTunitBase</H2>
<B>Gas Turbine</B><p>
<IMG SRC="ThermoPower.Gas.GTunitBaseD.png" ALT="ThermoPower.Gas.GTunitBase">
<H3>Information</H3>
<PRE></pre>
This model describes a gas turbine unit as a single model, including the interface and all equations, except the computation of the performance characteristics and of the exhaust composition.
<p>Actual operating conditions are related to ISO standard conditions <tt>pnom</tt> and <tt>Tnom</tt> by the following relationship:
<ul><li> HI_ISO = HI*sqrt(Tnom/gas.T)*(pnom/gas.p)</li>
<li> ZLPout_ISO = ZLPout*sqrt(Tnom/gas.T)*(pnom/gas.p)</li>
<li> wia_ISO = wia*pnom/gas.p*sqrt(gas.T/Tnom)</li></ul>
<p> where <tt>HI</tt> is the heat input, <tt>ZLPout</tt> the zero loss power output and <tt>wia</tt> the air inlet flow.
<p><b>Modelling options</b></p>
<p>This model has three different Medium models to characterize the inlet air, fuel, and flue gas exhaust.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>HH</TD><TD>&nbsp;</TD><TD>Lower Heating value [J/kg]</TD></TR>
<TR><TD>Real</TD><TD>eta_mech</TD><TD>0.95</TD><TD>mechanical efficiency</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>&nbsp;</TD><TD>start pressure value [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart</TD><TD>&nbsp;</TD><TD>start temperature value [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Air.nX]</TD><TD>Air.reference_X</TD><TD>start gas composition [1]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>Air_in</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>Fuel_in</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>FlueGas_out</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Flange_b</A></TD><TD>shaft_b</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> GTunitBase <font color="darkgreen">&quot;Gas Turbine&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.GasTurbineUnit"
>ThermoPower.Icons.Gas.GasTurbineUnit</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Air=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Fuel=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Exhaust=<A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>Modelica.Media.Interfaces.PartialMedium</A>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> pstart <font color="darkgreen">&quot;start pressure value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>ThermoPower.AbsoluteTemperature</A> Tstart <font color="darkgreen">&quot;start temperature value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>Modelica.SIunits.MassFraction</A> Xstart[Air.nX]=Air.reference_X <font color="darkgreen">
    &quot;start gas composition&quot;</font>;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> pnom=1.013e5 <font color="darkgreen">&quot;ISO reference pressure&quot;</font>;
  <font color="blue">constant </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tnom=288.15 <font color="darkgreen">&quot;ISO reference temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> HH <font color="darkgreen">&quot;Lower Heating value&quot;</font>;
  <font color="blue">parameter </font>Real eta_mech=0.95 <font color="darkgreen">&quot;mechanical efficiency&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.BaseProperties"
>Air.BaseProperties</A> gas(p(start=pstart),T(start=Tstart),Xi(start=Xstart[1:Air.nXi]));

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</A> wia <font color="darkgreen">&quot;Air mass flow&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</A> wia_ISO <font color="darkgreen">
    &quot;Air mass flow, referred to ISO conditions&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</A> wif <font color="darkgreen">&quot;Fuel mass flow&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>Modelica.SIunits.MassFlowRate</A> wout <font color="darkgreen">&quot;FlueGas mass flow&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Air.SpecificEnthalpy</A> hia <font color="darkgreen">&quot;Air specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Fuel.SpecificEnthalpy</A> hif <font color="darkgreen">&quot;Fuel specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Exhaust.SpecificEnthalpy</A> hout <font color="darkgreen">&quot;FlueGas specific enthalpy&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Modelica.SIunits.Angle</A> phi <font color="darkgreen">&quot;shaft rotation angle&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Torque"
>Modelica.SIunits.Torque</A> tau <font color="darkgreen">&quot;net torque acting on the turbine&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>Modelica.SIunits.AngularVelocity</A> omega <font color="darkgreen">&quot;shaft angular velocity&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</A> ZLPout <font color="darkgreen">&quot;zero_loss power output&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</A> ZLPout_ISO <font color="darkgreen">
    &quot;zero_loss power output, referred to ISO conditions &quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</A> Pout <font color="darkgreen">&quot;Net power output&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</A> HI <font color="darkgreen">&quot;Heat input&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Modelica.SIunits.Power</A> HI_ISO <font color="darkgreen">&quot;Heat input, referred to ISO conditions&quot;</font>;
  Real PR <font color="darkgreen">&quot;pressure ratio&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> pc <font color="darkgreen">&quot;combustion pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Modelica.SIunits.Pressure</A> pin <font color="darkgreen">&quot;inlet pressure&quot;</font>;

  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> Air_in( <font color="blue">redeclare </font><font color="blue">package</font> Medium=<A HREF="ThermoPower_Gas_Air.html#ThermoPower.Gas.GTunitBase.Air"
>Air</A>);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A> Fuel_in( <font color="blue">redeclare </font><font color="blue">package</font> Medium=<A HREF="ThermoPower_Gas_Fuel.html#ThermoPower.Gas.GTunitBase.Fuel"
>Fuel</A>);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A> FlueGas_out( <font color="blue">redeclare </font><font color="blue">package</font> Medium=<A HREF="ThermoPower_Gas_Exhaust.html#ThermoPower.Gas.GTunitBase.Exhaust"
>Exhaust</A>);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Modelica.Mechanics.Rotational.Interfaces.Flange_b</A> shaft_b;
<font color="blue">equation </font>

  PR=pc/pin <font color="darkgreen">&quot;pressure ratio&quot;</font>;
  HI=wif*HH <font color="darkgreen">&quot;Heat input&quot;</font>;
  HI_ISO=HI*<font color="red">sqrt</font>(Tnom/gas.T)*(pnom/gas.p) <font color="darkgreen">
    &quot;heat input, referred to ISO conditions&quot;</font>;

  0 = Air_in.w+Fuel_in.w+FlueGas_out.w <font color="darkgreen">&quot;Mass balance&quot;</font>;
  0 = wia*gas.h+wif*(hif+HH)+wout*hout-ZLPout <font color="darkgreen">&quot;Energy balance&quot;</font>;
  ZLPout_ISO = ZLPout*<font color="red">sqrt</font>(Tnom/gas.T)*(pnom/gas.p) <font color="darkgreen">
    &quot;Net power output, referred to ISO conditions&quot;</font>;
  Pout = ZLPout*eta_mech <font color="darkgreen">&quot;Net power output&quot;</font>;
  Pout = tau*omega <font color="darkgreen">&quot;Mechanical boundary condition&quot;</font>;
  wia_ISO = wia*<font color="red">sqrt</font>(gas.T/Tnom)/(gas.p/pnom) <font color="darkgreen">
    &quot;Air mass flow, referred to ISO conditions&quot;</font>;

  <font color="darkgreen">// Set inlet gas properties</font>
  gas.p = Air_in.p;
  gas.h = Air_in.hBA;
  gas.Xi =Air_in.XBA;

  <font color="darkgreen">// Boundary conditions</font>
  <font color="red">assert</font>(Air_in.w &gt;= 0,&quot;The model does not support flow reversal&quot;);
  wia = Air_in.w;
  hia = Air_in.hBA;
  Air_in.p= pin;
  Air_in.hAB=0;
  Air_in.XAB=Air.reference_X;
  <font color="red">assert</font>(Fuel_in.w &gt;=0, &quot;The model does not support flow reversal&quot;);
  wif = Fuel_in.w;
  hif = Fuel_in.hBA;
  Fuel_in.p   = pc;
  Fuel_in.hAB = 0;
  Fuel_in.XAB = Fuel.reference_X;
  <font color="red">assert</font>(FlueGas_out.w &lt;=0, &quot;The model does not support flow reversal&quot;);
  wout = FlueGas_out.w;
  hout = FlueGas_out.hBA;
  <font color="darkgreen">// Flue gas composition FlueGas_out.XBA to be determined by extended model</font>

  <font color="darkgreen">// Mechanical boundaries</font>
  shaft_b.phi = phi;
  shaft_b.tau = -tau;
  <font color="red">der</font>(phi) = omega;

<font color="blue">end </font>GTunitBase;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE GTunitExhaustBase<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.GTunitBaseI.png" ALT="ThermoPower.Gas.GTunitExhaustBase" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.GTunitExhaustBase"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.GTunitExhaustBase</H2>
<B>Adds computation of exhaust composition to GTunitBase</B><p>
<IMG SRC="ThermoPower.Gas.GTunitBaseD.png" ALT="ThermoPower.Gas.GTunitExhaustBase">
<H3>Information</H3>
<PRE></pre>
This model extends <tt>GTunitBase</tt>, by adding the computation of the exhaust composition.

<p><b>Modelling options</b></p>
If <tt>constantCompositionExhaust = false</tt>, the exhaust composition is computed according to the exact mass balances; otherwise, the exhaust composition is held fixed to <tt>Exhaust.reference_X</tt>.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Air</TD><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>&nbsp;</TD></TR>
<TR><TD colspan="2">replaceable package Fuel</TD><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>&nbsp;</TD></TR>
<TR><TD colspan="2">replaceable package Exhaust</TD><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>HH</TD><TD>&nbsp;</TD><TD>Lower Heating value [J/kg]</TD></TR>
<TR><TD>Real</TD><TD>eta_mech</TD><TD>0.95</TD><TD>mechanical efficiency</TD></TR>
<TR><TD>Boolean</TD><TD>constantCompositionExhaust</TD><TD>false</TD><TD>Assume exhaust composition equal to reference_X</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>&nbsp;</TD><TD>start pressure value [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart</TD><TD>&nbsp;</TD><TD>start temperature value [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Air.nX]</TD><TD>Air.reference_X</TD><TD>start gas composition [1]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Air</TD><TD>&nbsp;</TD></TR>
<TR><TD colspan="2">replaceable package Fuel</TD><TD>&nbsp;</TD></TR>
<TR><TD colspan="2">replaceable package Exhaust</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>Air_in</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>Fuel_in</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>FlueGas_out</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Flange_b</A></TD><TD>shaft_b</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> GTunitExhaustBase <font color="darkgreen">
  &quot;Adds computation of exhaust composition to GTunitBase&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.GTunitBase"
>GTunitBase</A>(
  <font color="blue">redeclare </font><font color="blue">package</font> Air=<A HREF="ThermoPower_Media_Air.html#ThermoPower.Media.Air"
>ThermoPower.Media.Air</A> <font color="darkgreen">&quot;O2, H2O, Ar, N2&quot;</font>,
  <font color="blue">redeclare </font><font color="blue">package</font> Fuel=<A HREF="ThermoPower_Media_NaturalGas.html#ThermoPower.Media.NaturalGas"
>ThermoPower.Media.NaturalGas</A> <font color="darkgreen">&quot;N2, CO2, CH4&quot;</font>,
  <font color="blue">redeclare </font><font color="blue">package</font> Exhaust=<A HREF="ThermoPower_Media_FlueGas.html#ThermoPower.Media.FlueGas"
>ThermoPower.Media.FlueGas</A> <font color="darkgreen">&quot;O2, Ar, H2O, CO2, N2&quot;</font>);
  <font color="blue">parameter </font>Boolean constantCompositionExhaust = false <font color="darkgreen">
    &quot;Assume exhaust composition equal to reference_X&quot;</font>;
  Real wcomb(<font color="blue">final </font>quantity=&quot;MolarFlowRate&quot;, unit=&quot;mol/s&quot;) <font color="darkgreen">
    &quot;Molar Combustion rate (CH4)&quot;</font>;
  Real lambda <font color="darkgreen">
    &quot;Stoichiometric ratio (&gt;1 if air flow is greater than stoichiometric)&quot;</font>;
<font color="blue">equation </font>
  wcomb=wif*Fuel_in.XBA[3]/Fuel.data[3].MM <font color="darkgreen">&quot;Combustion molar flow rate&quot;</font>;
  lambda= (wia*Air_in.XBA[1]/Air.data[1].MM) / (2 * wcomb);
  <font color="red">assert</font>(lambda &gt;= 1, &quot;Not enough oxygen flow&quot;);
  <font color="blue">if </font>constantCompositionExhaust<font color="blue"> then</font>
    FlueGas_out.XBA[1:Exhaust.nXi] = Exhaust.reference_X[1:Exhaust.nXi] <font color="darkgreen">
      &quot;Reference value for exhaust compostion&quot;</font>;
  <font color="blue">else</font>
  <font color="darkgreen">// True mass balances</font>
    0 = wia*Air_in.XBA[1] + wout*FlueGas_out.XBA[1] - 2*wcomb*Exhaust.data[1].MM <font color="darkgreen">&quot;oxygen&quot;</font>;
    0 = wia*Air_in.XBA[3] + wout*FlueGas_out.XBA[2] <font color="darkgreen">&quot;argon&quot;</font>;
    0 = wia*Air_in.XBA[2] + wout*FlueGas_out.XBA[3] + 2*wcomb*Exhaust.data[3].MM <font color="darkgreen">&quot;water&quot;</font>;
    0 = wout*FlueGas_out.XBA[4] + wif*Fuel_in.XBA[2] + wcomb*Exhaust.data[4].MM <font color="darkgreen">
      &quot;carbondioxide&quot;</font>;
    0 = wia*Air_in.XBA[4] + wout*FlueGas_out.XBA[5] + wif*Fuel_in.XBA[1] <font color="darkgreen">
      &quot;nitrogen&quot;</font>;
  <font color="blue">end if</font>;
<font color="blue">end </font>GTunitExhaustBase;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE GTunit_ISO<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.GTunitBaseI.png" ALT="ThermoPower.Gas.GTunit_ISO" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.GTunit_ISO"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.GTunit_ISO</H2>
<B>Gas Turbine</B><p>
<IMG SRC="ThermoPower.Gas.GTunit_ISOD.png" ALT="ThermoPower.Gas.GTunit_ISO">
<H3>Information</H3>
<PRE></pre>
This model adds the performance characteristics to the GTunit_base model, when only one performance curve is known at ISO conditions: 15 degC temperature and 1.013 bar pressure at the air inlet, and nominal rotational speed.
<ul><li>HI_ISO = f(ZLPout_ISO)</li>
<li>PR = g(ZLPout_ISO)</li>
<li>wia_ISO = h(ZLPout_ISO)</li></ul>
<p>The performance maps are thus tabulated into the matrix <tt>tableData</tt>, whose columns contain:
<ol>
<li><tt>ZLPout_ISO</tt> (zero loss power output in ISO conditions)</li>
<li><tt>HI_ISO</tt> (heat input in ISO conditions)</li>
<li><tt>PR</tt> (pressure ratio)</li>
<li><tt>wia_ISO</tt> (inlet air flow rate in ISO conditions)</li>
</ol>
<p><b>Modelling options</b></p>
<p>The following options are available to select how the table is defined:
<ul><li><tt>Table = 0</tt>: the table is explicitly supplied as matrix parameter.
<li><tt>Table = 1</tt>: the table is read from a file; the string <tt>fileName</tt> contains the path to the files where tables are stored, either in ASCII or Matlab binary format.
</ul>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>HH</TD><TD>&nbsp;</TD><TD>Lower Heating value [J/kg]</TD></TR>
<TR><TD>Real</TD><TD>eta_mech</TD><TD>0.95</TD><TD>mechanical efficiency</TD></TR>
<TR><TD>Boolean</TD><TD>constantCompositionExhaust</TD><TD>false</TD><TD>Assume exhaust composition equal to reference_X</TD></TR>
<TR><TD>Real</TD><TD>tableData[:, 4]</TD><TD>fill(0, 0, 4)</TD><TD>Table with unit data</TD></TR>
<TR><TD>String</TD><TD>fileName</TD><TD>&quot;noName&quot;</TD><TD>File where matrix is stored</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes.Temp"
>Temp</A></TD><TD>Table</TD><TD>&nbsp;</TD><TD>Selection of the way of definition of table matrix</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>&nbsp;</TD><TD>start pressure value [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart</TD><TD>&nbsp;</TD><TD>start temperature value [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Air.nX]</TD><TD>Air.reference_X</TD><TD>start gas composition [1]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>Air_in</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>Fuel_in</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>FlueGas_out</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Flange_b</A></TD><TD>shaft_b</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> GTunit_ISO <font color="darkgreen">&quot;Gas Turbine&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.GTunitExhaustBase"
>GTunitExhaustBase</A>;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes"
>ThermoPower.Choices.TurboMachinery.TableTypes</A>;
  <font color="blue">parameter </font>Real tableData[:,4]=<font color="red">fill</font>(0,0,4) <font color="darkgreen">&quot;Table with unit data&quot;</font>;
  <font color="blue">parameter </font>String fileName=&quot;noName&quot; <font color="darkgreen">&quot;File where matrix is stored&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes.Temp"
>TableTypes.Temp</A> Table <font color="darkgreen">
    &quot;Selection of the way of definition of table matrix&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Tables.html#Modelica.Blocks.Tables.CombiTable1Ds"
>Modelica.Blocks.Tables.CombiTable1Ds</A> OperatingPoint( tableOnFile= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>false<font color="blue"> else </font>true,
                    table=tableData, tableName=<font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>&quot;tableData&quot;,
                    fileName=<font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>fileName,
    smoothness=Modelica.Blocks.Types.Smoothness.ContinuousDerivative);
<font color="blue">equation </font>
  <font color="darkgreen">// HI_ISO = f(ZLPout_ISO)</font>
  OperatingPoint.u = ZLPout_ISO;
  OperatingPoint.y[1] = HI_ISO;

  <font color="darkgreen">// PR = g(ZLP_ISO)</font>
  OperatingPoint.y[2] = PR;

  <font color="darkgreen">// wia_iso = h(ZLP_ISO)</font>
  OperatingPoint.y[3] = wia_ISO;
<font color="blue">end </font>GTunit_ISO;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE GTunit<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.GTunitBaseI.png" ALT="ThermoPower.Gas.GTunit" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.GTunit"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.GTunit</H2>
<B>Gas Turbine</B><p>
<IMG SRC="ThermoPower.Gas.GTunitD.png" ALT="ThermoPower.Gas.GTunit">
<H3>Information</H3>
<PRE></pre>
This model adds the performance characteristics to the GTunit_base model, by means of 2D interpolation tables.
<p>Unit performance is a function of two referred quantities, i.e. Zero Loss Power Output referred at ISO conditions (ZLPout_ISO) and referred speed. In typical performance charts, curves corresponding to different referred speeds are labelled by synchronous temperatures (Tsync), i.e. inlet temperatures which would give the same referred speed if the unit operated at nominal rotational speed. The performance is thus specified by three functions[1]:
<ul><li>HI_ISO = f(ZLPout_ISO, Tsync)</li>
<li>PR = g(ZLPout_ISO, Tsync)</li>
<li>wia_ISO = h(ZLPout_ISO, Tsync)</li></ul>
<p>which in turn are specified by three tables, in the format of Modelica.Blocks.Tables.CombiTable2D:
<ol><li><tt>tableHI</tt>, where <tt>ZLPout_ISO</tt> is the first column and <tt>Tsync</tt> the first row</li>
<li><tt>tablePR</tt>, where <tt>ZLPout_ISO</tt> is the first column and <tt>Tsync</tt> the first row</li>
<li> <tt>tableW</tt>, where <tt>ZLPout_ISO</tt> is the first column and <tt>Tsync</tt> the first row</li>, respectively.</li></ol>
<p><b>Modelling options</b></p>
The packages Medium are redeclared and a mass balance determines the composition of the outgoing gas.
<p>The following options are available to select the way of definition of the table:
<ul><li><tt>Table = 0</tt>: the table is explicitly supplied as matrix parameter.
<li><tt>Table = 1</tt>: the table is read from a file; the string <tt>fileName</tt> contains the path to the files where tables are stored, either in ASCII or Matlab binary format.
</ul>
<p><b>References:</b></p>
<ol>
<li>P. P. Walsh, P. Fletcher: <i>Gas Turbine Performance</i>, 2nd ed., Oxford, Blackwell, 2004, pp. 646.
</ol>

<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>HH</TD><TD>&nbsp;</TD><TD>Lower Heating value [J/kg]</TD></TR>
<TR><TD>Real</TD><TD>eta_mech</TD><TD>0.95</TD><TD>mechanical efficiency</TD></TR>
<TR><TD>Boolean</TD><TD>constantCompositionExhaust</TD><TD>false</TD><TD>Assume exhaust composition equal to reference_X</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>AngularVelocity</A></TD><TD>omega_sync</TD><TD>314</TD><TD>synchronous value of the shaft speed [rad/s]</TD></TR>
<TR><TD>Real</TD><TD>tableHI[:, :]</TD><TD>fill(0, 0, 2)</TD><TD>Table for HI_ISO=f(ZLPout_ISO, Tsync)</TD></TR>
<TR><TD>Real</TD><TD>tablePR[:, :]</TD><TD>fill(0, 0, 2)</TD><TD>Table for PR=g(ZLPout_ISO,Tsync)</TD></TR>
<TR><TD>Real</TD><TD>tableW[:, :]</TD><TD>fill(0, 0, 2)</TD><TD>Table for wia_ISO=h(ZLPout_ISO,Tsync)</TD></TR>
<TR><TD>String</TD><TD>fileName</TD><TD>&quot;noName&quot;</TD><TD>File where matrix is stored</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes.Temp"
>Temp</A></TD><TD>Table</TD><TD>&nbsp;</TD><TD>Selection of the way of definition of table matrix</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>&nbsp;</TD><TD>start pressure value [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tstart</TD><TD>&nbsp;</TD><TD>start temperature value [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFraction"
>MassFraction</A></TD><TD>Xstart[Air.nX]</TD><TD>Air.reference_X</TD><TD>start gas composition [1]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>Air_in</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>Fuel_in</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>FlueGas_out</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Flange_b</A></TD><TD>shaft_b</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> GTunit <font color="darkgreen">&quot;Gas Turbine&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.GTunitExhaustBase"
>GTunitExhaustBase</A>;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes"
>ThermoPower.Choices.TurboMachinery.TableTypes</A>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>Modelica.SIunits.AngularVelocity</A> omega_sync=314 <font color="darkgreen">
    &quot;synchronous value of the shaft speed&quot;</font>;
  <font color="blue">parameter </font>Real tableHI[:,:]=<font color="red">fill</font>(0,0,2) <font color="darkgreen">
    &quot;Table for HI_ISO=f(ZLPout_ISO, Tsync)&quot;</font>;
  <font color="blue">parameter </font>Real tablePR[:,:]=<font color="red">fill</font>(0,0,2) <font color="darkgreen">&quot;Table for PR=g(ZLPout_ISO,Tsync)&quot;</font>;
  <font color="blue">parameter </font>Real tableW[:,:]=<font color="red">fill</font>(0,0,2) <font color="darkgreen">
    &quot;Table for wia_ISO=h(ZLPout_ISO,Tsync)&quot;</font>;
  <font color="blue">parameter </font>String fileName=&quot;noName&quot; <font color="darkgreen">&quot;File where matrix is stored&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_TurboMachinery_TableTypes.html#ThermoPower.Choices.TurboMachinery.TableTypes.Temp"
>TableTypes.Temp</A> Table <font color="darkgreen">
    &quot;Selection of the way of definition of table matrix&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Tables.html#Modelica.Blocks.Tables.CombiTable2D"
>Modelica.Blocks.Tables.CombiTable2D</A> PowerOut( tableOnFile= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>false<font color="blue"> else </font>true,
                    table=tableHI, tableName=<font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>&quot;tabHI&quot;,
                    fileName=<font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>fileName,
    smoothness=Modelica.Blocks.Types.Smoothness.ContinuousDerivative);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Tables.html#Modelica.Blocks.Tables.CombiTable2D"
>Modelica.Blocks.Tables.CombiTable2D</A> PressRatio( tableOnFile = <font color="blue">if </font>(Table==0)<font color="blue"> then </font>false<font color="blue"> else </font>true,
                    table=tablePR, tableName=<font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>&quot;tabPR&quot;,
                    fileName=<font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>fileName,
    smoothness=Modelica.Blocks.Types.Smoothness.ContinuousDerivative);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Tables.html#Modelica.Blocks.Tables.CombiTable2D"
>Modelica.Blocks.Tables.CombiTable2D</A> MassFlowRate( tableOnFile= <font color="blue">if </font>(Table==0)<font color="blue"> then </font>false<font color="blue"> else </font>true,
                    table=tableW, tableName=<font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>&quot;tabW&quot;,
                    fileName=<font color="blue">if </font>(Table==0)<font color="blue"> then </font>&quot;NoName&quot;<font color="blue"> else </font>fileName,
    smoothness=Modelica.Blocks.Types.Smoothness.ContinuousDerivative);
  <A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tsync <font color="darkgreen">
    &quot;temperature corresponding to omega referred in synchronous conditions&quot;</font>;
<font color="blue">equation </font>
  Tsync=(omega_sync/omega)^2*gas.T;
  <font color="darkgreen">// HI_ISO = f(ZLPout_ISO, Tsync)</font>
  PowerOut.u1=ZLPout_ISO;
  PowerOut.u2=Tsync;
  PowerOut.y=HI_ISO;

  <font color="darkgreen">// PR = g(ZLPout_ISO, Tsync)</font>
  PressRatio.u1=ZLPout_ISO;
  PressRatio.u2=Tsync;
  PressRatio.y=PR;

  <font color="darkgreen">// wia_ISO = h(ZLPout_ISO, Tsync)</font>
  MassFlowRate.u1=ZLPout_ISO;
  MassFlowRate.u2=Tsync;
  MassFlowRate.y=wia_ISO;
<font color="blue">end </font>GTunit;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE FanBase<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.FanBaseI.png" ALT="ThermoPower.Gas.FanBase" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.FanBase"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.FanBase</H2>
<B>Base model for fans</B><p>
<IMG SRC="ThermoPower.Gas.FanBaseD.png" ALT="ThermoPower.Gas.FanBase">
<H3>Information</H3>
<PRE></pre>
<p>This is the base model for the <tt>FanMech</tt> fan model.
<p>The model describes a fan, or a group of <tt>Np</tt> identical fans, with optional blade angle regulation. The fan model is based on the theory of kinematic similarity: the fan characteristics are given for nominal operating conditions (rotational speed and fluid density), and then adapted to actual operating condition, according to the similarity equations.
<p>In order to avoid singularities in the computation of the outlet enthalpy at zero flowrate, the thermal capacity of the fluid inside the fan body can be taken into account.
<p>The model can either support reverse flow conditions or include a built-in check valve to avoid flow reversal.
<p><b>Modelling options</b></p>
<p> The nominal flow characteristic (specific energy vs. volume flow rate) is given by the the replaceable function <tt>flowCharacteristic</tt>. If the blade angles are fixed, it is possible to use implementations which ignore the <tt>bladePos</tt> input.
<p> The fan energy balance can be specified in two alternative ways:
<ul>
<li><tt>usePowerCharacteristic = false</tt> (default option): the replaceable function <tt>efficiencyCharacteristic</tt> (efficiency vs. volume flow rate in nominal conditions) is used to determine the efficiency, and then the power consumption. The default is a constant efficiency of 0.8.
<li><tt>usePowerCharacteristic = true</tt>: the replaceable function <tt>powerCharacteristic</tt> (power consumption vs. volume flow rate in nominal conditions) is used to determine the power consumption, and then the efficiency.
</ul>
<p>
Several functions are provided in the package <tt>Functions.FanCharacteristics</tt> to specify the characteristics as a function of some operating points at nominal conditions.
<p>Depending on the value of the <tt>checkValve</tt> parameter, the model either supports reverse flow conditions, or includes a built-in check valve to avoid flow reversal.
<p>If the <tt>in_Np</tt> input connector is wired, it provides the number of fans in parallel; otherwise,  <tt>Np0</tt> parallel fans are assumed.</p>
<p>It is possible to take into account the heat capacity of the fluid inside the fan by specifying its volume <tt>V</tt> at nominal conditions; this is necessary to avoid singularities in the computation of the outlet enthalpy in case of zero flow rate. If zero flow rate conditions are always avoided, this dynamic effect can be neglected by leaving the default value <tt>V = 0</tt>, thus avoiding a fast state variable in the model.
<p>The <tt>CheckValve</tt> parameter determines whether the fan has a built-in check valve or not.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Integer</TD><TD>Np0</TD><TD>1</TD><TD>Nominal number of fans in parallel</TD></TR>
<TR><TD>Real</TD><TD>bladePos0</TD><TD>1</TD><TD>Nominal blade position</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V</TD><TD>0</TD><TD>Fan Internal Volume [m3]</TD></TR>
<TR><TD>Boolean</TD><TD>CheckValve</TD><TD>false</TD><TD>Reverse flow stopped</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Characteristics</TD></TR>
<TR><TD>Boolean</TD><TD>usePowerCharacteristic</TD><TD>false</TD><TD>Use powerCharacteristic (vs. efficiencyCharacteristic)</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rho0</TD><TD>1.229</TD><TD>Nominal Gas Density [kg/m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A></TD><TD>n0</TD><TD>1500</TD><TD>Nominal rotational speed [rev/min]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pin_start</TD><TD>&nbsp;</TD><TD>Inlet Pressure Start Value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pout_start</TD><TD>&nbsp;</TD><TD>Outlet Pressure Start Value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>VolumeFlowRate</A></TD><TD>q_single_start</TD><TD>0</TD><TD>Volume Flow Rate Start Value (single pump) [m3/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart</TD><TD>1e5</TD><TD>Fluid Specific Enthalpy Start Value [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rho_start</TD><TD>rho0</TD><TD>Inlet Density start value [kg/m3]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.IntegerInput"
>IntegerInput</A></TD><TD>in_Np</TD><TD>Number of  parallel pumps</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_bladePos</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> FanBase <font color="darkgreen">&quot;Base model for fans&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Gas.html#ThermoPower.Icons.Gas.Fan"
>Icons.Gas.Fan</A>;
  <font color="blue">import </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits"
>Modelica.SIunits.Conversions.NonSIunits</A>.*;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = Water.StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  Medium.BaseProperties inletFluid(p(start=pin_start),h(start=hstart)) <font color="darkgreen">
    &quot;Fluid properties at the inlet&quot;</font>;
  <font color="blue">replaceable </font><font color="blue">function</font> flowCharacteristic =
      <A HREF="ThermoPower_Functions_FanCharacteristics.html#ThermoPower.Functions.FanCharacteristics.baseFlow"
>Functions.FanCharacteristics.baseFlow</A> <font color="darkgreen">
    &quot;Head vs. q_flow characteristic at nominal speed and density&quot;</font>;
  <font color="blue">parameter </font>Boolean usePowerCharacteristic = false <font color="darkgreen">
    &quot;Use powerCharacteristic (vs. efficiencyCharacteristic)&quot;</font>;
  <font color="blue">replaceable </font><font color="blue">function</font> powerCharacteristic =
    <A HREF="ThermoPower_Functions_FanCharacteristics.html#ThermoPower.Functions.FanCharacteristics.constantPower"
>Functions.FanCharacteristics.constantPower</A>
    <font color="blue">extends </font>Functions.FanCharacteristics.basePower <font color="darkgreen">
    &quot;Power consumption vs. q_flow at nominal speed and density&quot;</font>;
  <font color="blue">replaceable </font><font color="blue">function</font> efficiencyCharacteristic =
    <A HREF="ThermoPower_Functions_FanCharacteristics.html#ThermoPower.Functions.FanCharacteristics.constantEfficiency"
>Functions.FanCharacteristics.constantEfficiency</A>(eta_nom = 0.8)
    <font color="blue">extends </font>Functions.PumpCharacteristics.baseEfficiency <font color="darkgreen">
    &quot;Efficiency vs. q_flow at nominal speed and density&quot;</font>;
  <font color="blue">parameter </font>Integer Np0(min=1) = 1 <font color="darkgreen">&quot;Nominal number of fans in parallel&quot;</font>;
  <font color="blue">parameter </font>Real bladePos0 = 1 <font color="darkgreen">&quot;Nominal blade position&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A> rho0=1.229 <font color="darkgreen">&quot;Nominal Gas Density&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A> n0=1500 <font color="darkgreen">&quot;Nominal rotational speed&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> V=0 <font color="darkgreen">&quot;Fan Internal Volume&quot;</font>;
  <font color="blue">parameter </font>Boolean CheckValve=false <font color="darkgreen">&quot;Reverse flow stopped&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pin_start <font color="darkgreen">&quot;Inlet Pressure Start Value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pout_start <font color="darkgreen">&quot;Outlet Pressure Start Value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>VolumeFlowRate</A> q_single_start=0 <font color="darkgreen">
    &quot;Volume Flow Rate Start Value (single pump)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hstart=1e5 <font color="darkgreen">&quot;Fluid Specific Enthalpy Start Value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A> rho_start=rho0 <font color="darkgreen">&quot;Inlet Density start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Choices.Init.Options.Temp</A> initOpt=Choices.Init.Options.noInit <font color="darkgreen">
    &quot;Initialisation option&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w_single(start=q_single_start*rho_start) <font color="darkgreen">
    &quot;Mass flow rate (single fan)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w = Np*w_single <font color="darkgreen">&quot;Mass flow rate (total)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>VolumeFlowRate</A> q_single <font color="darkgreen">&quot;Volume flow rate (single fan)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>VolumeFlowRate</A> q=Np*q_single <font color="darkgreen">&quot;Volume flow rate (totale)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> dp <font color="darkgreen">&quot;Outlet pressure minus inlet pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnergy"
>SpecificEnergy</A> H = dp/rho <font color="darkgreen">&quot;Specific energy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> h(start=hstart) <font color="darkgreen">&quot;Fluid specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hin(start=hstart) <font color="darkgreen">&quot;Enthalpy of entering fluid&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hout(start=hstart) <font color="darkgreen">&quot;Enthalpy of outgoing fluid&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.LiquidDensity"
>LiquidDensity</A> rho <font color="darkgreen">&quot;Gas density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> Tin <font color="darkgreen">&quot;Gas inlet temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A> n <font color="darkgreen">&quot;Shaft r.p.m.&quot;</font>;
  Real bladePos <font color="darkgreen">&quot;Blade position&quot;</font>;
  Integer Np(min=1) <font color="darkgreen">&quot;Number of fans in parallel&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> W_single <font color="darkgreen">&quot;Power Consumption (single fan)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> W = Np*W_single <font color="darkgreen">&quot;Power Consumption (total)&quot;</font>;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> W_eps=1e-8 <font color="darkgreen">
    &quot;Small coefficient to avoid numerical singularities&quot;</font>;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A> n_eps=1e-6;
  Real eta <font color="darkgreen">&quot;Fan efficiency&quot;</font>;
  Real s <font color="darkgreen">&quot;Auxiliary Variable&quot;</font>;
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>Gas.FlangeA</A> infl(
    p(start=pin_start),
    hAB(start=hstart),
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>Gas.FlangeB</A> outfl(
    p(start=pout_start),
    hBA(start=hstart),
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.IntegerInput"
>Modelica.Blocks.Interfaces.IntegerInput</A> in_Np <font color="darkgreen">&quot;Number of  parallel pumps&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_bladePos;
<font color="blue">equation </font>
  <font color="darkgreen">// Number of fans in parallel</font>
  Np = in_Np;
  <font color="blue">if </font><font color="red">cardinality</font>(in_Np)==0<font color="blue"> then</font>
    in_Np = Np0 <font color="darkgreen">&quot;Number of fans selected by parameter&quot;</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Blade position</font>
  bladePos = in_bladePos;
  <font color="blue">if </font><font color="red">cardinality</font>(in_bladePos)==0<font color="blue"> then</font>
    in_bladePos = bladePos0 <font color="darkgreen">&quot;Blade position selected by parameter&quot;</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Fluid properties (always uses the properties upstream of the inlet flange)</font>
  inletFluid.p=infl.p;
  inletFluid.h=infl.hBA;
  rho = inletFluid.d;
  Tin = inletFluid.T;

  <font color="darkgreen">  // Flow equations</font>
  q_single = w_single/rho;
  <font color="blue">if </font><font color="red">noEvent</font>(s &gt; 0<font color="blue"> or </font>(<font color="blue">not </font>CheckValve))<font color="blue"> then</font>
    <font color="darkgreen">// Flow characteristics when check valve is open</font>
    q_single = s;
    H = (n/n0)^2*<font color="red">flowCharacteristic</font>(q_single*n0/(n+n_eps),bladePos);
  <font color="blue">else</font>
    <font color="darkgreen">// Flow characteristics when check valve is closed</font>
    H = (n/n0)^2*<font color="red">flowCharacteristic</font>(0) - s;
    q_single = 0;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Power consumption  </font>
  <font color="blue">if </font>usePowerCharacteristic<font color="blue"> then</font>
    W_single = (n/n0)^3*(rho/rho0)*<font color="red">powerCharacteristic</font>(q_single*n0/(n+n_eps),bladePos) <font color="darkgreen">
      &quot;Power consumption (single fan)&quot;</font>;
    eta = (dp*q_single)/(W_single + W_eps) <font color="darkgreen">&quot;Hydraulic efficiency&quot;</font>;
  <font color="blue">else</font>
    eta =<font color="red"> efficiencyCharacteristic</font>(q_single*n0/(n+n_eps),bladePos);
    W_single = dp*q_single/eta;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Boundary conditions</font>
  dp = outfl.p - infl.p;
  w = infl.w <font color="darkgreen">&quot;Fan total flow rate&quot;</font>;
  hin = <font color="blue">if </font>w &gt;= 0<font color="blue"> then </font>infl.hBA<font color="blue"> else </font>h;
  hout = <font color="blue">if </font>w &gt;= 0<font color="blue"> then </font>h<font color="blue"> else </font>outfl.hAB;

  <font color="darkgreen">// Mass balance</font>
  infl.w + outfl.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;

  <font color="darkgreen">// Energy balance</font>
  <font color="blue">if </font>V&gt;0<font color="blue"> then</font>
    (rho*V*<font color="red">der</font>(h)) = (outfl.w/Np)*hout + (infl.w/Np)*hin + W_single <font color="darkgreen">
      &quot;Dynamic energy balance (single fan)&quot;</font>;
    outfl.hBA = h;
    infl.hAB = h;
  <font color="blue">else</font>
    outfl.hBA = infl.hBA + W_single/w <font color="darkgreen">&quot;Energy balance for w &gt; 0&quot;</font>;
    infl.hAB = outfl.hAB + W_single/w <font color="darkgreen">&quot;Energy balance for w &lt; 0&quot;</font>;
    h = <font color="blue">if </font>w&gt;=0<font color="blue"> then </font>outfl.hBA<font color="blue"> else </font>infl.hAB <font color="darkgreen">&quot;Definition of h&quot;</font>;
  <font color="blue">end if</font>;

<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="blue">if </font>V&gt;0<font color="blue"> then</font>
      <font color="red">der</font>(h)=0;
    <font color="blue">end if</font>;
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;

<font color="blue">end </font>FanBase;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE FanMech<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Gas.FanMechI.png" ALT="ThermoPower.Gas.FanMech" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Gas.FanMech"></A><A HREF="ThermoPower_Gas.html#ThermoPower.Gas"
>ThermoPower.Gas</A>.FanMech</H2>
<IMG SRC="ThermoPower.Gas.FanMechD.png" ALT="ThermoPower.Gas.FanMech">
<H3>Information</H3>
<PRE></pre>
<p>This model describes a fan (or a group of <tt>Np</tt> fans in parallel) with a mechanical rotational connector for the shaft, to be used when the pump drive has to be modelled explicitly. In the case of <tt>Np</tt> fans in parallel, the mechanical connector is relative to a single fan.
<p>The model extends <tt>FanBase</tt>
 <pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>Water.StandardWater</TD><TD>Medium model</TD></TR>
<TR><TD>Integer</TD><TD>Np0</TD><TD>1</TD><TD>Nominal number of fans in parallel</TD></TR>
<TR><TD>Real</TD><TD>bladePos0</TD><TD>1</TD><TD>Nominal blade position</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V</TD><TD>0</TD><TD>Fan Internal Volume [m3]</TD></TR>
<TR><TD>Boolean</TD><TD>CheckValve</TD><TD>false</TD><TD>Reverse flow stopped</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Characteristics</TD></TR>
<TR><TD colspan="2">replaceable function flowCharacteristic</TD><TD>Functions.FanCharacteristics...</TD><TD>Head vs. q_flow characteristic at nominal speed and density</TD></TR>
<TR><TD>Boolean</TD><TD>usePowerCharacteristic</TD><TD>false</TD><TD>Use powerCharacteristic (vs. efficiencyCharacteristic)</TD></TR>
<TR><TD colspan="2">replaceable function powerCharacteristic</TD><TD>Functions.FanCharacteristics...</TD><TD>Power consumption vs. q_flow at nominal speed and density</TD></TR>
<TR><TD colspan="2">replaceable function efficiencyCharacteristic</TD><TD>Functions.FanCharacteristics...</TD><TD>Efficiency vs. q_flow at nominal speed and density</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rho0</TD><TD>1.229</TD><TD>Nominal Gas Density [kg/m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A></TD><TD>n0</TD><TD>1500</TD><TD>Nominal rotational speed [rev/min]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pin_start</TD><TD>&nbsp;</TD><TD>Inlet Pressure Start Value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pout_start</TD><TD>&nbsp;</TD><TD>Outlet Pressure Start Value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>VolumeFlowRate</A></TD><TD>q_single_start</TD><TD>0</TD><TD>Volume Flow Rate Start Value (single pump) [m3/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart</TD><TD>1e5</TD><TD>Fluid Specific Enthalpy Start Value [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rho_start</TD><TD>rho0</TD><TD>Inlet Density start value [kg/m3]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.IntegerInput"
>IntegerInput</A></TD><TD>in_Np</TD><TD>Number of  parallel pumps</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_bladePos</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Flange_a</A></TD><TD>MechPort</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> FanMech
  <font color="blue">extends </font><A HREF="ThermoPower_Gas.html#ThermoPower.Gas.FanBase"
>FanBase</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</A> phi <font color="darkgreen">&quot;Shaft angle&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>AngularVelocity</A> omega <font color="darkgreen">&quot;Shaft angular velocity&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> MechPort;
<font color="blue">equation </font>
  n =<font color="red"> Modelica.SIunits.Conversions.to_rpm</font>(omega) <font color="darkgreen">&quot;Rotational speed&quot;</font>;

  <font color="darkgreen">// Mechanical boundary condition</font>
  phi = MechPort.phi;
  omega =<font color="red"> der</font>(phi);
  W_single = omega*MechPort.tau;

<font color="blue">end </font>FanMech;
</PRE>
<HR>
<address>HTML-documentation generated by <a href="http://www.dynasim.se/">Dymola</a> Tue Jul 07 01:22:27 2009.
</address></BODY>
</HTML>
