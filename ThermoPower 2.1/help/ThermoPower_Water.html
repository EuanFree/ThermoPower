<HTML>
<HEAD>
<TITLE>ThermoPower.Water</TITLE>
<META name="HTML-Generator" content="Dymola">
<META name="description" content="&quot;Models of components with water/steam as working fluid&quot;">
</HEAD>
<BODY><P>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Water<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="ThermoPower.Water"></A><A HREF="ThermoPower.html#ThermoPower"
>ThermoPower</A>.Water</H2>
<B>Models of components with water/steam as working fluid</B>
<P>
<H3>Information</H3>
<PRE></pre>
This package contains models of physical processes and components using water or steam as working fluid.
<p>All models use the <tt>StandardWater</tt> medium model by default, which is in turn set to <tt>Modelica.Media.Water.StandardWater</tt> at the library level. It is of course possible to redeclare the medium model to any model extending <tt>Modelica.Media.Interfaces.PartialMedium</tt> (or <tt>PartialTwoPhaseMedium</tt> for 2-phase models). This can be done by directly setting Medium in the parameter dialog, or through a local package definition, as shown e.g. in <tt>Test.TestMixerSlowFast</tt>. The latter solution allows to easily replace the medium model for an entire set of components.
<p>All models with dynamic equations provide initialisation support. Set the <tt>initOpt</tt> parameter to the appropriate value:
<ul>
<li><tt>Choices.Init.Options.noInit</tt>: no initialisation
<li><tt>Choices.Init.Options.steadyState</tt>: full steady-state initialisation
<li><tt>Choices.Init.Options.steadyStateNoP</tt>: steady-state initialisation (except pressure)
<li><tt>Choices.Init.Options.steadyStateNoT</tt>: steady-state initialisation (except temperature)
</ul>
The latter options can be useful when two or more components are connected directly so that they will have the same pressure or temperature, to avoid over-specified systems of initial equations.
<pre></PRE><P>
<H3>Package Content</H3><p>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2 >
<TR><TH >Name</TH><TH>Description</TH></TR>
<TR><TD><IMG SRC="ThermoPower.Water.FlangeS.png" ALT="ThermoPower.Water.Flange" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Flange"
>Flange</A>
</TD><TD>Generic flange connector for water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.FlangeAS.png" ALT="ThermoPower.Water.FlangeA" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A>
</TD><TD>A-type flange connector for water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.FlangeBS.png" ALT="ThermoPower.Water.FlangeB" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A>
</TD><TD>B-type flange connector for water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.SourcePS.png" ALT="ThermoPower.Water.SourceP" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.SourceP"
>SourceP</A>
</TD><TD>Pressure source for water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.SinkPS.png" ALT="ThermoPower.Water.SinkP" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.SinkP"
>SinkP</A>
</TD><TD>Pressure sink for water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.SourceWS.png" ALT="ThermoPower.Water.SourceW" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.SourceW"
>SourceW</A>
</TD><TD>Flowrate source for water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.SinkWS.png" ALT="ThermoPower.Water.SinkW" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.SinkW"
>SinkW</A>
</TD><TD>Flowrate sink for water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.ThroughWS.png" ALT="ThermoPower.Water.ThroughW" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.ThroughW"
>ThroughW</A>
</TD><TD>Prescribes the flow rate across the component</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.PressDropLinS.png" ALT="ThermoPower.Water.PressDropLin" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.PressDropLin"
>PressDropLin</A>
</TD><TD>Linear pressure drop for water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.PressDropLinS.png" ALT="ThermoPower.Water.PressDrop" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.PressDrop"
>PressDrop</A>
</TD><TD>Pressure drop for water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.HeaderS.png" ALT="ThermoPower.Water.Header" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Header"
>Header</A>
</TD><TD>Header with metal walls for water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.MixerS.png" ALT="ThermoPower.Water.Mixer" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Mixer"
>Mixer</A>
</TD><TD>Mixer with metal walls for water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.TankS.png" ALT="ThermoPower.Water.Tank" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Tank"
>Tank</A>
</TD><TD>Open tank with free surface</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.Flow1DBaseS.png" ALT="ThermoPower.Water.Flow1DBase" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1DBase"
>Flow1DBase</A>
</TD><TD>Basic interface for 1-dimensional water/steam fluid flow models</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.Flow1DBaseS.png" ALT="ThermoPower.Water.Flow1D" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1D"
>Flow1D</A>
</TD><TD>1-dimensional fluid flow model for water/steam (finite volumes)</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.Flow1DBaseS.png" ALT="ThermoPower.Water.Flow1DDB" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1DDB"
>Flow1DDB</A>
</TD><TD>1-dimensional fluid flow model for water or steam flow (finite volumes, Dittus-Boelter heat transfer)</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.Flow1DBaseS.png" ALT="ThermoPower.Water.Flow1D2ph" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1D2ph"
>Flow1D2ph</A>
</TD><TD>1-dimensional fluid flow model for water/steam (finite volumes, 2-phase)</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.Flow1DBaseS.png" ALT="ThermoPower.Water.Flow1D2phDB" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1D2phDB"
>Flow1D2phDB</A>
</TD><TD>1-dimensional fluid flow model for 2-phase boiling flow (finite volumes, 2-phase, computation of heat transfer coeff.)</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.Flow1DBaseS.png" ALT="ThermoPower.Water.Flow1D2phChen" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1D2phChen"
>Flow1D2phChen</A>
</TD><TD>1-dimensional fluid flow model for 2-phase boiling flow (finite volumes, 2-phase, Chen correlation)</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.Flow1DBaseS.png" ALT="ThermoPower.Water.Flow1Dfem" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1Dfem"
>Flow1Dfem</A>
</TD><TD>1-dimensional fluid flow model for water/steam (finite elements)</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.Flow1DBaseS.png" ALT="ThermoPower.Water.Flow1Dfem2ph" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1Dfem2ph"
>Flow1Dfem2ph</A>
</TD><TD>1-dimensional fluid flow model for water/steam (finite elements)</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.FlowJoinS.png" ALT="ThermoPower.Water.FlowJoin" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.FlowJoin"
>FlowJoin</A>
</TD><TD>Joins two water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.FlowSplitS.png" ALT="ThermoPower.Water.FlowSplit" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.FlowSplit"
>FlowSplit</A>
</TD><TD>Splits a flow in two</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.SensTS.png" ALT="ThermoPower.Water.SensT" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.SensT"
>SensT</A>
</TD><TD>Temperature sensor for water-steam</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.SensWS.png" ALT="ThermoPower.Water.SensW" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.SensW"
>SensW</A>
</TD><TD>Mass Flowrate sensor for water/steam</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.SensPS.png" ALT="ThermoPower.Water.SensP" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.SensP"
>SensP</A>
</TD><TD>Pressure sensor for water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.AccumulatorS.png" ALT="ThermoPower.Water.Accumulator" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Accumulator"
>Accumulator</A>
</TD><TD>Water-Gas Accumulator</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.Drum2StatesS.png" ALT="ThermoPower.Water.Drum2States" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Drum2States"
>Drum2States</A>
</TD><TD>&nbsp;</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.DrumS.png" ALT="ThermoPower.Water.Drum" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Drum"
>Drum</A>
</TD><TD>Drum for circulation boilers</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.ValveLinS.png" ALT="ThermoPower.Water.ValveLin" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.ValveLin"
>ValveLin</A>
</TD><TD>Valve for water/steam flows with linear pressure drop</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.ValveLinS.png" ALT="ThermoPower.Water.ValveBase" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.ValveBase"
>ValveBase</A>
</TD><TD>Base model for valves</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.ValveLinS.png" ALT="ThermoPower.Water.ValveLiq" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.ValveLiq"
>ValveLiq</A>
</TD><TD>Valve for liquid water flow</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.ValveLinS.png" ALT="ThermoPower.Water.ValveVap" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.ValveVap"
>ValveVap</A>
</TD><TD>Valve for steam flow</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.ValveLinS.png" ALT="ThermoPower.Water.ValveLiqChoked" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.ValveLiqChoked"
>ValveLiqChoked</A>
</TD><TD>Valve for liquid water flow, allows choked flow conditions</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.PumpBaseS.png" ALT="ThermoPower.Water.PumpBase" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.PumpBase"
>PumpBase</A>
</TD><TD>Base model for centrifugal pumps</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.PumpS.png" ALT="ThermoPower.Water.Pump" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.Pump"
>Pump</A>
</TD><TD>Centrifugal pump with ideally controlled speed</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.PumpS.png" ALT="ThermoPower.Water.PumpNPSH" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.PumpNPSH"
>PumpNPSH</A>
</TD><TD>&nbsp;</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.PumpMechS.png" ALT="ThermoPower.Water.PumpMech" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.PumpMech"
>PumpMech</A>
</TD><TD>Centrifugal pump with mechanical connector for the shaft</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.f_chenS.png" ALT="ThermoPower.Water.f_chen" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.f_chen"
>f_chen</A>
</TD><TD>Chen's correlation for two-phase flow in a tube</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.f_chenS.png" ALT="ThermoPower.Water.f_colebrook" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.f_colebrook"
>f_colebrook</A>
</TD><TD>Fanning friction factor for water/steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.f_chenS.png" ALT="ThermoPower.Water.f_colebrook_2ph" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.f_colebrook_2ph"
>f_colebrook_2ph</A>
</TD><TD>Fanning friction factor for a two phase water/steam flow</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.f_chenS.png" ALT="ThermoPower.Water.f_dittus_boelter" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.f_dittus_boelter"
>f_dittus_boelter</A>
</TD><TD>Dittus-Boelter correlation for one-phase flow in a tube</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.SteamTurbineBaseS.png" ALT="ThermoPower.Water.SteamTurbineBase" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.SteamTurbineBase"
>SteamTurbineBase</A>
</TD><TD>Steam turbine</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.SteamTurbineBaseS.png" ALT="ThermoPower.Water.SteamTurbineStodola" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.SteamTurbineStodola"
>SteamTurbineStodola</A>
</TD><TD>Steam turbine</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.SteamTurbineUnitS.png" ALT="ThermoPower.Water.SteamTurbineUnit" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.SteamTurbineUnit"
>SteamTurbineUnit</A>
</TD><TD>Turbine for steam flows</TD></TR>
<TR><TD><IMG SRC="ThermoPower.Water.EvaporatorBaseS.png" ALT="ThermoPower.Water.EvaporatorBase" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="ThermoPower_Water.html#ThermoPower.Water.EvaporatorBase"
>EvaporatorBase</A>
</TD><TD>Basic interface for 1-dimensional water/steam fluid flow models</TD></TR>
</TABLE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Flange<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.FlangeI.png" ALT="ThermoPower.Water.Flange" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Flange"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Flange</H2>
<B>Generic flange connector for water/steam flows</B><p>
<H3>Information</H3>
<PRE></pre>
<p>Can be connected either to a type-A (<tt>FlangeA</tt>) or to a type B (<tt>FlangeB</tt>) connector.
<pre></PRE>
<H3>Contents</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>p</TD><TD>Pressure [Pa]</TD></TR>
<TR><TD>flow <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>w</TD><TD>Mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hAB</TD><TD>[J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hBA</TD><TD>[J/kg]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">connector</font> Flange <font color="darkgreen">&quot;Generic flange connector for water/steam flows&quot;</font>
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p <font color="darkgreen">&quot;Pressure&quot;</font>;
  <font color="blue">flow </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium.MassFlowRate</A> w <font color="darkgreen">&quot;Mass flowrate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hAB;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hBA;
<font color="blue">end </font>Flange;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE FlangeA<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.FlangeAI.png" ALT="ThermoPower.Water.FlangeA" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.FlangeA"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.FlangeA</H2>
<B>A-type flange connector for water/steam flows</B><p>
<H3>Information</H3>
<PRE></pre>
<p> Must always be connected to a single type-B connector <tt>FlangeB</tt>.
<pre></PRE>
<H3>Contents</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>p</TD><TD>Pressure [Pa]</TD></TR>
<TR><TD>flow <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>w</TD><TD>Mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hAB</TD><TD>Specific enthalpy of fluid going out [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hBA</TD><TD>Specific enthalpy of entering fluid [J/kg]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">connector</font> FlangeA <font color="darkgreen">&quot;A-type flange connector for water/steam flows&quot;</font>
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p <font color="darkgreen">&quot;Pressure&quot;</font>;
  <font color="blue">flow </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium.MassFlowRate</A> w <font color="darkgreen">&quot;Mass flowrate&quot;</font>;
  <font color="blue">output </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hAB <font color="darkgreen">&quot;Specific enthalpy of fluid going out&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hBA <font color="darkgreen">&quot;Specific enthalpy of entering fluid&quot;</font>;
<font color="blue">end </font>FlangeA;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE FlangeB<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.FlangeBI.png" ALT="ThermoPower.Water.FlangeB" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.FlangeB"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.FlangeB</H2>
<B>B-type flange connector for water/steam flows</B><p>
<H3>Information</H3>
<PRE></pre>
<p> Must always be connected to a single type-A connector <tt>FlangeA</tt>.
<pre></PRE>
<H3>Contents</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>p</TD><TD>Pressure [Pa]</TD></TR>
<TR><TD>flow <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>MassFlowRate</A></TD><TD>w</TD><TD>Mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hAB</TD><TD>Specific enthalpy of entering fluid [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hBA</TD><TD>Specific enthalpy of fluid going out [J/kg]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">connector</font> FlangeB <font color="darkgreen">&quot;B-type flange connector for water/steam flows&quot;</font>
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p <font color="darkgreen">&quot;Pressure&quot;</font>;
  <font color="blue">flow </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.MassFlowRate"
>Medium.MassFlowRate</A> w <font color="darkgreen">&quot;Mass flowrate&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hAB <font color="darkgreen">&quot;Specific enthalpy of entering fluid&quot;</font>;
  <font color="blue">output </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hBA <font color="darkgreen">&quot;Specific enthalpy of fluid going out&quot;</font>;
<font color="blue">end </font>FlangeB;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SourceP<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.SourcePI.png" ALT="ThermoPower.Water.SourceP" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.SourceP"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.SourceP</H2>
<B>Pressure source for water/steam flows</B><p>
<IMG SRC="ThermoPower.Water.SourcePD.png" ALT="ThermoPower.Water.SourceP">
<H3>Information</H3>
<PRE></pre>
<p><b>Modelling options</b></p>
<p>If <tt>R</tt> is set to zero, the pressure source is ideal; otherwise, the outlet pressure decreases proportionally to the outgoing flowrate.</p>
<p>If the <tt>in_p0</tt> connector is wired, then the source pressure is given by the corresponding signal, otherwise it is fixed to <tt>p0</tt>.</p>
<p>If the <tt>in_h</tt> connector is wired, then the source pressure is given by the corresponding signal, otherwise it is fixed to <tt>h</tt>.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>p0</TD><TD>1.01325e5</TD><TD>Nominal pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.HydraulicResistance"
>HydraulicResistance</A></TD><TD>R</TD><TD>0</TD><TD>Hydraulic resistance [Pa/(kg/s)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h</TD><TD>1e5</TD><TD>Nominal specific enthalpy [J/kg]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>flange</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_p0</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_h</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SourceP <font color="darkgreen">&quot;Pressure source for water/steam flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.SourceP"
>Icons.Water.SourceP</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> p0=1.01325e5 <font color="darkgreen">&quot;Nominal pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.HydraulicResistance"
>HydraulicResistance</A> R=0 <font color="darkgreen">&quot;Hydraulic resistance&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> h=1e5 <font color="darkgreen">&quot;Nominal specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> p <font color="darkgreen">&quot;Actual pressure&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> flange(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_p0;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_h;
<font color="blue">equation </font>
  <font color="blue">if </font>R == 0<font color="blue"> then</font>
    flange.p = p;
  <font color="blue">else</font>
    flange.p = p + flange.w*R;
  <font color="blue">end if</font>;

  p = in_p0;
  <font color="blue">if </font><font color="red">cardinality</font>(in_p0)==0<font color="blue"> then</font>
    in_p0 = p0 <font color="darkgreen">&quot;Pressure set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  flange.hBA =in_h;
  <font color="blue">if </font><font color="red">cardinality</font>(in_h)==0<font color="blue"> then</font>
    in_h = h <font color="darkgreen">&quot;Enthalpy set by parameter&quot;</font>;
  <font color="blue">end if</font>;
<font color="blue">end </font>SourceP;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SinkP<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.SinkPI.png" ALT="ThermoPower.Water.SinkP" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.SinkP"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.SinkP</H2>
<B>Pressure sink for water/steam flows</B><p>
<IMG SRC="ThermoPower.Water.SinkPD.png" ALT="ThermoPower.Water.SinkP">
<H3>Information</H3>
<PRE></pre>
<p><b>Modelling options</b></p>
<p>If <tt>R</tt> is set to zero, the pressure sink is ideal; otherwise, the inlet pressure increases proportionally to the incoming flowrate.</p>
<p>If the <tt>in_p0</tt> connector is wired, then the source pressure is given by the corresponding signal, otherwise it is fixed to <tt>p0</tt>.</p>
<p>If the <tt>in_h</tt> connector is wired, then the source pressure is given by the corresponding signal, otherwise it is fixed to <tt>h</tt>.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>p0</TD><TD>1.01325e5</TD><TD>Nominal pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.HydraulicResistance"
>HydraulicResistance</A></TD><TD>R</TD><TD>0</TD><TD>Hydraulic resistance [Pa/(kg/s)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h</TD><TD>1e5</TD><TD>Nominal specific enthalpy [J/kg]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>flange</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_p0</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_h</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SinkP <font color="darkgreen">&quot;Pressure sink for water/steam flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.SourceP"
>Icons.Water.SourceP</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> p0=1.01325e5 <font color="darkgreen">&quot;Nominal pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.HydraulicResistance"
>HydraulicResistance</A> R=0 <font color="darkgreen">&quot;Hydraulic resistance&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> h=1e5 <font color="darkgreen">&quot;Nominal specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> p;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> flange(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_p0;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_h;
<font color="blue">equation </font>
  <font color="blue">if </font>R == 0<font color="blue"> then</font>
    flange.p = p;
  <font color="blue">else</font>
    flange.p = p + flange.w*R;
  <font color="blue">end if</font>;

  p = in_p0;
  <font color="blue">if </font><font color="red">cardinality</font>(in_p0)==0<font color="blue"> then</font>
    in_p0 = p0 <font color="darkgreen">&quot;Pressure set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  flange.hAB =in_h;
  <font color="blue">if </font><font color="red">cardinality</font>(in_h)==0<font color="blue"> then</font>
    in_h = h <font color="darkgreen">&quot;Enthalpy set by parameter&quot;</font>;
  <font color="blue">end if</font>;
<font color="blue">end </font>SinkP;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SourceW<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.SourceWI.png" ALT="ThermoPower.Water.SourceW" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.SourceW"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.SourceW</H2>
<B>Flowrate source for water/steam flows</B><p>
<IMG SRC="ThermoPower.Water.SourceWD.png" ALT="ThermoPower.Water.SourceW">
<H3>Information</H3>
<PRE></pre>
<p><b>Modelling options</b></p>
<p>If <tt>G</tt> is set to zero, the flowrate source is ideal; otherwise, the outgoing flowrate decreases proportionally to the outlet pressure.</p>
<p>If the <tt>in_w0</tt> connector is wired, then the source pressure is given by the corresponding signal, otherwise it is fixed to <tt>p0</tt>.</p>
<p>If the <tt>in_h</tt> connector is wired, then the source pressure is given by the corresponding signal, otherwise it is fixed to <tt>h</tt>.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>w0</TD><TD>0</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>p0</TD><TD>1e5</TD><TD>Nominal pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.HydraulicConductance"
>HydraulicConductance</A></TD><TD>G</TD><TD>0</TD><TD>Hydraulic conductance [(kg/s)/Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h</TD><TD>1e5</TD><TD>Nominal specific enthalpy [J/kg]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>flange</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_w0</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_h</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SourceW <font color="darkgreen">&quot;Flowrate source for water/steam flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.SourceW"
>Icons.Water.SourceW</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w0=0 <font color="darkgreen">&quot;Nominal mass flowrate&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> p0=1e5 <font color="darkgreen">&quot;Nominal pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.HydraulicConductance"
>HydraulicConductance</A> G=0 <font color="darkgreen">&quot;Hydraulic conductance&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> h=1e5 <font color="darkgreen">&quot;Nominal specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass flowrate&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> flange(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_w0;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_h;
<font color="blue">equation </font>
  <font color="blue">if </font>G == 0<font color="blue"> then</font>
    flange.w = -w;
  <font color="blue">else</font>
    flange.w = -w + (flange.p - p0)*G;
  <font color="blue">end if</font>;

  w = in_w0;
  <font color="blue">if </font><font color="red">cardinality</font>(in_w0) == 0<font color="blue"> then</font>
    in_w0 = w0 <font color="darkgreen">&quot;Flow rate set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  flange.hBA = in_h <font color="darkgreen">&quot;Enthalpy set by connector&quot;</font>;
  <font color="blue">if </font><font color="red">cardinality</font>(in_h) == 0<font color="blue"> then</font>
    in_h = h <font color="darkgreen">&quot;Enthalpy set by parameter&quot;</font>;
  <font color="blue">end if</font>;
<font color="blue">end </font>SourceW;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SinkW<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.SinkWI.png" ALT="ThermoPower.Water.SinkW" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.SinkW"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.SinkW</H2>
<B>Flowrate sink for water/steam flows</B><p>
<IMG SRC="ThermoPower.Water.SinkWD.png" ALT="ThermoPower.Water.SinkW">
<H3>Information</H3>
<PRE></pre>
<p><b>Modelling options</b></p>
<p>If <tt>G</tt> is set to zero, the flowrate source is ideal; otherwise, the incoming flowrate increases proportionally to the inlet pressure.</p>
<p>If <tt>w0Fix</tt> is set to true, the incoming flowrate is given by the parameter <tt>w0</tt>; otherwise, the <tt>in_w0</tt> connector must be wired, providing the (possibly varying) source flowrate.</p>
<p>If <tt>hFix</tt> is set to true, the source enthalpy is given by the parameter <tt>h</tt>; otherwise, the <tt>in_h</tt> connector must be wired, providing the (possibly varying) source enthalpy.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>w0</TD><TD>0</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>p0</TD><TD>1e5</TD><TD>Nominal pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.HydraulicConductance"
>HydraulicConductance</A></TD><TD>G</TD><TD>0</TD><TD>Hydraulic conductance [(kg/s)/Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>h</TD><TD>1e5</TD><TD>Nominal specific enthalpy [J/kg]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>flange</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_w0</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_h</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SinkW <font color="darkgreen">&quot;Flowrate sink for water/steam flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.SourceW"
>Icons.Water.SourceW</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w0=0 <font color="darkgreen">&quot;Nominal mass flowrate&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> p0=1e5 <font color="darkgreen">&quot;Nominal pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.HydraulicConductance"
>HydraulicConductance</A> G=0 <font color="darkgreen">&quot;Hydraulic conductance&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> h=1e5 <font color="darkgreen">&quot;Nominal specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass flowrate&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>Water.FlangeA</A> flange(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_w0;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_h;
<font color="blue">equation </font>
  <font color="blue">if </font>G == 0<font color="blue"> then</font>
    flange.w = w;
  <font color="blue">else</font>
    flange.w = w + (flange.p - p0)*G;
  <font color="blue">end if</font>;

  w = in_w0 <font color="darkgreen">&quot;Flow rate set by connector&quot;</font>;
  <font color="blue">if </font><font color="red">cardinality</font>(in_w0) == 0<font color="blue"> then</font>
    in_w0 = w0 <font color="darkgreen">&quot;Flow rate set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  flange.hAB = in_h <font color="darkgreen">&quot;Enthalpy set by connector&quot;</font>;
  <font color="blue">if </font><font color="red">cardinality</font>(in_h) == 0<font color="blue"> then</font>
    in_h = h <font color="darkgreen">&quot;Enthalpy set by parameter&quot;</font>;
  <font color="blue">end if</font>;
<font color="blue">end </font>SinkW;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ThroughW<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.ThroughWI.png" ALT="ThermoPower.Water.ThroughW" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.ThroughW"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.ThroughW</H2>
<B>Prescribes the flow rate across the component</B><p>
<IMG SRC="ThermoPower.Water.ThroughWD.png" ALT="ThermoPower.Water.ThroughW">
<H3>Information</H3>
<PRE></pre>
This component prescribes the flow rate passing through it. The change of
specific enthalpy due to the pressure difference between the inlet and the
outlet is ignored; use <t>Pump</t> models if this has to be taken into account correctly.
<p><b>Modelling options</b></p>
<p>If <tt>w0Fix</tt> is set to true, the flowrate is given by the parameter <tt>w0</tt>; otherwise, the <tt>in_w0</tt> connector must be wired, providing the (possibly varying) flowrate value.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>w0</TD><TD>0</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_w0</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ThroughW <font color="darkgreen">&quot;Prescribes the flow rate across the component&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.SourceW"
>Icons.Water.SourceW</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w0=0 <font color="darkgreen">&quot;Nominal mass flowrate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass flowrate&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_w0;
<font color="blue">equation </font>
  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  inlet.w = w <font color="darkgreen">&quot;Flow characteristics&quot;</font>;

  w = in_w0;
  <font color="blue">if </font><font color="red">cardinality</font>(in_w0) == 0<font color="blue"> then</font>
    in_w0 = w0 <font color="darkgreen">&quot;Flow rate set by parameter&quot;</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Energy balance</font>
  inlet.hAB = outlet.hAB;
  inlet.hBA = outlet.hBA;
<font color="blue">end </font>ThroughW;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE PressDropLin<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.PressDropLinI.png" ALT="ThermoPower.Water.PressDropLin" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.PressDropLin"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.PressDropLin</H2>
<B>Linear pressure drop for water/steam flows</B><p>
<IMG SRC="ThermoPower.Water.PressDropLinD.png" ALT="ThermoPower.Water.PressDropLin">
<H3>Information</H3>
<PRE></pre>
<p>This very simple model provides a pressure drop which is proportional to the flowrate, without computing any fluid property.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.HydraulicResistance"
>HydraulicResistance</A></TD><TD>R</TD><TD>&nbsp;</TD><TD>Hydraulic resistance [Pa/(kg/s)]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> PressDropLin <font color="darkgreen">&quot;Linear pressure drop for water/steam flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.PressDrop"
>Icons.Water.PressDrop</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.HydraulicResistance"
>HydraulicResistance</A> R <font color="darkgreen">&quot;Hydraulic resistance&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
<font color="blue">equation </font>
  inlet.w + outlet.w = 0;
  inlet.p - outlet.p = R*inlet.w <font color="darkgreen">&quot;Flow characteristics&quot;</font>;
  <font color="darkgreen">// Energy balance</font>
  inlet.hAB = outlet.hAB;
  inlet.hBA = outlet.hBA;
<font color="blue">end </font>PressDropLin;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE PressDrop<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.PressDropLinI.png" ALT="ThermoPower.Water.PressDrop" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.PressDrop"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.PressDrop</H2>
<B>Pressure drop for water/steam flows</B><p>
<IMG SRC="ThermoPower.Water.PressDropLinD.png" ALT="ThermoPower.Water.PressDrop">
<H3>Information</H3>
<PRE></pre>
<p>The pressure drop across the inlet and outlet connectors is computed according to a turbulent friction model, i.e. is proportional to the squared velocity of the fluid. The friction coefficient can be specified directly, or by giving an operating point, or as a multiple of the kinetic pressure. In the latter two cases, the correction coefficient <tt>Kfc</tt> can be used to modify the friction coefficient, e.g. to fit some experimental operating point.</p>
<p>A small linear pressure drop is added to avoid numerical singularities at low or zero flowrate. The <tt>wnom</tt> parameter must be always specified; the additional linear pressure drop is such that it is equal to the turbulent pressure drop when the flowrate is equal to <tt>wnf*wnom</tt> (the default value is 1% of the nominal flowrate).
<p><b>Modelling options</b></p>
<p>The following options are available to specify the friction coefficient:
<ul><li><tt>FFtype = 0</tt>: the hydraulic friction coefficient <tt>Kf</tt> is set directly.</li>
<li><tt>FFtype = 1</tt>: the hydraulic friction coefficient is specified by the nominal operating point (<tt>wnom</tt>,<tt>dpnom</tt>, <tt>rhonom</tt>).</li>
<li><tt>FFtype = 2</tt>: the pressure drop is <tt>K</tt> times the kinetic pressure.</li></ul>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_PressDrop_FFtypes.html#ThermoPower.Choices.PressDrop.FFtypes.Temp"
>Temp</A></TD><TD>FFtype</TD><TD>FFtypes.Kf</TD><TD>Friction Factor Type</TD></TR>
<TR><TD>Real</TD><TD>Kf</TD><TD>0</TD><TD>Hydraulic resistance coefficient [Pa.kg/m^3/(kg/s)^2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>0</TD><TD>Nominal pressure drop [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>0</TD><TD>Nominal density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>K</TD><TD>0</TD><TD>Kinetic resistance coefficient (DP=K*rho*velocity^2/2)</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>0</TD><TD>Cross-section [m2]</TD></TR>
<TR><TD>Real</TD><TD>wnf</TD><TD>0.01</TD><TD>Fraction of nominal flow rate at which linear friction equals turbulent friction</TD></TR>
<TR><TD>Real</TD><TD>Kfc</TD><TD>1</TD><TD>Friction factor correction coefficient</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> PressDrop <font color="darkgreen">&quot;Pressure drop for water/steam flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.PressDrop"
>Icons.Water.PressDrop</A>;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_PressDrop_FFtypes.html#ThermoPower.Choices.PressDrop.FFtypes"
>ThermoPower.Choices.PressDrop.FFtypes</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  Medium.BaseProperties fluid;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wnom <font color="darkgreen">&quot;Nominal mass flowrate&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_PressDrop_FFtypes.html#ThermoPower.Choices.PressDrop.FFtypes.Temp"
>FFtypes.Temp</A> FFtype=FFtypes.Kf <font color="darkgreen">&quot;Friction Factor Type&quot;</font>;
  <font color="blue">parameter </font>Real Kf(fixed = <font color="blue">if </font>FFtype==FFtypes.Kf<font color="blue"> then </font>true<font color="blue"> else </font>false,
     unit = &quot;Pa.kg/m^3/(kg/s)^2&quot;)=0 <font color="darkgreen">&quot;Hydraulic resistance coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> dpnom=0 <font color="darkgreen">&quot;Nominal pressure drop&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A> rhonom=0 <font color="darkgreen">&quot;Nominal density&quot;</font>;
  <font color="blue">parameter </font>Real K=0 <font color="darkgreen">&quot;Kinetic resistance coefficient (DP=K*rho*velocity^2/2)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> A=0 <font color="darkgreen">&quot;Cross-section&quot;</font>;
  <font color="blue">parameter </font>Real wnf=0.01 <font color="darkgreen">
    &quot;Fraction of nominal flow rate at which linear friction equals turbulent friction&quot;</font>;
  <font color="blue">parameter </font>Real Kfc=1 <font color="darkgreen">&quot;Friction factor correction coefficient&quot;</font>;
<font color="blue">protected </font>
  <font color="blue">parameter </font>Real Kfl(fixed = false) <font color="darkgreen">&quot;Linear friction coefficient&quot;</font>;
<font color="blue">public </font>
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Medium.Density</A> rho <font color="darkgreen">&quot;Fluid density&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> inlet(w(start=wnom),<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> outlet(w(start=-wnom),<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="darkgreen">// Set Kf if FFtype &lt;&gt; FFtypes.Kf</font>
  <font color="blue">if </font>FFtype == FFtypes.OpPoint<font color="blue"> then</font>
    Kf = dpnom*rhonom/wnom^2*Kfc;
  <font color="blue">elseif </font>FFtype == FFtypes.Kinetic<font color="blue"> then</font>
    Kf = K/(2*A^2)*Kfc;
  <font color="blue">end if</font>;
  Kfl = wnom*wnf*Kf <font color="darkgreen">&quot;Linear friction factor&quot;</font>;
<font color="blue">equation </font>
  <font color="darkgreen">// Fluid properties</font>
  <font color="blue">if </font>inlet.w&gt;=0<font color="blue"> then</font>
    fluid.p=inlet.p;
    fluid.h=inlet.hBA;
  <font color="blue">else</font>
    fluid.p=outlet.p;
    fluid.h=outlet.hAB;
  <font color="blue">end if</font>;
  rho = fluid.d <font color="darkgreen">&quot;Fluid density&quot;</font>;
  inlet.p - outlet.p =<font color="red"> noEvent</font>(Kf*<font color="red">abs</font>(inlet.w) + Kfl)*inlet.w/rho <font color="darkgreen">
    &quot;Flow characteristics&quot;</font>;
  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass  balance&quot;</font>;
  <font color="darkgreen">// Energy balance</font>
  inlet.hAB = outlet.hAB;
  inlet.hBA = outlet.hBA;
<font color="blue">end </font>PressDrop;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Header<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.HeaderI.png" ALT="ThermoPower.Water.Header" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Header"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Header</H2>
<B>Header with metal walls for water/steam flows</B><p>
<IMG SRC="ThermoPower.Water.HeaderD.png" ALT="ThermoPower.Water.Header">
<H3>Information</H3>
<PRE></pre>
<p>This model describes a constant volume header with metal walls. The fluid can be water, steam, or a two-phase mixture.
<p>It is possible to take into account the heat storage and transfer in the metal wall in two ways:
<ul>
<li>
  Leave <tt>InternalSurface</tt> unconnected, and set the appropriate
  values for the total wall heat capacity <tt>Cm</tt>, surface <tt>S</tt>
  and heat transfer coefficient <tt>gamma</tt>. In this case, the metal
  wall temperature is considered as uniform, and the wall is thermally
  insulated from the outside.
</li>
<li>
  Set <tt>Cm = 0</tt>, and connect a suitable thermal model of the the
  wall to the <tt>InternalSurface</tt> connector instead. This can be
  useful in case a more detailed thermal model is needed, e.g. for
  thermal stress studies.
</li>
</ul>
<p>The model can represent an actual header when connected to the model of a bank of tubes (e.g., <tt>Flow1D</tt> with <tt>Nt>1</tt>).</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V</TD><TD>&nbsp;</TD><TD>Inner volume [m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>S</TD><TD>0</TD><TD>Internal surface [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A></TD><TD>H</TD><TD>0</TD><TD>Elevation of outlet over inlet [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>gamma</TD><TD>0</TD><TD>Heat Transfer Coefficient [W/(m2.K)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>HeatCapacity</A></TD><TD>Cm</TD><TD>0</TD><TD>Metal Heat Capacity [J/K]</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>HT</A></TD><TD>thermalPort</TD><TD>redeclare Thermal.HT thermal...</TD><TD>Internal surface of metal wall</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartin</TD><TD>1.01325e5</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartout</TD><TD>1.01325e5</TD><TD>Outlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart</TD><TD>1e5</TD><TD>Specific enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tmstart</TD><TD>300</TD><TD>Metal wall start temperature [K]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>HT</A></TD><TD>thermalPort</TD><TD>Internal surface of metal wall</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Header <font color="darkgreen">&quot;Header with metal walls for water/steam flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.Header"
>Icons.Water.Header</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  Medium.BaseProperties fluid(p(start=pstartout),h(start=hstart));
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> V <font color="darkgreen">&quot;Inner volume&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> S=0 <font color="darkgreen">&quot;Internal surface&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A> H=0 <font color="darkgreen">&quot;Elevation of outlet over inlet&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma=0 <font color="darkgreen">&quot;Heat Transfer Coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>HeatCapacity</A> Cm=0 <font color="darkgreen">&quot;Metal Heat Capacity&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstartin=1.01325e5 <font color="darkgreen">&quot;Inlet pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstartout=1.01325e5 <font color="darkgreen">&quot;Outlet pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hstart=1e5 <font color="darkgreen">&quot;Specific enthalpy start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tmstart=300 <font color="darkgreen">&quot;Metal wall start temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Choices.Init.Options.Temp</A> initOpt=Choices.Init.Options.noInit <font color="darkgreen">
    &quot;Initialisation option&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> inlet(p(start=pstartin), hAB(start=hstart),
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> outlet(p(start=pstartout), hBA(start=hstart),
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> p(start=pstartout, stateSelect=<font color="blue">if </font>Medium.singleState<font color="blue"> then </font>
             StateSelect.avoid<font color="blue"> else </font>StateSelect.prefer) <font color="darkgreen">
    &quot;Fluid pressure at the outlet&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> h(start=hstart, stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;Fluid specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hi;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> ho;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> M <font color="darkgreen">&quot;Fluid mass&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Energy"
>Energy</A> E <font color="darkgreen">&quot;Fluid energy&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> T <font color="darkgreen">&quot;Fluid temperature&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tm(start=Tmstart) <font color="darkgreen">&quot;Wall temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A> Tr <font color="darkgreen">&quot;Residence time&quot;</font>;
  <font color="blue">replaceable </font><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>Thermal.HT</A> thermalPort <font color="darkgreen">&quot;Internal surface of metal wall&quot;</font>;
<font color="blue">equation </font>
  <font color="darkgreen">// Set fluid properties</font>
  fluid.p=p;
  fluid.h=h;
  fluid.T=T;

  M=fluid.d*V <font color="darkgreen">&quot;Fluid mass&quot;</font>;
  E=M*fluid.u <font color="darkgreen">&quot;Fluid energy&quot;</font>;
  <font color="red">der</font>(M) = inlet.w + outlet.w <font color="darkgreen">&quot;Fluid mass balance&quot;</font>;
  <font color="red">der</font>(E)= inlet.w*hi + outlet.w*ho + gamma*S*(Tm - T) +
          thermalPort.Q_flow <font color="darkgreen">&quot;Fluid energy balance&quot;</font>;
  <font color="blue">if </font>Cm &gt; 0<font color="blue"> and </font>gamma &gt;0<font color="blue"> then</font>
    Cm*<font color="red">der</font>(Tm) =  gamma*S*(T - Tm) <font color="darkgreen">&quot;Energy balance of the built-in wall model&quot;</font>;
  <font color="blue">else</font>
    Tm = T <font color="darkgreen">&quot;Trivial equation for metal temperature&quot;</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Boundary conditions</font>
  hi = <font color="blue">if </font>inlet.w &gt;= 0<font color="blue"> then </font>inlet.hBA<font color="blue"> else </font>h;
  ho = <font color="blue">if </font>outlet.w &gt;= 0<font color="blue"> then </font>outlet.hAB<font color="blue"> else </font>h;
  inlet.hAB = h;
  outlet.hBA = h;
  inlet.p = p+fluid.d*Modelica.Constants.g_n*H;
  outlet.p = p;
  thermalPort.T = T;

  Tr=<font color="red">noEvent</font>(M/<font color="red">max</font>(inlet.w,Modelica.Constants.eps)) <font color="darkgreen">&quot;Residence time&quot;</font>;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="darkgreen">// Initial conditions</font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="red">der</font>(fluid.h) = 0;
    <font color="blue">if </font>(<font color="blue">not </font>Medium.singleState)<font color="blue"> then</font>
      <font color="red">der</font>(fluid.p) = 0;
    <font color="blue">end if</font>;
    <font color="blue">if </font>(Cm &gt; 0<font color="blue"> and </font>gamma &gt;0)<font color="blue"> then</font>
      <font color="red">der</font>(Tm) = 0;
    <font color="blue">end if</font>;
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyStateNoP<font color="blue"> then</font>
    <font color="red">der</font>(fluid.h) = 0;
    <font color="blue">if </font>(Cm &gt; 0<font color="blue"> and </font>gamma &gt;0)<font color="blue"> then</font>
      <font color="red">der</font>(Tm) = 0;
    <font color="blue">end if</font>;
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;
<font color="blue">end </font>Header;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Mixer<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.MixerI.png" ALT="ThermoPower.Water.Mixer" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Mixer"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Mixer</H2>
<B>Mixer with metal walls for water/steam flows</B><p>
<IMG SRC="ThermoPower.Water.MixerD.png" ALT="ThermoPower.Water.Mixer">
<H3>Information</H3>
<PRE></pre>
<p>This model describes a constant volume mixer with metal walls. The fluid can be water, steam, or a two-phase mixture. The metal wall temperature and the heat transfer coefficient between the wall and the fluid are uniform. The wall is thermally insulated from the outside.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V</TD><TD>&nbsp;</TD><TD>Internal volume [m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>S</TD><TD>0</TD><TD>Internal surface [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>gamma</TD><TD>0</TD><TD>Internal Heat Transfer Coefficient [W/(m2.K)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>HeatCapacity</A></TD><TD>Cm</TD><TD>0</TD><TD>Metal Heat Capacity [J/K]</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>HT</A></TD><TD>thermalPort</TD><TD>redeclare Thermal.HT thermal...</TD><TD>Internal surface of metal wall</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>1e5</TD><TD>Pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Enthalpy"
>Enthalpy</A></TD><TD>hstart</TD><TD>1e5</TD><TD>Enthalpy start value [J]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tmstart</TD><TD>300</TD><TD>Wall temperature start value [K]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>in1</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>in2</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>out</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>HT</A></TD><TD>thermalPort</TD><TD>Internal surface of metal wall</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Mixer <font color="darkgreen">&quot;Mixer with metal walls for water/steam flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.Mixer"
>Icons.Water.Mixer</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  Medium.BaseProperties fluid(p(start=pstart), h(start=hstart)) <font color="darkgreen">
    &quot;Fluid properties&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> V <font color="darkgreen">&quot;Internal volume&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> S=0 <font color="darkgreen">&quot;Internal surface&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma=0 <font color="darkgreen">
    &quot;Internal Heat Transfer Coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>HeatCapacity</A> Cm=0 <font color="darkgreen">&quot;Metal Heat Capacity&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstart=1e5 <font color="darkgreen">&quot;Pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Enthalpy"
>Enthalpy</A> hstart=1e5 <font color="darkgreen">&quot;Enthalpy start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tmstart=300 <font color="darkgreen">&quot;Wall temperature start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Choices.Init.Options.Temp</A> initOpt=Choices.Init.Options.noInit <font color="darkgreen">
    &quot;Initialisation option&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> in1(p(start=pstart), hAB(start=hstart),<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> in2(p(start=pstart), hAB(start=hstart),<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> out(p(start=pstart), hBA(start=hstart),<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p(start=pstart, stateSelect=<font color="blue">if </font>Medium.singleState<font color="blue"> then </font>
             StateSelect.avoid<font color="blue"> else </font>StateSelect.prefer) <font color="darkgreen">&quot;Fluid pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> h(start=hstart, stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;Fluid specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hi1 <font color="darkgreen">&quot;Inlet 1 specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hi2 <font color="darkgreen">&quot;Inlet 2 specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> ho <font color="darkgreen">&quot;Outlet specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> M <font color="darkgreen">&quot;Fluid mass&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Energy"
>Energy</A> E <font color="darkgreen">&quot;Fluid energy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>HeatFlowRate</A> Q <font color="darkgreen">&quot;Heat flow rate exchanged with the outside&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> T <font color="darkgreen">&quot;Fluid temperature&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tm(start=Tmstart) <font color="darkgreen">&quot;Wall temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A> Tr <font color="darkgreen">&quot;Residence time&quot;</font>;
  <font color="blue">replaceable </font><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.HT"
>Thermal.HT</A> thermalPort <font color="darkgreen">&quot;Internal surface of metal wall&quot;</font>;
<font color="blue">equation </font>
  <font color="darkgreen">// Set fluid properties</font>
  fluid.p=p;
  fluid.h=h;
  fluid.T=T;

  M=fluid.d*V <font color="darkgreen">&quot;Fluid mass&quot;</font>;
  E=M*fluid.u <font color="darkgreen">&quot;Fluid energy&quot;</font>;
  <font color="red">der</font>(M) = in1.w + in2.w + out.w <font color="darkgreen">&quot;Fluid mass balance&quot;</font>;
  <font color="red">der</font>(E) = in1.w*hi1 + in2.w*hi2 + out.w*ho - gamma*S*(T - Tm) + Q <font color="darkgreen">
    &quot;Fluid energy balance&quot;</font>;
  <font color="blue">if </font>Cm &gt; 0<font color="blue"> and </font>gamma &gt;0<font color="blue"> then</font>
    Cm*<font color="red">der</font>(Tm) = gamma*S*(T - Tm) <font color="darkgreen">&quot;Metal wall energy balance&quot;</font>;
  <font color="blue">else</font>
    Tm = T;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Boundary conditions</font>
  hi1 = <font color="blue">if </font>in1.w &gt;= 0<font color="blue"> then </font>in1.hBA<font color="blue"> else </font>h;
  hi2 = <font color="blue">if </font>in2.w &gt;= 0<font color="blue"> then </font>in2.hBA<font color="blue"> else </font>h;
  ho = <font color="blue">if </font>out.w &gt;= 0<font color="blue"> then </font>out.hAB<font color="blue"> else </font>h;
  in1.hAB = h;
  in2.hAB = h;
  out.hBA = h;
  in1.p = p;
  in2.p = p;
  out.p = p;
  thermalPort.Q_flow = Q;
  thermalPort.T = T;

  Tr=<font color="red">noEvent</font>(M/<font color="red">max</font>(-out.w,Modelica.Constants.eps)) <font color="darkgreen">&quot;Residence time&quot;</font>;

<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="red">der</font>(fluid.h) = 0;
    <font color="blue">if </font>(<font color="blue">not </font>Medium.singleState)<font color="blue"> then</font>
      <font color="red">der</font>(fluid.p) = 0;
    <font color="blue">end if</font>;
    <font color="blue">if </font>(Cm &gt; 0<font color="blue"> and </font>gamma &gt;0)<font color="blue"> then</font>
      <font color="red">der</font>(Tm) = 0;
    <font color="blue">end if</font>;
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyStateNoP<font color="blue"> then</font>
    <font color="red">der</font>(fluid.h) = 0;
    <font color="blue">if </font>(Cm &gt; 0<font color="blue"> and </font>gamma &gt;0)<font color="blue"> then</font>
      <font color="red">der</font>(Tm) = 0;
    <font color="blue">end if</font>;
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;

<font color="blue">end </font>Mixer;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Tank<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.TankI.png" ALT="ThermoPower.Water.Tank" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Tank"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Tank</H2>
<B>Open tank with free surface</B><p>
<IMG SRC="ThermoPower.Water.TankD.png" ALT="ThermoPower.Water.Tank">
<H3>Information</H3>
<PRE></pre>
<p>This model describes a simple free-surface cylindrical water tank. The model is based on mass and energy balances, assuming that no heat transfer takes place except through the inlet and outlet flows.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Cross-sectional area [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V0</TD><TD>0</TD><TD>Volume at zero level [m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pext</TD><TD>1.01325e5</TD><TD>Surface pressure [Pa]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>ystart</TD><TD>&nbsp;</TD><TD>Start level [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart</TD><TD>1e5</TD><TD>[J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Tank <font color="darkgreen">&quot;Open tank with free surface&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.Tank"
>Icons.Water.Tank</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  Medium.BaseProperties liquid(p(start=pext),h(start=hstart)) <font color="darkgreen">
    &quot;Liquid properties&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> A <font color="darkgreen">&quot;Cross-sectional area&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> V0=0 <font color="darkgreen">&quot;Volume at zero level&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pext=1.01325e5 <font color="darkgreen">&quot;Surface pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> ystart <font color="darkgreen">&quot;Start level&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hstart=1e5;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> y(start=ystart, stateSelect=StateSelect.prefer) <font color="darkgreen">&quot;Level&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> V <font color="darkgreen">&quot;Liquid volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> M <font color="darkgreen">&quot;Liquid mass&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Enthalpy"
>Enthalpy</A> H <font color="darkgreen">&quot;Liquid (total) enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> h(start=hstart, stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;Liquid specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hin;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hout;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p(start=pext) <font color="darkgreen">&quot;Bottom pressure&quot;</font>;
  <font color="blue">constant </font>Real g=Modelica.Constants.g_n;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium=Medium);
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Choices.Init.Options.Temp</A> initOpt=Choices.Init.Options.noInit <font color="darkgreen">
    &quot;Initialisation option&quot;</font>;
<font color="blue">equation </font>
  <font color="darkgreen">// Set liquid properties</font>
  liquid.p=pext;
  liquid.h=h;

  V=V0+A*y <font color="darkgreen">&quot;Liquid volume&quot;</font>;
  M=liquid.d*V <font color="darkgreen">&quot;Liquid mass&quot;</font>;
  H=M*liquid.h <font color="darkgreen">&quot;Liquid enthalpy&quot;</font>;
  <font color="red">der</font>(M)= inlet.w + outlet.w <font color="darkgreen">&quot;Mass balance&quot;</font>;
  <font color="red">der</font>(H) = inlet.w*hin+ outlet.w*hout <font color="darkgreen">&quot;Energy balance&quot;</font>;
  p - pext = liquid.d*g*y <font color="darkgreen">&quot;Stevino's law&quot;</font>;

  <font color="darkgreen">// Boundary conditions</font>
  hin = <font color="blue">if </font>inlet.w &gt;= 0<font color="blue"> then </font>inlet.hBA<font color="blue"> else </font>h;
  hout = <font color="blue">if </font>outlet.w &gt;= 0<font color="blue"> then </font>outlet.hAB<font color="blue"> else </font>h;
  inlet.hAB = h;
  outlet.hBA = h;
  inlet.p = p;
  outlet.p = p;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="red">der</font>(liquid.h) = 0;
    <font color="red">der</font>(y) = 0;
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;

<font color="blue">end </font>Tank;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Flow1DBase<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.Flow1DBaseI.png" ALT="ThermoPower.Water.Flow1DBase" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Flow1DBase"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Flow1DBase</H2>
<B>Basic interface for 1-dimensional water/steam fluid flow models</B><p>
<IMG SRC="ThermoPower.Water.Flow1DBaseD.png" ALT="ThermoPower.Water.Flow1DBase">
<H3>Information</H3>
<PRE></pre>
Basic interface of the <tt>Flow1D</tt> models, containing the common parameters and connectors.
<pre>
</PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>2</TD><TD>Number of nodes for thermal variables</TD></TR>
<TR><TD>Integer</TD><TD>Nt</TD><TD>1</TD><TD>Number of tubes in parallel</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Distance"
>Distance</A></TD><TD>L</TD><TD>&nbsp;</TD><TD>Tube length [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A></TD><TD>H</TD><TD>0</TD><TD>Elevation of outlet over inlet [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Cross-sectional area (single tube) [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>omega</TD><TD>&nbsp;</TD><TD>Perimeter of heat transfer surface (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>Dhyd</TD><TD>&nbsp;</TD><TD>Hydraulic Diameter (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate (total) [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes.Temp"
>Temp</A></TD><TD>FFtype</TD><TD>&nbsp;</TD><TD>Friction Factor Type</TD></TR>
<TR><TD>Real</TD><TD>Kfnom</TD><TD>0</TD><TD>Nominal hydraulic resistance coefficient [Pa.kg/m^3/(kg/s)^2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>0</TD><TD>Nominal pressure drop (friction term only!) [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>0</TD><TD>Nominal inlet density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>Cfnom</TD><TD>0</TD><TD>Nominal Fanning friction factor</TD></TR>
<TR><TD>Real</TD><TD>e</TD><TD>0</TD><TD>Relative roughness (ratio roughness/diameter)</TD></TR>
<TR><TD>Boolean</TD><TD>DynamicMomentum</TD><TD>false</TD><TD>Inertial phenomena accounted for</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_HCtypes.html#ThermoPower.Choices.Flow1D.HCtypes.Temp"
>Temp</A></TD><TD>HydraulicCapacitance</TD><TD>HCtypes.Downstream</TD><TD>Location of the hydraulic capacitance</TD></TR>
<TR><TD>Boolean</TD><TD>avoidInletEnthalpyDerivative</TD><TD>true</TD><TD>Avoid inlet enthalpy derivative</TD></TR>
<TR><TD>Real</TD><TD>wnf</TD><TD>0.01</TD><TD>Fraction of nominal flow rate at which linear friction equals turbulent friction</TD></TR>
<TR><TD>Real</TD><TD>Kfc</TD><TD>1</TD><TD>Friction factor correction coefficient</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHT"
>DHT</A></TD><TD>wall</TD><TD>redeclare ThermoPower.Therma...</TD><TD>&nbsp;</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartin</TD><TD>1e5</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartout</TD><TD>1e5</TD><TD>Outlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartin</TD><TD>1e5</TD><TD>Inlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartout</TD><TD>1e5</TD><TD>Outlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart[N]</TD><TD>linspace(hstartin, hstartout...</TD><TD>Start value of enthalpy vector (initialized by default) [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHT"
>DHT</A></TD><TD>wall</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> Flow1DBase <font color="darkgreen">
  &quot;Basic interface for 1-dimensional water/steam fluid flow models&quot;</font>
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.Tube"
>Icons.Water.Tube</A>;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes"
>ThermoPower.Choices.Flow1D.FFtypes</A>;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_Flow1D_HCtypes.html#ThermoPower.Choices.Flow1D.HCtypes"
>ThermoPower.Choices.Flow1D.HCtypes</A>;
  <font color="blue">parameter </font>Integer N(min=2) = 2 <font color="darkgreen">&quot;Number of nodes for thermal variables&quot;</font>;
  <font color="blue">parameter </font>Integer Nt=1 <font color="darkgreen">&quot;Number of tubes in parallel&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Distance"
>Distance</A> L <font color="darkgreen">&quot;Tube length&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A> H=0 <font color="darkgreen">&quot;Elevation of outlet over inlet&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> A <font color="darkgreen">&quot;Cross-sectional area (single tube)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> omega <font color="darkgreen">&quot;Perimeter of heat transfer surface (single tube)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> Dhyd <font color="darkgreen">&quot;Hydraulic Diameter (single tube)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wnom <font color="darkgreen">&quot;Nominal mass flowrate (total)&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes.Temp"
>FFtypes.Temp</A> FFtype <font color="darkgreen">&quot;Friction Factor Type&quot;</font>;
  <font color="blue">parameter </font>Real Kfnom(unit = &quot;Pa.kg/m^3/(kg/s)^2&quot;, min=0)=0 <font color="darkgreen">
    &quot;Nominal hydraulic resistance coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> dpnom=0 <font color="darkgreen">&quot;Nominal pressure drop (friction term only!)&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A> rhonom=0 <font color="darkgreen">&quot;Nominal inlet density&quot;</font>;
  <font color="blue">parameter </font>Real Cfnom=0 <font color="darkgreen">&quot;Nominal Fanning friction factor&quot;</font>;
  <font color="blue">parameter </font>Real e=0 <font color="darkgreen">&quot;Relative roughness (ratio roughness/diameter)&quot;</font>;
  <font color="blue">parameter </font>Boolean DynamicMomentum=false <font color="darkgreen">&quot;Inertial phenomena accounted for&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Flow1D_HCtypes.html#ThermoPower.Choices.Flow1D.HCtypes.Temp"
>HCtypes.Temp</A> HydraulicCapacitance = HCtypes.Downstream <font color="darkgreen">
    &quot;Location of the hydraulic capacitance&quot;</font>;
  <font color="blue">parameter </font>Boolean avoidInletEnthalpyDerivative = true <font color="darkgreen">
    &quot;Avoid inlet enthalpy derivative&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstartin=1e5 <font color="darkgreen">&quot;Inlet pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstartout=1e5 <font color="darkgreen">&quot;Outlet pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hstartin=1e5 <font color="darkgreen">&quot;Inlet enthalpy start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hstartout=1e5 <font color="darkgreen">&quot;Outlet enthalpy start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hstart[N] =<font color="red"> linspace</font>(hstartin, hstartout, N) <font color="darkgreen">
    &quot;Start value of enthalpy vector (initialized by default)&quot;</font>;
  <font color="blue">parameter </font>Real wnf=0.01 <font color="darkgreen">
    &quot;Fraction of nominal flow rate at which linear friction equals turbulent friction&quot;</font>;
  <font color="blue">parameter </font>Real Kfc=1 <font color="darkgreen">&quot;Friction factor correction coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Choices.Init.Options.Temp</A> initOpt=Choices.Init.Options.noInit <font color="darkgreen">
    &quot;Initialisation option&quot;</font>;
  <font color="blue">constant </font>Real g=Modelica.Constants.g_n;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> infl(p(start=pstartin),w(start=wnom),hAB(start=hstartin),
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> outfl(p(start=pstartout),w(start=-wnom),hBA(start=hstartout),
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <font color="blue">replaceable </font><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHT"
>ThermoPower.Thermal.DHT</A> wall(N=N);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> Q <font color="darkgreen">&quot;Total heat flow through the lateral boundary (all Nt tubes)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A> Tr <font color="darkgreen">&quot;Residence time&quot;</font>;
<font color="blue">protected </font>
  <font color="blue">parameter </font>Real dzdx = H/L <font color="darkgreen">&quot;Slope&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> l = L/(N - 1) <font color="darkgreen">&quot;Length of a single volume&quot;</font>;

<font color="blue">end </font>Flow1DBase;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Flow1D<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.Flow1DBaseI.png" ALT="ThermoPower.Water.Flow1D" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Flow1D"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Flow1D</H2>
<B>1-dimensional fluid flow model for water/steam (finite volumes)</B><p>
<IMG SRC="ThermoPower.Water.Flow1DBaseD.png" ALT="ThermoPower.Water.Flow1D">
<H3>Information</H3>
<PRE></pre>
<p>This model describes the flow of water or steam in a rigid tube. The basic modelling assumptions are:
<ul><li>The fluid state is always one-phase (i.e. subcooled liquid or superheated steam).
<li>Uniform velocity is assumed on the cross section, leading to a 1-D distributed parameter model.
<li>Turbulent friction is always assumed; a small linear term is added to avoid numerical singularities at zero flowrate. The friction effects are not accurately computed in the laminar and transitional flow regimes, which however should not be an issue in most applications using water or steam as a working fluid.
<li>The model is based on dynamic mass, momentum, and energy balances. The dynamic momentum term can be switched off, to avoid the fast oscillations that can arise from its coupling with the mass balance (sound wave dynamics).
<li>The longitudinal heat diffusion term is neglected.
<li>The energy balance equation is written by assuming a uniform pressure distribution; the compressibility effects are lumped at the inlet, at the outlet, or at the middle of the pipe.
<li>The fluid flow can exchange thermal power through the lateral surface, which is represented by the <tt>wall</tt> connector. The actual heat flux must be computed by a connected component (heat transfer computation module).
</ul>
<p>The mass, momentum and energy balance equation are discretised with the finite volume method. The state variables are one pressure, one flowrate (optional) and N-1 specific enthalpies.
<p>The turbulent friction factor can be either assumed as a constant, or computed by Colebrook's equation. In the former case, the friction factor can be supplied directly, or given implicitly by a specified operating point. In any case, the multiplicative correction coefficient <tt>Kfc</tt> can be used to modify the friction coefficient, e.g. to fit experimental data.
<p>A small linear pressure drop is added to avoid numerical singularities at low or zero flowrate. The <tt>wnom</tt> parameter must be always specified: the additional linear pressure drop is such that it is equal to the turbulent pressure drop when the flowrate is equal to <tt>wnf*wnom</tt> (the default value is 1% of the nominal flowrate). Increase <tt>wnf</tt> if numerical instabilities occur in tubes with very low pressure drops.
<p>Flow reversal is fully supported.
<p><b>Modelling options</b></p>
<p>Thermal variables (enthalpy, temperature, density) are computed in <tt>N</tt> equally spaced nodes, including the inlet (node 1) and the outlet (node N); <tt>N</tt> must be greater than or equal to 2.
<p>The following options are available to specify the friction coefficient:
<ul><li><tt>FFtype = FFtypes.Kfnom</tt>: the hydraulic friction coefficient <tt>Kf</tt> is set directly to <tt>Kfnom</tt>.
<li><tt>FFtype = FFtypes.OpPoint</tt>: the hydraulic friction coefficient is specified by a nominal operating point (<tt>wnom</tt>,<tt>dpnom</tt>, <tt>rhonom</tt>).
<li><tt>FFtype = FFtypes.Cfnom</tt>: the friction coefficient is computed by giving the (constant) value of the Fanning friction factor <tt>Cfnom</tt>.
<li><tt>FFtype = FFtypes.Colebrook</tt>: the Fanning friction factor is computed by Colebrook's equation (assuming Re > 2100, e.g. turbulent flow).
<li><tt>FFtype = FFtypes.NoFriction</tt>: no friction is assumed across the pipe.</ul>
<p>The dynamic momentum term is included or neglected depending on the <tt>DynamicMomentum</tt> parameter.
<p>If <tt>HydraulicCapacitance = HCtypes.Downstream</tt> (default option) then the compressibility effect depending on the pressure derivative is lumped at the outlet, while the optional dynamic momentum term depending on the flowrate is lumped at the inlet; therefore, the state variables are the outlet pressure and the inlet flowrate. If <tt>HydraulicCapacitance = HCtypes.Upstream</tt> the reverse takes place.
 If <tt>HydraulicCapacitance = HCtypes.Middle</tt>, the compressibility effect is lumped at the middle of the pipe; to use this option, an odd number of nodes N is required.
<p>Start values for the pressure and flowrate state variables are specified by <tt>pstart</tt>, <tt>wstart</tt>. The start values for the node enthalpies are linearly distributed from <tt>hstartin</tt> at the inlet to <tt>hstartout</tt> at the outlet.
<p>A bank of <tt>Nt</tt> identical tubes working in parallel can be modelled by setting <tt>Nt > 1</tt>. The geometric parameters always refer to a <i>single</i> tube.
<p>This models makes the temperature and external heat flow distributions available to connected components through the <tt>wall</tt> connector. If other variables (e.g. the heat transfer coefficient) are needed by external components to compute the actual heat flow, the <tt>wall</tt> connector can be replaced by an extended version of the <tt>DHT</tt> connector.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>StandardWater</TD><TD>Medium model</TD></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>2</TD><TD>Number of nodes for thermal variables</TD></TR>
<TR><TD>Integer</TD><TD>Nt</TD><TD>1</TD><TD>Number of tubes in parallel</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Distance"
>Distance</A></TD><TD>L</TD><TD>&nbsp;</TD><TD>Tube length [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A></TD><TD>H</TD><TD>0</TD><TD>Elevation of outlet over inlet [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Cross-sectional area (single tube) [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>omega</TD><TD>&nbsp;</TD><TD>Perimeter of heat transfer surface (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>Dhyd</TD><TD>&nbsp;</TD><TD>Hydraulic Diameter (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate (total) [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes.Temp"
>Temp</A></TD><TD>FFtype</TD><TD>&nbsp;</TD><TD>Friction Factor Type</TD></TR>
<TR><TD>Real</TD><TD>Kfnom</TD><TD>0</TD><TD>Nominal hydraulic resistance coefficient [Pa.kg/m^3/(kg/s)^2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>0</TD><TD>Nominal pressure drop (friction term only!) [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>0</TD><TD>Nominal inlet density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>Cfnom</TD><TD>0</TD><TD>Nominal Fanning friction factor</TD></TR>
<TR><TD>Real</TD><TD>e</TD><TD>0</TD><TD>Relative roughness (ratio roughness/diameter)</TD></TR>
<TR><TD>Boolean</TD><TD>DynamicMomentum</TD><TD>false</TD><TD>Inertial phenomena accounted for</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_HCtypes.html#ThermoPower.Choices.Flow1D.HCtypes.Temp"
>Temp</A></TD><TD>HydraulicCapacitance</TD><TD>HCtypes.Downstream</TD><TD>Location of the hydraulic capacitance</TD></TR>
<TR><TD>Boolean</TD><TD>avoidInletEnthalpyDerivative</TD><TD>true</TD><TD>Avoid inlet enthalpy derivative</TD></TR>
<TR><TD>Real</TD><TD>wnf</TD><TD>0.01</TD><TD>Fraction of nominal flow rate at which linear friction equals turbulent friction</TD></TR>
<TR><TD>Real</TD><TD>Kfc</TD><TD>1</TD><TD>Friction factor correction coefficient</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHT"
>DHT</A></TD><TD>wall</TD><TD>redeclare ThermoPower.Therma...</TD><TD>&nbsp;</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartin</TD><TD>1e5</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartout</TD><TD>1e5</TD><TD>Outlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartin</TD><TD>1e5</TD><TD>Inlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartout</TD><TD>1e5</TD><TD>Outlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart[N]</TD><TD>linspace(hstartin, hstartout...</TD><TD>Start value of enthalpy vector (initialized by default) [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHT"
>DHT</A></TD><TD>wall</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Flow1D <font color="darkgreen">
  &quot;1-dimensional fluid flow model for water/steam (finite volumes)&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1DBase"
>Flow1DBase</A>;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes"
>ThermoPower.Choices.Flow1D.FFtypes</A>;
  Medium.BaseProperties fluid[N](<font color="blue">each </font>p(start=pstartin),
    h(start=hstart)) <font color="darkgreen">&quot;Properties of the fluid at the nodes&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> omega_hyd <font color="darkgreen">&quot;Wet perimeter (single tube)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> Dpfric <font color="darkgreen">&quot;Pressure drop due to friction (total)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> Dpfric1 <font color="darkgreen">&quot;Pressure drop due to friction (from inlet to capacitance)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> Dpfric2 <font color="darkgreen">&quot;Pressure drop due to friction (from capacitance to outlet)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> Dpstat <font color="darkgreen">&quot;Pressure drop due to static head&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> win <font color="darkgreen">&quot;Flow rate at the inlet (single tube)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wout <font color="darkgreen">&quot;Flow rate at the outlet (single tube)&quot;</font>;
  Real Kf <font color="darkgreen">&quot;Hydraulic friction coefficient&quot;</font>;
  Real Kfl <font color="darkgreen">&quot;Linear friction coefficient&quot;</font>;
  Real dwdt <font color="darkgreen">&quot;Dynamic momentum term&quot;</font>;
  Real Cf <font color="darkgreen">&quot;Fanning friction factor&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p(start=<font color="blue">if </font>HydraulicCapacitance==1<font color="blue"> then </font>pstartin<font color="blue"> else </font>
         pstartout) <font color="darkgreen">&quot;Fluid pressure for property calculations&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w(start=wnom/Nt) <font color="darkgreen">&quot;Mass flowrate (single tube)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wbar[N - 1](<font color="blue">each </font>start=wnom/Nt);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Velocity</A> u[N] <font color="darkgreen">&quot;Fluid velocity&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> T[N] <font color="darkgreen">&quot;Fluid temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> h[N](start=hstart) <font color="darkgreen">
    &quot;Fluid specific enthalpy at the nodes&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> htilde[N - 1](start=hstart[2:N]) <font color="darkgreen">
    &quot;Enthalpy state variables&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Medium.Density</A> rho[N] <font color="darkgreen">&quot;Fluid nodal density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> M <font color="darkgreen">&quot;Fluid mass&quot;</font>;
  Real dMdt[N - 1] <font color="darkgreen">&quot;Time derivative of mass in each cell between two nodes&quot;</font>;
<font color="blue">protected </font>
  <A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A> rhobar[N - 1] <font color="darkgreen">&quot;Fluid average density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificVolume"
>SpecificVolume</A> vbar[N - 1] <font color="darkgreen">&quot;Fluid average specific volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlux"
>HeatFlux</A> phibar[N - 1] <font color="darkgreen">&quot;Average heat flux&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByEnthalpy"
>DerDensityByEnthalpy</A> drdh[N] <font color="darkgreen">&quot;Derivative of density by enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByEnthalpy"
>DerDensityByEnthalpy</A> drbdh[N - 1] <font color="darkgreen">&quot;Derivative of average density by enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByPressure"
>DerDensityByPressure</A> drdp[N] <font color="darkgreen">&quot;Derivative of density by pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByPressure"
>DerDensityByPressure</A> drbdp[N - 1] <font color="darkgreen">&quot;Derivative of average density by pressure&quot;</font>;
<font color="blue">equation </font>
<font color="darkgreen">//All equations are referred to a single tube</font>
  <font color="darkgreen">// Friction factor selection</font>
  omega_hyd = 4*A/Dhyd;
  <font color="blue">if </font>FFtype == FFtypes.Kfnom<font color="blue"> then</font>
    Kf = Kfnom*Kfc;
    Cf = 2*Kf*A^3/(omega_hyd*L);
  <font color="blue">elseif </font>FFtype == FFtypes.OpPoint<font color="blue"> then</font>
    Kf = dpnom*rhonom/(wnom/Nt)^2*Kfc;
    Cf = 2*Kf*A^3/(omega_hyd*L);
  <font color="blue">elseif </font>FFtype == FFtypes.Cfnom<font color="blue"> then</font>
    Kf = Cfnom*omega_hyd*L/(2*A^3)*Kfc;
    Cf = Cfnom*Kfc;
  <font color="blue">elseif </font>FFtype == FFtypes.Colebrook<font color="blue"> then</font>
    Cf =<font color="red"> f_colebrook</font>(w, Dhyd/A, e,
         <font color="red">Medium.dynamicViscosity</font>(fluid[<font color="red">integer</font>(N/2)].state))*Kfc;
    Kf = Cf*omega_hyd*L/(2*A^3);
  <font color="blue">elseif </font>FFtype == FFtypes.NoFriction<font color="blue"> then</font>
    Cf = 0;
    Kf = 0;
  <font color="blue">end if</font>;
  <font color="red">assert</font>(Kf&gt;=0, &quot;Negative friction coefficient&quot;);
  Kfl = wnom/Nt*wnf*Kf <font color="darkgreen">&quot;Linear friction factor&quot;</font>;

  <font color="darkgreen">// Dynamic momentum term</font>
  <font color="blue">if </font>DynamicMomentum<font color="blue"> then</font>
    dwdt =<font color="red"> der</font>(w);
  <font color="blue">else</font>
    dwdt = 0;
  <font color="blue">end if</font>;

  <font color="red">sum</font>(dMdt) = (infl.w + outfl.w)/Nt <font color="darkgreen">&quot;Mass balance&quot;</font>;
  L/A*dwdt + (outfl.p - infl.p) + Dpstat + Dpfric = 0 <font color="darkgreen">&quot;Momentum balance&quot;</font>;
  Dpfric = Dpfric1 + Dpfric2 <font color="darkgreen">&quot;Total pressure drop due to friction&quot;</font>;
  <font color="blue">if </font>FFtype == FFtypes.NoFriction<font color="blue"> then</font>
    Dpfric1 = 0;
    Dpfric2 = 0;
  <font color="blue">elseif </font>HydraulicCapacitance == 0<font color="blue"> then</font>
    <font color="red">assert</font>((N-1)-<font color="red">integer</font>((N-1)/2)*2 == 0, &quot;N must be odd&quot;);
    Dpfric1 =<font color="red"> noEvent</font>(Kf*<font color="red">abs</font>(win)  + Kfl)*win*<font color="red"> sum</font>(vbar[1:<font color="red">integer</font>((N-1)/2)])/(N-1) <font color="darkgreen">
      &quot;Pressure drop from inlet to capacitance&quot;</font>;
    Dpfric2 =<font color="red"> noEvent</font>(Kf*<font color="red">abs</font>(wout) + Kfl)*wout*<font color="red">sum</font>(vbar[1+<font color="red">integer</font>((N-1)/2):N-1])/(N-1) <font color="darkgreen">
      &quot;Pressure drop from capacitance to outlet&quot;</font>;
  <font color="blue">elseif </font>HydraulicCapacitance == 1<font color="blue"> then</font>
    Dpfric1 = 0 <font color="darkgreen">&quot;Pressure drop from inlet to capacitance&quot;</font>;
    Dpfric2 =<font color="red"> noEvent</font>(Kf*<font color="red">abs</font>(wout) + Kfl)*wout*<font color="red">sum</font>(vbar)/(N - 1) <font color="darkgreen">
      &quot;Pressure drop from capacitance to outlet&quot;</font>;
  <font color="blue">elseif </font>HydraulicCapacitance == 2<font color="blue"> then</font>
    Dpfric1 =<font color="red"> noEvent</font>(Kf*<font color="red">abs</font>(win) + Kfl)*win*<font color="red">sum</font>(vbar)/(N - 1) <font color="darkgreen">
      &quot;Pressure drop from inlet to capacitance&quot;</font>;
    Dpfric2 = 0 <font color="darkgreen">&quot;Pressure drop from capacitance to outlet&quot;</font>;
  <font color="blue">else</font>
    <font color="red"> assert</font>(false, &quot;Unsupported HydraulicCapacitance option&quot;);
  <font color="blue">end if</font> <font color="darkgreen">&quot;Pressure drop due to friction&quot;</font>;
  Dpstat = <font color="blue">if </font><font color="red">abs</font>(dzdx)&lt;1e-6<font color="blue"> then </font>0<font color="blue"> else </font>g*l*dzdx*<font color="red">sum</font>(rhobar) <font color="darkgreen">
    &quot;Pressure drop due to static head&quot;</font>;
  <font color="blue">for </font>j<font color="blue"> in </font>1:N - 1<font color="blue"> loop</font>
    <font color="blue">if </font>Medium.singleState<font color="blue"> then</font>
      A*l*rhobar[j]*<font color="red">der</font>(htilde[j]) + wbar[j]*(h[j + 1] - h[j]) =
         l*omega*phibar[j] <font color="darkgreen">&quot;Energy balance (pressure effects neglected)&quot;</font>;
    <font color="blue">else</font>
      A*l*rhobar[j]*<font color="red">der</font>(htilde[j]) + wbar[j]*(h[j + 1] - h[j]) - A*l*<font color="red">der</font>(p) =
        l*omega*phibar[j] <font color="darkgreen">&quot;Energy balance&quot;</font>;
    <font color="blue">end if</font>;
    dMdt[j] = A*l*(drbdh[j]*<font color="red">der</font>(htilde[j]) + drbdp[j]*<font color="red">der</font>(p)) <font color="darkgreen">
      &quot;Mass derivative for each volume&quot;</font>;
    <font color="darkgreen">// Average volume quantities</font>
    rhobar[j] = (rho[j] + rho[j + 1])/2;
    drbdp[j] = (drdp[j] + drdp[j + 1])/2;
    drbdh[j] = (drdh[j] + drdh[j + 1])/2;
    vbar[j] = 1/rhobar[j];
    wbar[j] = infl.w/Nt -<font color="red"> sum</font>(dMdt[1:j - 1]) - dMdt[j]/2;
  <font color="blue">end for</font>;

  <font color="darkgreen">// Fluid property calculations</font>
  <font color="blue">for </font>j<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    fluid[j].p=p;
    fluid[j].h=h[j];
    T[j]=fluid[j].T;
    rho[j]=fluid[j].d;
    drdp[j]= <font color="blue">if </font>Medium.singleState<font color="blue"> then </font>0<font color="blue"> else </font>
            <font color="red">Medium.density_derp_h</font>(fluid[j].state);
    drdh[j]=<font color="red">Medium.density_derh_p</font>(fluid[j].state);
    u[j] = w/(rho[j]*A);
  <font color="blue">end for</font>;

  <font color="darkgreen">// Boundary conditions</font>
  win = infl.w/Nt;
  wout = -outfl.w/Nt;
  <font color="blue">if </font>HydraulicCapacitance == 0<font color="blue"> then</font>
    p = infl.p - Dpfric1 - Dpstat/2;
    w = win;
  <font color="blue">elseif </font>HydraulicCapacitance == 1<font color="blue"> then</font>
    p = infl.p;
    w = wout;
  <font color="blue">elseif </font>HydraulicCapacitance == 2<font color="blue"> then</font>
    p = outfl.p;
    w = win;
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported HydraulicCapacitance option&quot;);
  <font color="blue">end if</font>;
  infl.hAB = htilde[1];
  outfl.hBA = htilde[N - 1];

  h[1] = infl.hBA;
  h[2:N] = htilde;

  T = wall.T;
  phibar = (wall.phi[1:N - 1] + wall.phi[2:N])/2;

  Q = Nt*l*omega*<font color="red">sum</font>(phibar) <font color="darkgreen">&quot;Total heat flow through lateral boundary&quot;</font>;
  M=<font color="red">sum</font>(rhobar)*A*l <font color="darkgreen">&quot;Total fluid mass&quot;</font>;
  Tr=<font color="red">noEvent</font>(M/<font color="red">max</font>(infl.w/Nt,Modelica.Constants.eps)) <font color="darkgreen">&quot;Residence time&quot;</font>;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="red">der</font>(htilde) =<font color="red"> zeros</font>(N-1);
    <font color="blue">if </font>(<font color="blue">not </font>Medium.singleState)<font color="blue"> then</font>
      <font color="red">der</font>(p) = 0;
    <font color="blue">end if</font>;
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyStateNoP<font color="blue"> then</font>
    <font color="red">der</font>(htilde) =<font color="red"> zeros</font>(N-1);
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;
<font color="blue">end </font>Flow1D;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Flow1DDB<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.Flow1DBaseI.png" ALT="ThermoPower.Water.Flow1DDB" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Flow1DDB"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Flow1DDB</H2>
<B>1-dimensional fluid flow model for water or steam flow (finite volumes, Dittus-Boelter heat transfer)</B><p>
<IMG SRC="ThermoPower.Water.Flow1DBaseD.png" ALT="ThermoPower.Water.Flow1DDB">
<H3>Information</H3>
<PRE></pre>
<p>This model extends <tt>Flow1D</tt> by computing the distribution of the heat transfer coefficient <tt>gamma</tt> and making it available through an extended version of the <tt>wall</tt> connector.
<p>This model can be used in the case of one-phase water or steam flow. Dittus-Boelter's equation [1] is used to compute the heat transfer coefficient.
<p><b>References:</b></p>
<ol>
<li>J. C. Collier: <i>Convective Boiling and Condensation</i>, 2nd ed.,McGraw Hill, 1981, pp. 146.
</ol>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>StandardWater</TD><TD>Medium model</TD></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>2</TD><TD>Number of nodes for thermal variables</TD></TR>
<TR><TD>Integer</TD><TD>Nt</TD><TD>1</TD><TD>Number of tubes in parallel</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Distance"
>Distance</A></TD><TD>L</TD><TD>&nbsp;</TD><TD>Tube length [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A></TD><TD>H</TD><TD>0</TD><TD>Elevation of outlet over inlet [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Cross-sectional area (single tube) [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>omega</TD><TD>&nbsp;</TD><TD>Perimeter of heat transfer surface (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>Dhyd</TD><TD>&nbsp;</TD><TD>Hydraulic Diameter (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate (total) [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes.Temp"
>Temp</A></TD><TD>FFtype</TD><TD>&nbsp;</TD><TD>Friction Factor Type</TD></TR>
<TR><TD>Real</TD><TD>Kfnom</TD><TD>0</TD><TD>Nominal hydraulic resistance coefficient [Pa.kg/m^3/(kg/s)^2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>0</TD><TD>Nominal pressure drop (friction term only!) [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>0</TD><TD>Nominal inlet density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>Cfnom</TD><TD>0</TD><TD>Nominal Fanning friction factor</TD></TR>
<TR><TD>Real</TD><TD>e</TD><TD>0</TD><TD>Relative roughness (ratio roughness/diameter)</TD></TR>
<TR><TD>Boolean</TD><TD>DynamicMomentum</TD><TD>false</TD><TD>Inertial phenomena accounted for</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_HCtypes.html#ThermoPower.Choices.Flow1D.HCtypes.Temp"
>Temp</A></TD><TD>HydraulicCapacitance</TD><TD>HCtypes.Downstream</TD><TD>Location of the hydraulic capacitance</TD></TR>
<TR><TD>Boolean</TD><TD>avoidInletEnthalpyDerivative</TD><TD>true</TD><TD>Avoid inlet enthalpy derivative</TD></TR>
<TR><TD>Real</TD><TD>wnf</TD><TD>0.01</TD><TD>Fraction of nominal flow rate at which linear friction equals turbulent friction</TD></TR>
<TR><TD>Real</TD><TD>Kfc</TD><TD>1</TD><TD>Friction factor correction coefficient</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartin</TD><TD>1e5</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartout</TD><TD>1e5</TD><TD>Outlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartin</TD><TD>1e5</TD><TD>Inlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartout</TD><TD>1e5</TD><TD>Outlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart[N]</TD><TD>linspace(hstartin, hstartout...</TD><TD>Start value of enthalpy vector (initialized by default) [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Flow1DDB <font color="darkgreen">
  &quot;1-dimensional fluid flow model for water or steam flow (finite volumes, Dittus-Boelter heat transfer)&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1D"
>Flow1D</A>(<font color="blue">redeclare </font><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHThtc"
>Thermal.DHThtc</A> wall);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.DynamicViscosity"
>Medium.DynamicViscosity</A> mu[N] <font color="darkgreen">&quot;Dynamic viscosity&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermalConductivity"
>Medium.ThermalConductivity</A> k[N] <font color="darkgreen">&quot;Thermal conductivity&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificHeatCapacity"
>Medium.SpecificHeatCapacity</A> cp[N] <font color="darkgreen">&quot;Heat capacity at constant pressure&quot;</font>;
<font color="blue">equation </font>
  <font color="blue">for </font>j<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    <font color="darkgreen">// Additional fluid properties</font>
    mu[j] =<font color="red">  Medium.dynamicViscosity</font>(fluid[j].state);
    k[j] =<font color="red">  Medium.thermalConductivity</font>(fluid[j].state);
    cp[j] =<font color="red">  Medium.heatCapacity_cp</font>(fluid[j]);
    wall.gamma[j] =<font color="red">  f_dittus_boelter</font>(w, Dhyd, A, mu[j], k[j], cp[j]) <font color="darkgreen">
      &quot;Heat transfer on the wall connector&quot;</font>;
  <font color="blue">end for</font>;
<font color="blue">end </font>Flow1DDB;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Flow1D2ph<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.Flow1DBaseI.png" ALT="ThermoPower.Water.Flow1D2ph" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Flow1D2ph"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Flow1D2ph</H2>
<B>1-dimensional fluid flow model for water/steam (finite volumes, 2-phase)</B><p>
<IMG SRC="ThermoPower.Water.Flow1DBaseD.png" ALT="ThermoPower.Water.Flow1D2ph">
<H3>Information</H3>
<PRE></pre>
<p>This model describes the flow of water or steam in a rigid tube. The basic modelling assumptions are:
<ul><li>The fluid state is either one-phase, or a two-phase mixture.
<li>In case of two-phase flow, the same velocity is assumed for both phases (homogeneous model).
<li>Uniform velocity is assumed on the cross section, leading to a 1-D distributed parameter model.
<li>Turbulent friction is always assumed; a small linear term is added to avoid numerical singularities at zero flowrate. The friction effects are not accurately computed in the laminar and transitional flow regimes, which however should not be an issue in most applications using water or steam as a working fluid.
<li>The model is based on dynamic mass, momentum, and energy balances. The dynamic momentum term can be switched off, to avoid the fast oscillations that can arise from its coupling with the mass balance (sound wave dynamics).
<li>The longitudinal heat diffusion term is neglected.
<li>The energy balance equation is written by assuming a uniform pressure distribution; the pressure drop is lumped either at the inlet or at the outlet.
<li>The fluid flow can exchange thermal power through the lateral surface, which is represented by the <tt>wall</tt> connector. The actual heat flux must be computed by a connected component (heat transfer computation module).
</ul>
<p>The mass, momentum, and energy balance equation are discretised with the finite volume method. The state variables are one pressure, one flowrate (optional) and N-1 specific enthalpies.
<p>The turbulent friction factor can be either assumed as a constant, or computed by Colebrook's equation. In the former case, the friction factor can be supplied directly, or given implicitly by a specified operating point. In any case, the multiplicative correction coefficient <tt>Kfc</tt> can be used to modify the friction coefficient, e.g. to fit experimental data.
<p>A small linear pressure drop is added to avoid numerical singularities at low or zero flowrate. The <tt>wnom</tt> parameter must be always specified: the additional linear pressure drop is such that it is equal to the turbulent pressure drop when the flowrate is equal to <tt>wnf*wnom</tt> (the default value is 1% of the nominal flowrate). Increase <tt>wnf</tt> if numerical instabilities occur in tubes with very low pressure drops.
<p>The model assumes that the mass flow rate is always from the inlet to the outlet. Small reverse flow is allowed (e.g. when closing a valve at the outlet), but the model will not account for it explicitly.
<p><b>Modelling options</b></p>
<p>Thermal variables (enthalpy, temperature, density) are computed in <tt>N</tt> equally spaced nodes, including the inlet (node 1) and the outlet (node N); <tt>N</tt> must be greater than or equal to 2.
<p>The dynamic momentum term is included or neglected depending on the <tt>DynamicMomentum</tt> parameter.
<p>The density is computed assuming a linear distribution of the specific
enthalpy between the nodes; this requires the availability of the time derivative of the inlet enthalpy. If this is not available, it is possible to set <tt>avoidInletEnthalpyDerivative</tt> to true, which will cause the mean density of the first volume to be approximated as its outlet density, thus avoiding the need of the inlet enthalpy derivative.
<p>The following options are available to specify the friction coefficient:
<ul><li><tt>FFtype = FFtypes.Kfnom</tt>: the hydraulic friction coefficient <tt>Kf</tt> is set directly to <tt>Kfnom</tt>.
<li><tt>FFtype = FFtypes.OpPoint</tt>: the hydraulic friction coefficient is specified by a nominal operating point (<tt>wnom</tt>,<tt>dpnom</tt>, <tt>rhonom</tt>).
<li><tt>FFtype = FFtypes.Cfnom</tt>: the friction coefficient is computed by giving the (constant) value of the Fanning friction factor <tt>Cfnom</tt>.
<li><tt>FFtype = FFtypes.Colebrook</tt>: the Fanning friction factor is computed by Colebrook's equation (assuming Re > 2100, e.g. turbulent flow).
<li><tt>FFtype = FFtypes.NoFriction</tt>: no friction is assumed across the pipe.</ul><p>If <tt>HydraulicCapacitance = 2</tt> (default option) then the mass storage term depending on the pressure is lumped at the outlet, while the optional momentum storage term depending on the flowrate is lumped at the inlet. If <tt>HydraulicCapacitance = 1</tt> the reverse takes place.
<p>Start values for pressure and flowrate are specified by <tt>pstart</tt>, <tt>wstart</tt>. The start values for the node enthalpies are linearly distributed from <tt>hstartin</tt> at the inlet to <tt>hstartout</tt> at the outlet.
<p>A bank of <tt>Nt</tt> identical tubes working in parallel can be modelled by setting <tt>Nt > 1</tt>. The geometric parameters always refer to a <i>single</i> tube.
<p>This models makes the temperature and external heat flow distributions visible through the <tt>wall</tt> connector. If other variables (e.g. the heat transfer coefficient) are needed by external components to compute the actual heat flow, the <tt>wall</tt> connector can be replaced by an extended version of the <tt>DHT</tt> connector.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>2</TD><TD>Number of nodes for thermal variables</TD></TR>
<TR><TD>Integer</TD><TD>Nt</TD><TD>1</TD><TD>Number of tubes in parallel</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Distance"
>Distance</A></TD><TD>L</TD><TD>&nbsp;</TD><TD>Tube length [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A></TD><TD>H</TD><TD>0</TD><TD>Elevation of outlet over inlet [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Cross-sectional area (single tube) [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>omega</TD><TD>&nbsp;</TD><TD>Perimeter of heat transfer surface (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>Dhyd</TD><TD>&nbsp;</TD><TD>Hydraulic Diameter (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate (total) [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes.Temp"
>Temp</A></TD><TD>FFtype</TD><TD>&nbsp;</TD><TD>Friction Factor Type</TD></TR>
<TR><TD>Real</TD><TD>Kfnom</TD><TD>0</TD><TD>Nominal hydraulic resistance coefficient [Pa.kg/m^3/(kg/s)^2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>0</TD><TD>Nominal pressure drop (friction term only!) [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>0</TD><TD>Nominal inlet density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>Cfnom</TD><TD>0</TD><TD>Nominal Fanning friction factor</TD></TR>
<TR><TD>Real</TD><TD>e</TD><TD>0</TD><TD>Relative roughness (ratio roughness/diameter)</TD></TR>
<TR><TD>Boolean</TD><TD>DynamicMomentum</TD><TD>false</TD><TD>Inertial phenomena accounted for</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_HCtypes.html#ThermoPower.Choices.Flow1D.HCtypes.Temp"
>Temp</A></TD><TD>HydraulicCapacitance</TD><TD>HCtypes.Downstream</TD><TD>Location of the hydraulic capacitance</TD></TR>
<TR><TD>Boolean</TD><TD>avoidInletEnthalpyDerivative</TD><TD>true</TD><TD>Avoid inlet enthalpy derivative</TD></TR>
<TR><TD>Real</TD><TD>wnf</TD><TD>0.01</TD><TD>Fraction of nominal flow rate at which linear friction equals turbulent friction</TD></TR>
<TR><TD>Real</TD><TD>Kfc</TD><TD>1</TD><TD>Friction factor correction coefficient</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHT"
>DHT</A></TD><TD>wall</TD><TD>redeclare ThermoPower.Therma...</TD><TD>&nbsp;</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartin</TD><TD>1e5</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartout</TD><TD>1e5</TD><TD>Outlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartin</TD><TD>1e5</TD><TD>Inlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartout</TD><TD>1e5</TD><TD>Outlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart[N]</TD><TD>linspace(hstartin, hstartout...</TD><TD>Start value of enthalpy vector (initialized by default) [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHT"
>DHT</A></TD><TD>wall</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Flow1D2ph <font color="darkgreen">
  &quot;1-dimensional fluid flow model for water/steam (finite volumes, 2-phase)&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1DBase"
>Flow1DBase</A>(<font color="blue">redeclare </font><font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
      Modelica.Media.Interfaces.PartialTwoPhaseMedium <font color="darkgreen">&quot;Medium model&quot;</font>);
  <font color="blue">import </font><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes"
>ThermoPower.Choices.Flow1D.FFtypes</A>;
  <font color="blue">package</font> SmoothMedium=<A HREF="ThermoPower_Water_Medium.html#ThermoPower.Water.Flow1DBase.Medium"
>Medium</A>(<font color="blue">final </font>smoothModel = true);
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pzero=10 <font color="darkgreen">&quot;Small deltap for calculations&quot;</font>;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pc=Medium.fluidConstants[1].criticalPressure;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hzero=1e-3 <font color="darkgreen">&quot;Small value for deltah&quot;</font>;
  SmoothMedium.BaseProperties fluid[N](<font color="blue">each </font>p(start=pstartin),
    h(start=hstart)) <font color="darkgreen">&quot;Properties of the fluid at the nodes&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialTwoPhaseMedium.html#Modelica.Media.Interfaces.PartialTwoPhaseMedium.SaturationProperties"
>Medium.SaturationProperties</A> sat <font color="darkgreen">&quot;Properties of saturated fluid&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> omega_hyd <font color="darkgreen">&quot;Wet perimeter (single tube)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> Dpfric <font color="darkgreen">&quot;Pressure drop due to friction&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> Dpstat <font color="darkgreen">&quot;Pressure drop due to static head&quot;</font>;
  Real Kf[N - 1] <font color="darkgreen">&quot;Friction coefficient&quot;</font>;
  Real Kfl[N - 1] <font color="darkgreen">&quot;Linear friction coefficient&quot;</font>;
  Real Cf[N - 1] <font color="darkgreen">&quot;Fanning friction factor&quot;</font>;
  Real dwdt <font color="darkgreen">&quot;Dynamic momentum term&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p(
   start=<font color="blue">if </font>HydraulicCapacitance==1<font color="blue"> then </font>pstartin<font color="blue"> else </font>pstartout,
   stateSelect = StateSelect.prefer) <font color="darkgreen">&quot;Fluid pressure for property calculations&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> dpf[N - 1] <font color="darkgreen">&quot;Pressure drop due to friction between two nodes&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w(start=wnom/Nt) <font color="darkgreen">&quot;Mass flowrate (single tube)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wbar[N - 1](<font color="blue">each </font>start=wnom/Nt);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Velocity</A> u[N] <font color="darkgreen">&quot;Fluid velocity&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> T[N] <font color="darkgreen">&quot;Fluid temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> Ts <font color="darkgreen">&quot;Saturated water temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> h[N](start=hstart) <font color="darkgreen">&quot;Fluid specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> htilde[N - 1](
    start=hstart[2:N],
    stateSelect = StateSelect.prefer) <font color="darkgreen">&quot;Enthalpy state variables&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hl <font color="darkgreen">&quot;Saturated liquid temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hv <font color="darkgreen">&quot;Saturated vapour temperature&quot;</font>;
  Real x[N] <font color="darkgreen">&quot;Steam quality&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Medium.Density</A> rho[N] <font color="darkgreen">&quot;Fluid density&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.LiquidDensity"
>LiquidDensity</A> rhol <font color="darkgreen">&quot;Saturated liquid density&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.GasDensity"
>GasDensity</A> rhov <font color="darkgreen">&quot;Saturated vapour density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> M <font color="darkgreen">&quot;Fluid mass&quot;</font>;
<font color="blue">protected </font>
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerEnthalpyByPressure"
>DerEnthalpyByPressure</A> dhldp <font color="darkgreen">
    &quot;Derivative of saturated liquid enthalpy by pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerEnthalpyByPressure"
>DerEnthalpyByPressure</A> dhvdp <font color="darkgreen">
    &quot;Derivative of saturated vapour enthalpy by pressure&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A> rhobar[N - 1] <font color="darkgreen">&quot;Fluid average density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByPressure"
>DerDensityByPressure</A> drdp[N] <font color="darkgreen">&quot;Derivative of density by pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByPressure"
>DerDensityByPressure</A> drbdp[N - 1] <font color="darkgreen">&quot;Derivative of average density by pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByPressure"
>DerDensityByPressure</A> drldp <font color="darkgreen">
    &quot;Derivative of saturated liquid density by pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByPressure"
>DerDensityByPressure</A> drvdp <font color="darkgreen">
    &quot;Derivative of saturated vapour density by pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificVolume"
>SpecificVolume</A> vbar[N - 1] <font color="darkgreen">&quot;Average specific volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlux"
>HeatFlux</A> phibar[N - 1] <font color="darkgreen">&quot;Average heat flux&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByEnthalpy"
>DerDensityByEnthalpy</A> drdh[N] <font color="darkgreen">&quot;Derivative of density by enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByEnthalpy"
>DerDensityByEnthalpy</A> drbdh1[N - 1] <font color="darkgreen">
    &quot;Derivative of average density by left enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByEnthalpy"
>DerDensityByEnthalpy</A> drbdh2[N - 1] <font color="darkgreen">
    &quot;Derivative of average density by right enthalpy&quot;</font>;
  Real AA;
  Real AA1;
  Real dMdt[N - 1] <font color="darkgreen">&quot;Derivative of fluid mass in each volume&quot;</font>;
<font color="blue">equation </font>
  <font color="darkgreen">//All equations are referred to a single tube</font>
  omega_hyd = 4*A/Dhyd;
  <font color="darkgreen">// Friction factor selection</font>
  <font color="blue">for </font>j<font color="blue"> in </font>1:(N - 1)<font color="blue"> loop</font>
    <font color="blue">if </font>FFtype == FFtypes.Kfnom<font color="blue"> then</font>
      Kf[j] = Kfnom*Kfc/(N - 1);
      Cf[j] = 2*Kf[j]*A^3/(omega_hyd*l);
    <font color="blue">elseif </font>FFtype == FFtypes.OpPoint<font color="blue"> then</font>
      Kf[j] = dpnom*rhonom/(wnom/Nt)^2/(N - 1)*Kfc;
      Cf[j] = 2*Kf[j]*A^3/(omega_hyd*l);
    <font color="blue">elseif </font>FFtype == FFtypes.Cfnom<font color="blue"> then</font>
      Kf[j] = Cfnom*omega_hyd*l/(2*A^3)*Kfc;
      Cf[j] = 2*Kf[j]*A^3/(omega_hyd*l);
    <font color="blue">elseif </font>FFtype == FFtypes.Colebrook<font color="blue"> then</font>
      Cf[j]=<font color="blue">if </font><font color="red">noEvent</font>(htilde[j] &lt; hl<font color="blue"> or </font>htilde[j] &gt; hv)<font color="blue"> then </font>
        <font color="red">f_colebrook</font>(w, Dhyd/A, e,
          <font color="red">Medium.dynamicViscosity</font>(fluid[j].state))*Kfc<font color="blue"> else </font>
        <font color="red">f_colebrook_2ph</font>(w, Dhyd/A, e,
          <font color="red">Medium.dynamicViscosity</font>(<font color="red">Medium.setBubbleState</font>(sat,1)),
          <font color="red">Medium.dynamicViscosity</font>(<font color="red">Medium.setDewState</font>(sat,1)),x[j])*Kfc;
      Kf[j] = Cf[j]*omega_hyd*l/(2*A^3);
    <font color="blue">elseif </font>FFtype == FFtypes.NoFriction<font color="blue"> then</font>
      Cf[j] = 0;
      Kf[j] = 0;
    <font color="blue">else</font>
      <font color="red">assert</font>(FFtype&lt;&gt;FFtypes.NoFriction, &quot;Unsupported FFtype&quot;);
      Cf[j] = 0;
      Kf[j] = 0;
    <font color="blue">end if</font>;
    <font color="red">assert</font>(Kf[j]&gt;=0, &quot;Negative friction coefficient&quot;);
    Kfl[j] = wnom*wnf*Kf[j];
  <font color="blue">end for</font>;

  <font color="darkgreen">// Dynamic momentum term</font>
  <font color="blue">if </font>DynamicMomentum<font color="blue"> then</font>
    dwdt =<font color="red"> der</font>(w);
  <font color="blue">else</font>
    dwdt = 0;
  <font color="blue">end if</font>;

  <font color="red">sum</font>(dMdt) = (infl.w/Nt + outfl.w/Nt) <font color="darkgreen">&quot;Mass balance&quot;</font>;
  <font color="red">sum</font>(dpf) = Dpfric <font color="darkgreen">&quot;Total pressure drop due to friction&quot;</font>;
  Dpstat = <font color="blue">if </font><font color="red">abs</font>(dzdx)&lt;1e-6<font color="blue"> then </font>0<font color="blue"> else </font>g*l*dzdx*<font color="red">sum</font>(rhobar) <font color="darkgreen">
    &quot;Pressure drop due to static head&quot;</font>;
  L/A*dwdt + (outfl.p - infl.p) + Dpstat + Dpfric = 0 <font color="darkgreen">&quot;Momentum balance&quot;</font>;
  <font color="blue">for </font>j<font color="blue"> in </font>1:(N - 1)<font color="blue"> loop</font>
    A*l*rhobar[j]*<font color="red">der</font>(htilde[j]) + wbar[j]*(h[j + 1] - h[j]) - A*l*<font color="red">der</font>(p) =
       l*omega*phibar[j] <font color="darkgreen">&quot;Energy balance&quot;</font>;
    dMdt[j] = A*l*(drbdh1[j]*<font color="red">der</font>(h[j]) + drbdh2[j]*<font color="red">der</font>(h[j+1]) + drbdp[j]*<font color="red">der</font>(p)) <font color="darkgreen">
      &quot;Mass balance for each volume&quot;</font>;
    <font color="darkgreen">// Average volume quantities</font>
    vbar[j] = 1/rhobar[j] <font color="darkgreen">&quot;Average specific volume&quot;</font>;
    wbar[j] = infl.w/Nt -<font color="red"> sum</font>(dMdt[1:j - 1]) - dMdt[j]/2;
    dpf[j] = (<font color="blue">if </font>FFtype == FFtypes.NoFriction<font color="blue"> then </font>0<font color="blue"> else </font>
              <font color="red">noEvent</font>(Kf[j]*<font color="red">abs</font>(w) + Kfl[j])*w*vbar[j]);
    <font color="blue">if </font>avoidInletEnthalpyDerivative<font color="blue"> and </font>j == 1<font color="blue"> then</font>
      <font color="darkgreen">// first volume properties computed by the outlet properties</font>
      rhobar[j] = rho[j+1];
      drbdp[j] = drdp[j+1];
      drbdh1[j] = 0;
      drbdh2[j] = drdh[j+1];
    <font color="blue">elseif </font><font color="red">noEvent</font>((h[j] &lt; hl<font color="blue"> and </font>h[j + 1] &lt; hl)<font color="blue"> or </font>(h[j] &gt; hv<font color="blue"> and </font>h[j + 1] &gt;
        hv)<font color="blue"> or </font>p &gt;= (pc - pzero)<font color="blue"> or </font><font color="red">abs</font>(h[j + 1] - h[j]) &lt; hzero)<font color="blue"> then</font>
      <font color="darkgreen">// 1-phase or almost uniform properties</font>
      rhobar[j] = (rho[j] + rho[j+1])/2;
      drbdp[j] = (drdp[j] + drdp[j+1])/2;
      drbdh1[j] = drdh[j]/2;
      drbdh2[j] = drdh[j+1]/2;
    <font color="blue">elseif </font><font color="red">noEvent</font>(h[j] &gt;= hl<font color="blue"> and </font>h[j] &lt;= hv<font color="blue"> and </font>h[j + 1] &gt;= hl<font color="blue"> and </font>h[j + 1]
         &lt;= hv)<font color="blue"> then</font>
      <font color="darkgreen">// 2-phase</font>
      rhobar[j] = AA*<font color="red">log</font>(rho[j]/rho[j+1]) / (h[j+1] - h[j]);
      drbdp[j] = (AA1*<font color="red">log</font>(rho[j]/rho[j+1]) +
                  AA*(1/rho[j] * drdp[j] - 1/rho[j+1] * drdp[j+1])) /
                 (h[j+1] - h[j]);
      drbdh1[j] = (rhobar[j] - rho[j]) / (h[j+1] - h[j]);
      drbdh2[j] = (rho[j+1] - rhobar[j]) / (h[j+1] - h[j]);
    <font color="blue">elseif </font><font color="red">noEvent</font>(h[j] &lt; hl<font color="blue"> and </font>h[j + 1] &gt;= hl<font color="blue"> and </font>h[j + 1] &lt;= hv)<font color="blue"> then</font>
      <font color="darkgreen">// liquid/2-phase</font>
      rhobar[j] = ((rho[j] + rhol)*(hl - h[j])/2 + AA*<font color="red">log</font>(rhol/rho[j+1])) /
                  (h[j+1] - h[j]);
      drbdp[j] = ((drdp[j] + drldp)*(hl - h[j])/2 + (rho[j]+rhol)/2 * dhldp +
                   AA1*<font color="red">log</font>(rhol/rho[j+1]) +
                   AA*(1/rhol * drldp - 1/rho[j+1] * drdp[j+1])) / (h[j+1] - h[j]);
      drbdh1[j] = (rhobar[j] - (rho[j]+rhol)/2 + drdh[j]*(hl-h[j])/2) / (h[j+1] - h[j]);
      drbdh2[j] = (rho[j+1] - rhobar[j]) / (h[j+1] - h[j]);
    <font color="blue">elseif </font><font color="red">noEvent</font>(h[j] &gt;= hl<font color="blue"> and </font>h[j] &lt;= hv<font color="blue"> and </font>h[j + 1] &gt; hv)<font color="blue"> then</font>
      <font color="darkgreen">// 2-phase/vapour</font>
      rhobar[j] = (AA*<font color="red">log</font>(rho[j]/rhov) + (rhov + rho[j+1])*(h[j+1] - hv)/2) /
                  (h[j+1] - h[j]);
      drbdp[j] = (AA1*<font color="red">log</font>(rho[j]/rhov) +
                  AA*(1/rho[j] * drdp[j] - 1/rhov *drvdp) +
                  (drvdp + drdp[j+1])*(h[j+1] - hv)/2 - (rhov+rho[j+1])/2 * dhvdp) /
                 (h[j + 1] - h[j]);
      drbdh1[j] = (rhobar[j] - rho[j]) / (h[j+1] - h[j]);
      drbdh2[j] = ((rhov+rho[j+1])/2 - rhobar[j] + drdh[j+1]*(h[j+1]-hv)/2) /
                  (h[j+1] - h[j]);
    <font color="blue">elseif </font><font color="red">noEvent</font>(h[j] &lt; hl<font color="blue"> and </font>h[j + 1] &gt; hv)<font color="blue"> then</font>
      <font color="darkgreen">// liquid/2-phase/vapour</font>
      rhobar[j] = ((rho[j] + rhol)*(hl - h[j])/2 + AA*<font color="red">log</font>(rhol/rhov) +
                   (rhov + rho[j+1])*(h[j+1] - hv)/2) / (h[j+1] - h[j]);
      drbdp[j] = ((drdp[j] + drldp)*(hl - h[j])/2 + (rho[j]+rhol)/2 * dhldp +
                  AA1*<font color="red">log</font>(rhol/rhov) + AA*(1/rhol * drldp - 1/rhov * drvdp) +
                  (drvdp + drdp[j+1])*(h[j+1] - hv)/2 - (rhov+rho[j+1])/2 * dhvdp) /
                 (h[j+1] - h[j]);
      drbdh1[j] = (rhobar[j] - (rho[j]+rhol)/2 + drdh[j]*(hl-h[j])/2) / (h[j+1] - h[j]);
      drbdh2[j] = ((rhov+rho[j+1])/2 - rhobar[j] + drdh[j+1]*(h[j+1]-hv)/2) / (h[j+1] - h[j]);
    <font color="blue">elseif </font><font color="red">noEvent</font>(h[j] &gt;= hl<font color="blue"> and </font>h[j] &lt;= hv<font color="blue"> and </font>h[j + 1] &lt; hl)<font color="blue"> then</font>
      <font color="darkgreen">// 2-phase/liquid</font>
      rhobar[j] = (AA*<font color="red">log</font>(rho[j]/rhol) + (rhol + rho[j+1])*(h[j+1] - hl)/2) /
                  (h[j+1] - h[j]);
      drbdp[j] = (AA1*<font color="red">log</font>(rho[j]/rhol) +
                  AA*(1/rho[j] * drdp[j] - 1/rhol * drldp) +
                  (drldp + drdp[j+1])*(h[j+1] - hl)/2 - (rhol + rho[j+1])/2 * dhldp) /
                 (h[j + 1] - h[j]);
      drbdh1[j] = (rhobar[j] - rho[j]) / (h[j+1] - h[j]);
      drbdh2[j] = ((rhol+rho[j+1])/2 - rhobar[j] + drdh[j+1]*(h[j+1]-hl)/2) / (h[j+1] - h[j]);
    <font color="blue">elseif </font><font color="red">noEvent</font>(h[j] &gt; hv<font color="blue"> and </font>h[j + 1] &lt; hl)<font color="blue"> then</font>
      <font color="darkgreen">// vapour/2-phase/liquid</font>
      rhobar[j] = ((rho[j] + rhov)*(hv - h[j])/2 + AA*<font color="red">log</font>(rhov/rhol) +
                   (rhol + rho[j+1])*(h[j+1] - hl)/2) / (h[j+1] - h[j]);
      drbdp[j] = ((drdp[j] + drvdp)*(hv - h[j])/2 + (rho[j]+rhov)/2 * dhvdp +
                  AA1*<font color="red">log</font>(rhov/rhol) +
                  AA*(1/rhov * drvdp - 1/rhol * drldp) +
                  (drldp + drdp[j+1])*(h[j+1] - hl)/2 - (rhol+rho[j+1])/2 * dhldp) /
                 (h[j+1] - h[j]);
      drbdh1[j] = (rhobar[j] - (rho[j]+rhov)/2 + drdh[j]*(hv-h[j])/2) / (h[j+1] - h[j]);
      drbdh2[j] = ((rhol+rho[j+1])/2 - rhobar[j] + drdh[j+1]*(h[j+1]-hl)/2) / (h[j+1] - h[j]);
    <font color="blue">else</font>
      <font color="darkgreen">// vapour/2-phase</font>
      rhobar[j] = ((rho[j] + rhov)*(hv - h[j])/2 + AA*<font color="red">log</font>(rhov/rho[j+1])) / (h[j+1] - h[j]);
      drbdp[j] = ((drdp[j] + drvdp)*(hv - h[j])/2 + (rho[j]+rhov)/2 * dhvdp +
                  AA1*<font color="red">log</font>(rhov/rho[j+1]) + AA*(1/rhov * drvdp - 1/rho[j+1] * drdp[j+1])) /
                 (h[j + 1] - h[j]);
      drbdh1[j] = (rhobar[j] - (rho[j]+rhov)/2 + drdh[j]*(hv-h[j])/2) / (h[j+1] - h[j]);
      drbdh2[j] = (rho[j+1] - rhobar[j]) / (h[j+1] - h[j]);
    <font color="blue">end if</font>;
  <font color="blue">end for</font>;

  <font color="darkgreen">// Saturated fluid property calculations</font>
  sat =<font color="red"> Medium.setSat_p</font>(p);
  Ts=sat.Tsat;
  rhol=<font color="red">Medium.bubbleDensity</font>(sat);
  rhov=<font color="red">Medium.dewDensity</font>(sat);
  hl=<font color="red">Medium.bubbleEnthalpy</font>(sat);
  hv=<font color="red">Medium.dewEnthalpy</font>(sat);
  drldp=<font color="red">Medium.dBubbleDensity_dPressure</font>(sat);
  drvdp=<font color="red">Medium.dDewDensity_dPressure</font>(sat);
  dhldp=<font color="red">Medium.dBubbleEnthalpy_dPressure</font>(sat);
  dhvdp=<font color="red">Medium.dDewEnthalpy_dPressure</font>(sat);
  AA = (hv - hl)/(1/rhov - 1/rhol);
  AA1 = ((dhvdp - dhldp)*(rhol - rhov)*rhol*rhov
          - (hv - hl)*(rhov^2*drldp - rhol^2*drvdp))/(rhol - rhov)^2;

  <font color="darkgreen">// Fluid property calculations</font>
  <font color="blue">for </font>j<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    fluid[j].p=p;
    fluid[j].h=h[j];
    T[j]=fluid[j].T;
    rho[j]=fluid[j].d;
    drdp[j]=<font color="red">Medium.density_derp_h</font>(fluid[j].state);
    drdh[j]=<font color="red">Medium.density_derh_p</font>(fluid[j].state);
    u[j] = w/(rho[j]*A);
    x[j]=<font color="red">noEvent</font>(<font color="blue">if </font>h[j]&lt;=hl<font color="blue"> then </font>0<font color="blue"> else </font>
              <font color="blue">if </font>h[j]&gt;=hv<font color="blue"> then </font>1<font color="blue"> else </font>(h[j]-hl)/(hv-hl));
  <font color="blue">end for</font>;

  <font color="darkgreen">// Selection of representative pressure and flow rate variables</font>
  <font color="blue">if </font>HydraulicCapacitance == 1<font color="blue"> then</font>
    p = infl.p;
    w = -outfl.w/Nt;
  <font color="blue">else</font>
    p = outfl.p;
    w = infl.w/Nt;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Boundary conditions</font>
  infl.hAB = htilde[1];
  outfl.hBA = htilde[N - 1];
  h[1] = infl.hBA;
  h[2:N] = htilde;
  T = wall.T;
  phibar = (wall.phi[1:N - 1] + wall.phi[2:N])/2;

  Q = Nt*l*omega*<font color="red">sum</font>(phibar) <font color="darkgreen">&quot;Total heat flow through lateral boundary&quot;</font>;
  M=<font color="red">sum</font>(rhobar)*A*l <font color="darkgreen">&quot;Fluid mass (single tube)&quot;</font>;
  Tr=<font color="red">noEvent</font>(M/<font color="red">max</font>(infl.w/Nt,Modelica.Constants.eps)) <font color="darkgreen">&quot;Residence time&quot;</font>;

<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="red">der</font>(htilde) =<font color="red"> zeros</font>(N-1);
    <font color="blue">if </font>(<font color="blue">not </font>Medium.singleState)<font color="blue"> then</font>
      <font color="red">der</font>(p) = 0;
    <font color="blue">end if</font>;
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyStateNoP<font color="blue"> then</font>
    <font color="red">der</font>(htilde) =<font color="red"> zeros</font>(N-1);
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;

<font color="blue">end </font>Flow1D2ph;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Flow1D2phDB<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.Flow1DBaseI.png" ALT="ThermoPower.Water.Flow1D2phDB" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Flow1D2phDB"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Flow1D2phDB</H2>
<B>1-dimensional fluid flow model for 2-phase boiling flow (finite volumes, 2-phase, computation of heat transfer coeff.)</B><p>
<IMG SRC="ThermoPower.Water.Flow1DBaseD.png" ALT="ThermoPower.Water.Flow1D2phDB">
<H3>Information</H3>
<PRE></pre>
<p>This model extends <tt>Flow1D2ph</tt> by computing the distribution of the heat transfer coefficient <tt>gamma</tt> and making it available through an extended version of the <tt>wall</tt> connector.
<p>This simplified model can be used for one-phase or two-phase water/steam flow. The heat transfer coefficient is computed according to the following hypotheses:
<ul>
<li> If the fluid is subcooled liquid or superheated steam, Dittus-Boelter's correlation [1] is used.
<li> If the fluid is a two-phase mixture with a steam fraction less than the (constant) critical value <tt>xCHF</tt>, boiling heat transfer is assumed with a heat transfer coefficient equal to <tt>gamma_b</tt>.
<li> If the fluid is wet steam with a steam fraction greater than the (constant) critical value <tt>xCHF</tt>, the heat transfer coefficient is computed according to Dittus-Boelter's correlation, by considering only the steam fraction of the mixture.
</ul>
<p>A smoothing algorithm is applied to the nodes which are in the neighbourhood of a transition boundary between non-boiling and boiling conditions, to avoid non-physical sudden changes of the nodal values of the heat transfer coefficient when the transition boundary passes through a node. The computed values of the heat transfer coefficient are thus a continuous function of the nodal enthalpies and pressures, so that it is not necessary to generate events in order to handle discontinuities
<p><b>References</b></p>
<ol>
<li>J. C. Collier: <i>Convective Boiling and Condensation</i>, 2nd ed.,McGraw Hill, 1981, pp. 146.
</ol>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>StandardWater</TD><TD>Medium model</TD></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>2</TD><TD>Number of nodes for thermal variables</TD></TR>
<TR><TD>Integer</TD><TD>Nt</TD><TD>1</TD><TD>Number of tubes in parallel</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Distance"
>Distance</A></TD><TD>L</TD><TD>&nbsp;</TD><TD>Tube length [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A></TD><TD>H</TD><TD>0</TD><TD>Elevation of outlet over inlet [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Cross-sectional area (single tube) [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>omega</TD><TD>&nbsp;</TD><TD>Perimeter of heat transfer surface (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>Dhyd</TD><TD>&nbsp;</TD><TD>Hydraulic Diameter (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate (total) [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes.Temp"
>Temp</A></TD><TD>FFtype</TD><TD>&nbsp;</TD><TD>Friction Factor Type</TD></TR>
<TR><TD>Real</TD><TD>Kfnom</TD><TD>0</TD><TD>Nominal hydraulic resistance coefficient [Pa.kg/m^3/(kg/s)^2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>0</TD><TD>Nominal pressure drop (friction term only!) [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>0</TD><TD>Nominal inlet density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>Cfnom</TD><TD>0</TD><TD>Nominal Fanning friction factor</TD></TR>
<TR><TD>Real</TD><TD>e</TD><TD>0</TD><TD>Relative roughness (ratio roughness/diameter)</TD></TR>
<TR><TD>Boolean</TD><TD>DynamicMomentum</TD><TD>false</TD><TD>Inertial phenomena accounted for</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_HCtypes.html#ThermoPower.Choices.Flow1D.HCtypes.Temp"
>Temp</A></TD><TD>HydraulicCapacitance</TD><TD>HCtypes.Downstream</TD><TD>Location of the hydraulic capacitance</TD></TR>
<TR><TD>Boolean</TD><TD>avoidInletEnthalpyDerivative</TD><TD>true</TD><TD>Avoid inlet enthalpy derivative</TD></TR>
<TR><TD>Real</TD><TD>wnf</TD><TD>0.01</TD><TD>Fraction of nominal flow rate at which linear friction equals turbulent friction</TD></TR>
<TR><TD>Real</TD><TD>Kfc</TD><TD>1</TD><TD>Friction factor correction coefficient</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>gamma_b</TD><TD>20000</TD><TD>Coefficient of heat transfer for boiling flow [W/(m2.K)]</TD></TR>
<TR><TD>Real</TD><TD>xCHF</TD><TD>0.9</TD><TD>Steam quality corresponding to the Critical Heat Flux</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartin</TD><TD>1e5</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartout</TD><TD>1e5</TD><TD>Outlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartin</TD><TD>1e5</TD><TD>Inlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartout</TD><TD>1e5</TD><TD>Outlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart[N]</TD><TD>linspace(hstartin, hstartout...</TD><TD>Start value of enthalpy vector (initialized by default) [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Flow1D2phDB <font color="darkgreen">
  &quot;1-dimensional fluid flow model for 2-phase boiling flow (finite volumes, 2-phase, computation of heat transfer coeff.)&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1D2ph"
>Flow1D2ph</A>(<font color="blue">redeclare </font><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHThtc"
>Thermal.DHThtc</A> wall);
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma_b=20000 <font color="darkgreen">
    &quot;Coefficient of heat transfer for boiling flow&quot;</font>;
  <font color="blue">parameter </font>Real xCHF=0.9 <font color="darkgreen">
    &quot;Steam quality corresponding to the Critical Heat Flux&quot;</font>;
  Medium.ThermodynamicState bubble <font color="darkgreen">&quot;Bubble point state&quot;</font>;
  Medium.ThermodynamicState dew <font color="darkgreen">&quot;Dew point state&quot;</font>;
<font color="blue">protected </font>
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma[N] <font color="darkgreen">&quot;Raw heat transfer coefficient&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma_ls <font color="darkgreen">&quot;H.t.c. just before bubble point&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma_chf <font color="darkgreen">&quot;H.t.c. just after CHF&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma_corr_left[N] <font color="darkgreen">
    &quot;Correction term to get smooth h.t.c.&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma_corr_right[N] <font color="darkgreen">
    &quot;Correction term to get smooth h.t.c.&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hCHF <font color="darkgreen">&quot;Enthalpy corresponding to the Critical Heat Flux&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A> mu_ls <font color="darkgreen">&quot;Dynamic viscosity at bubble point&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A> mu_vs <font color="darkgreen">&quot;Dynamic viscosity at dew point&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A> k_ls <font color="darkgreen">&quot;Thermal conductivity at bubble point&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A> k_vs <font color="darkgreen">&quot;Thermal conductivity at dew point&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>SpecificHeatCapacity</A> cp_ls <font color="darkgreen">&quot;Specific heat capacity at bubble point&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>SpecificHeatCapacity</A> cp_vs <font color="darkgreen">&quot;Specific heat capacity at dew point&quot;</font>;
<font color="blue">equation </font>
  hCHF = hl + xCHF*(hv - hl) <font color="darkgreen">
    &quot;Specific enthalpy corresponding to critical heat flux&quot;</font>;
  <font color="darkgreen">// Saturated fluid properties</font>
  bubble =<font color="red"> Medium.setBubbleState</font>(sat,1);
  dew =<font color="red"> Medium.setDewState</font>(sat,1);
  mu_ls =<font color="red">  Medium.dynamicViscosity</font>(bubble);
  k_ls =<font color="red">  Medium.thermalConductivity</font>(bubble);
  cp_ls =<font color="red"> Medium.heatCapacity_cp</font>(bubble);
  mu_vs =<font color="red">  Medium.dynamicViscosity</font>(dew);
  k_vs =<font color="red">  Medium.thermalConductivity</font>(dew);
  cp_vs =<font color="red"> Medium.heatCapacity_cp</font>(dew);
  <font color="darkgreen">// H.t.c. just outside the nucleate boiling region</font>
  gamma_ls =<font color="red">f_dittus_boelter</font>(w, Dhyd, A, mu_ls, k_ls, cp_ls);
  gamma_chf =<font color="red">f_dittus_boelter</font>(w*xCHF, Dhyd, A, mu_vs, k_vs, cp_vs);

  <font color="darkgreen">// Nodal h.t.c.</font>
  <font color="blue">for </font>j<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    <font color="darkgreen">  // a) Subcooled liquid </font>
    <font color="darkgreen">  // b) Wet steam after dryout: Dittus-Boelter's correlation considering</font>
    <font color="darkgreen">  //    only the vapour phase</font>
    <font color="darkgreen">  // c) Nucleate boiling: constant h.t.c.</font>
    gamma[j] =<font color="red"> noEvent</font>(<font color="blue">if </font>h[j] &lt; hl<font color="blue"> or </font>h[j] &gt; hv<font color="blue"> then </font>
      <font color="red">f_dittus_boelter</font>(w, Dhyd, A,
      <font color="red">Medium.dynamicViscosity</font>(fluid[j].state),
      <font color="red">Medium.thermalConductivity</font>(fluid[j].state),
      <font color="red">Medium.heatCapacity_cp</font>(fluid[j].state))<font color="blue"> else </font>
    <font color="blue">if </font>h[j] &gt; hCHF<font color="blue"> then </font>
      <font color="red">f_dittus_boelter</font>(w*x[j], Dhyd, A, mu_vs, k_vs, cp_vs)<font color="blue"> else </font>
      gamma_b);
  <font color="blue">end for</font>;

  <font color="darkgreen">// Corrections due to boundaries near the nodes to the left</font>
  <font color="darkgreen">// to achieve continuous h.t.c.</font>
  gamma_corr_left[1]=0;
  <font color="blue">for </font>j<font color="blue"> in </font>2:N<font color="blue"> loop</font>
    gamma_corr_left[j] =<font color="red"> noEvent</font>(
    <font color="blue">if </font>h[j] &lt; hl<font color="blue"> then </font>
      (<font color="blue">if </font>(h[j-1]+h[j])/2 &gt; hl<font color="blue"> then </font>
        ((h[j-1]-hl)/(h[j-1]-h[j])-0.5)*(gamma_b-gamma_ls)*
          (<font color="blue">if </font>j==N<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
          0)<font color="blue"> else </font>
    <font color="blue">if </font>h[j] &gt; hCHF<font color="blue"> then </font>
      (<font color="blue">if </font>(h[j-1]+h[j])/2 &lt; hCHF<font color="blue"> then </font>
        ((hCHF-h[j-1])/(h[j]-h[j-1])-0.5)*(gamma_b-gamma_chf)*
          (<font color="blue">if </font>j==N<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
             0)<font color="blue"> else </font>
      <font color="blue">if </font>(h[j-1]+h[j])/2 &lt; hl<font color="blue"> then </font>
          ((hl-h[j-1])/(h[j]-h[j-1])-0.5)*(gamma_ls-gamma_b)*
            (<font color="blue">if </font>j==N<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
      <font color="blue">if </font>(h[j-1]+h[j])/2 &gt; hCHF<font color="blue"> then </font>
          ((h[j-1]-hCHF)/(h[j-1]-h[j])-0.5)*(gamma_chf-gamma_b)*
            (<font color="blue">if </font>j==N<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
          0);
  <font color="blue">end for</font>;

  <font color="darkgreen">// Corrections due to boundaries near the nodes to the right</font>
  <font color="darkgreen">// to achieve continuous h.t.c.</font>
  gamma_corr_right[N]=0;
  <font color="blue">for </font>j<font color="blue"> in </font>1:N-1<font color="blue"> loop</font>
    gamma_corr_right[j] =<font color="red"> noEvent</font>(
    <font color="blue">if </font>h[j] &lt; hl<font color="blue"> then </font>
      (<font color="blue">if </font>(h[j+1]+h[j])/2 &gt; hl<font color="blue"> then </font>
        ((h[j+1]-hl)/(h[j+1]-h[j])-0.5)*(gamma_b-gamma_ls)*
          (<font color="blue">if </font>j==1<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
         0)<font color="blue"> else </font>
    <font color="blue">if </font>h[j] &gt; hCHF<font color="blue"> then </font>
      (<font color="blue">if </font>(h[j+1]+h[j])/2 &lt; hCHF<font color="blue"> then </font>
        ((hCHF-h[j+1])/(h[j]-h[j+1])-0.5)*(gamma_b-gamma_chf)*
          (<font color="blue">if </font>j==1<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
         0)<font color="blue"> else </font>
      <font color="blue">if </font>(h[j+1]+h[j])/2 &lt; hl<font color="blue"> then </font>
        ((hl-h[j+1])/(h[j]-h[j+1])-0.5)*(gamma_ls-gamma_b)*
          (<font color="blue">if </font>j==1<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
      <font color="blue">if </font>(h[j+1]+h[j])/2 &gt; hCHF<font color="blue"> then </font>
        ((h[j+1]-hCHF)/(h[j+1]-h[j])-0.5)*(gamma_chf-gamma_b)*
          (<font color="blue">if </font>j==1<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
        0);
  <font color="blue">end for</font>;

  wall.gamma = gamma + gamma_corr_left + gamma_corr_right <font color="darkgreen">
    &quot;H.t.c. including smoothing terms&quot;</font>;
<font color="blue">end </font>Flow1D2phDB;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Flow1D2phChen<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.Flow1DBaseI.png" ALT="ThermoPower.Water.Flow1D2phChen" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Flow1D2phChen"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Flow1D2phChen</H2>
<B>1-dimensional fluid flow model for 2-phase boiling flow (finite volumes, 2-phase, Chen correlation)</B><p>
<IMG SRC="ThermoPower.Water.Flow1DBaseD.png" ALT="ThermoPower.Water.Flow1D2phChen">
<H3>Information</H3>
<PRE></pre>
<p>This model extends <tt>Flow1D2ph</tt> by computing the distribution of the heat transfer coefficient <tt>gamma</tt> and making it available through an extended version of the <tt>wall</tt> connector.
<p>The model can be used for one-phase or two-phase water/steam flow. The heat transfer coefficient is computed according to the following hypotheses:
<ul>
<li> If the fluid is subcooled liquid or superheated steam, Dittus-Boelter's correlation [1] is used.
<li> If the fluid is a two-phase mixture with a steam fraction less than the (constant) critical value <tt>xCHF</tt>, the heat transfer coefficent is computed according to Chen's correlation [2].
<li> If the fluid is wet steam with a steam fraction greater than the (constant) critical value <tt>xCHF</tt>, the heat transfer coefficient is computed according to Dittus-Boelter's correlation [1], by considering only the steam fraction of the mixture.
</ul>
<p>A smoothing algorithm is applied to the nodes which are in the neighbourhood of a transition boundary between non-boiling and boiling conditions, to avoid non-physical sudden changes of the nodal values of the heat transfer coefficient when the transition boundary passes through a node. The computed values of the heat transfer coefficient are thus a continuous function of the nodal enthalpies and pressures, so that it is not necessary to generate events in order to handle discontinuities
<p><b>References</b></p>
<ol>
<li>J. C. Collier: <i>Convective Boiling and Condensation</i>, 2nd ed.,McGraw Hill, 1981, pp. 146.
</ol>
<ol>
<li>J. C. Collier: <i>Convective Boiling and Condensation</i>, 2nd ed.,McGraw Hill, 1981, pp. 215-220.
</ol>
<p><b>Revision history:</b></p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>StandardWater</TD><TD>Medium model</TD></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>2</TD><TD>Number of nodes for thermal variables</TD></TR>
<TR><TD>Integer</TD><TD>Nt</TD><TD>1</TD><TD>Number of tubes in parallel</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Distance"
>Distance</A></TD><TD>L</TD><TD>&nbsp;</TD><TD>Tube length [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A></TD><TD>H</TD><TD>0</TD><TD>Elevation of outlet over inlet [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Cross-sectional area (single tube) [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>omega</TD><TD>&nbsp;</TD><TD>Perimeter of heat transfer surface (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>Dhyd</TD><TD>&nbsp;</TD><TD>Hydraulic Diameter (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate (total) [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes.Temp"
>Temp</A></TD><TD>FFtype</TD><TD>&nbsp;</TD><TD>Friction Factor Type</TD></TR>
<TR><TD>Real</TD><TD>Kfnom</TD><TD>0</TD><TD>Nominal hydraulic resistance coefficient [Pa.kg/m^3/(kg/s)^2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>0</TD><TD>Nominal pressure drop (friction term only!) [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>0</TD><TD>Nominal inlet density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>Cfnom</TD><TD>0</TD><TD>Nominal Fanning friction factor</TD></TR>
<TR><TD>Real</TD><TD>e</TD><TD>0</TD><TD>Relative roughness (ratio roughness/diameter)</TD></TR>
<TR><TD>Boolean</TD><TD>DynamicMomentum</TD><TD>false</TD><TD>Inertial phenomena accounted for</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_HCtypes.html#ThermoPower.Choices.Flow1D.HCtypes.Temp"
>Temp</A></TD><TD>HydraulicCapacitance</TD><TD>HCtypes.Downstream</TD><TD>Location of the hydraulic capacitance</TD></TR>
<TR><TD>Boolean</TD><TD>avoidInletEnthalpyDerivative</TD><TD>true</TD><TD>Avoid inlet enthalpy derivative</TD></TR>
<TR><TD>Real</TD><TD>wnf</TD><TD>0.01</TD><TD>Fraction of nominal flow rate at which linear friction equals turbulent friction</TD></TR>
<TR><TD>Real</TD><TD>Kfc</TD><TD>1</TD><TD>Friction factor correction coefficient</TD></TR>
<TR><TD>Real</TD><TD>xCHF</TD><TD>0.9</TD><TD>Steam quality corresponding to Critical Heat Flux</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartin</TD><TD>1e5</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartout</TD><TD>1e5</TD><TD>Outlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartin</TD><TD>1e5</TD><TD>Inlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartout</TD><TD>1e5</TD><TD>Outlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart[N]</TD><TD>linspace(hstartin, hstartout...</TD><TD>Start value of enthalpy vector (initialized by default) [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Flow1D2phChen <font color="darkgreen">
  &quot;1-dimensional fluid flow model for 2-phase boiling flow (finite volumes, 2-phase, Chen correlation)&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1D2ph"
>Flow1D2ph</A>(<font color="blue">redeclare </font><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHThtc"
>Thermal.DHThtc</A> wall);
  <font color="blue">parameter </font>Real xCHF=0.9 <font color="darkgreen">&quot;Steam quality corresponding to Critical Heat Flux&quot;</font>;
  Medium.ThermodynamicState bubble <font color="darkgreen">&quot;Bubble point state&quot;</font>;
  Medium.ThermodynamicState dew <font color="darkgreen">&quot;Dew point state&quot;</font>;
<font color="blue">protected </font>
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma[N] <font color="darkgreen">&quot;Raw heat transfer coefficient&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma_ls <font color="darkgreen">&quot;H.t.c. just before bubble point&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma_chf <font color="darkgreen">&quot;H.t.c. just after CHF&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma_corr_left[N] <font color="darkgreen">
    &quot;Correction term to get smooth h.t.c.&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma_corr_right[N] <font color="darkgreen">
    &quot;Correction term to get smooth h.t.c.&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hCHF <font color="darkgreen">
    &quot;Enthalpy corresponding to the Critical Heat Flux&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.DynamicViscosity"
>Medium.DynamicViscosity</A> mu_ls <font color="darkgreen">&quot;Dynamic viscosity at bubble point&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.DynamicViscosity"
>Medium.DynamicViscosity</A> mu_vs <font color="darkgreen">&quot;Dynamic viscosity at dew point&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermalConductivity"
>Medium.ThermalConductivity</A> k_ls <font color="darkgreen">&quot;Thermal conductivity at bubble point&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.ThermalConductivity"
>Medium.ThermalConductivity</A> k_vs <font color="darkgreen">&quot;Thermal conductivity at dew point&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificHeatCapacity"
>Medium.SpecificHeatCapacity</A> cp_ls <font color="darkgreen">&quot;Specific heat capacity at bubble point&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificHeatCapacity"
>Medium.SpecificHeatCapacity</A> cp_vs <font color="darkgreen">&quot;Specific heat capacity at dew point&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SurfaceTension"
>Medium.SurfaceTension</A> sigma <font color="darkgreen">&quot;Surface tension&quot;</font>;
<font color="blue">equation </font>
  hCHF = hl + xCHF*(hv - hl) <font color="darkgreen">
    &quot;Specific enthalpy corresponding to critical heat flux&quot;</font>;
  <font color="darkgreen">// Saturated water and steam properties</font>
  bubble =<font color="red"> Medium.setBubbleState</font>(sat,1);
  dew =<font color="red"> Medium.setDewState</font>(sat,1);
  mu_ls =<font color="red">  Medium.dynamicViscosity</font>(bubble);
  k_ls =<font color="red">  Medium.thermalConductivity</font>(bubble);
  cp_ls =<font color="red"> Medium.heatCapacity_cp</font>(bubble);
  mu_vs =<font color="red">  Medium.dynamicViscosity</font>(dew);
  k_vs =<font color="red">  Medium.thermalConductivity</font>(dew);
  cp_vs =<font color="red"> Medium.heatCapacity_cp</font>(dew);
  sigma =<font color="red"> Medium.surfaceTension</font>(sat);
  <font color="darkgreen">// H.t.c. just outside the nucleate boiling region</font>
  gamma_ls =<font color="red"> f_dittus_boelter</font>(w, Dhyd, A, mu_ls, k_ls, cp_ls);
  gamma_chf =<font color="red"> f_dittus_boelter</font>(w*xCHF, Dhyd, A, mu_vs, k_vs, cp_vs);

  <font color="darkgreen">// Nodal h.t.c. computations</font>
  <font color="blue">for </font>j<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    <font color="darkgreen">  // a) Subcooled liquid </font>
    <font color="darkgreen">  // b) Wet steam after dryout: Dittus-Boelter's correlation considering</font>
    <font color="darkgreen">  //    only the vapour phase</font>
    <font color="darkgreen">  // c) Nucleate boiling: constant h.t.c.</font>
    gamma[j] =<font color="red"> noEvent</font>(<font color="blue">if </font>h[j] &lt; hl<font color="blue"> or </font>h[j] &gt; hv<font color="blue"> then </font>
      <font color="red">f_dittus_boelter</font>(w, Dhyd, A,
      <font color="red">Medium.dynamicViscosity</font>(fluid[j].state),
      <font color="red">Medium.thermalConductivity</font>(fluid[j].state),
      <font color="red">Medium.heatCapacity_cp</font>(fluid[j].state))<font color="blue"> else </font>
    <font color="blue">if </font>h[j] &gt; hCHF<font color="blue"> then </font>
      <font color="red">f_dittus_boelter</font>(w*x[j], Dhyd, A, mu_vs, k_vs, cp_vs)<font color="blue"> else </font>
      <font color="red">f_chen</font>(w, Dhyd, A, mu_ls, k_ls, cp_ls, rhol,
        sigma, rhov, mu_vs,
        wall.T[j] -<font color="red"> Medium.saturationTemperature</font>(p),
        <font color="red">Medium.saturationPressure</font>(wall.T[j]) - p,
        hv - hl, x[j]));
  <font color="blue">end for</font>;

  <font color="darkgreen">// Corrections due to boundaries near the nodes to the left</font>
  <font color="darkgreen">// to achieve continuous h.t.c.</font>
  gamma_corr_left[1]=0;
  <font color="blue">for </font>j<font color="blue"> in </font>2:N<font color="blue"> loop</font>
    gamma_corr_left[j] =<font color="red"> noEvent</font>(
    <font color="blue">if </font>h[j] &lt; hl<font color="blue"> then </font>
      (<font color="blue">if </font>(h[j-1]+h[j])/2 &gt; hl<font color="blue"> then </font>
        ((h[j-1]-hl)/(h[j-1]-h[j])-0.5)*
          (<font color="red">f_chen</font>(w, Dhyd, A, mu_ls, k_ls, cp_ls, rhol,
                  sigma, rhov, mu_vs,
                  wall.T[j] -<font color="red"> Medium.saturationTemperature</font>(p),
                  <font color="red">Medium.saturationPressure</font>(wall.T[j]) - p,
                  hv - hl, 0) - gamma_ls)*
          (<font color="blue">if </font>j==N<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
          0)<font color="blue"> else </font>
    <font color="blue">if </font>h[j] &gt; hCHF<font color="blue"> then </font>
      (<font color="blue">if </font>(h[j-1]+h[j])/2 &lt; hCHF<font color="blue"> then </font>
        ((hCHF-h[j-1])/(h[j]-h[j-1])-0.5)*
          (<font color="red">f_chen</font>(w, Dhyd, A, mu_ls, k_ls, cp_ls, rhol,
                  sigma, rhov, mu_vs,
                  wall.T[j] -<font color="red"> Medium.saturationTemperature</font>(p),
                  <font color="red">Medium.saturationPressure</font>(wall.T[j]) - p,
                  hv - hl, xCHF) - gamma_chf)*
          (<font color="blue">if </font>j==N<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
             0)<font color="blue"> else </font>
      <font color="blue">if </font>(h[j-1]+h[j])/2 &lt; hl<font color="blue"> then </font>
          ((hl-h[j-1])/(h[j]-h[j-1])-0.5)*
            (gamma_ls -<font color="red"> f_chen</font>(w, Dhyd, A, mu_ls, k_ls, cp_ls, rhol,
                               sigma, rhov, mu_vs,
                               wall.T[j] -<font color="red"> Medium.saturationTemperature</font>(p),
                               <font color="red">Medium.saturationPressure</font>(wall.T[j]) - p,
                               hv - hl, 0))*
            (<font color="blue">if </font>j==N<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
      <font color="blue">if </font>(h[j-1]+h[j])/2 &gt; hCHF<font color="blue"> then </font>
          ((h[j-1]-hCHF)/(h[j-1]-h[j])-0.5)*
            (gamma_chf -<font color="red"> f_chen</font>(w, Dhyd, A, mu_ls, k_ls, cp_ls, rhol,
                                sigma, rhov, mu_vs,
                                wall.T[j] -<font color="red"> Medium.saturationTemperature</font>(p),
                                <font color="red">Medium.saturationPressure</font>(wall.T[j]) - p,
                                hv - hl, xCHF))*
            (<font color="blue">if </font>j==N<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
          0);
  <font color="blue">end for</font>;

  <font color="darkgreen">// Compute corrections due to boundaries near the nodes to the right</font>
  <font color="darkgreen">// to achieve continuous h.t.c.</font>
  gamma_corr_right[N]=0;
  <font color="blue">for </font>j<font color="blue"> in </font>1:N-1<font color="blue"> loop</font>
    gamma_corr_right[j] =<font color="red"> noEvent</font>(
    <font color="blue">if </font>h[j] &lt; hl<font color="blue"> then </font>
      (<font color="blue">if </font>(h[j+1]+h[j])/2 &gt; hl<font color="blue"> then </font>
        ((h[j+1]-hl)/(h[j+1]-h[j])-0.5)*
         (<font color="red">f_chen</font>(w, Dhyd, A, mu_ls, k_ls, cp_ls, rhol,
                  sigma, rhov, mu_vs,
                  wall.T[j] -<font color="red"> Medium.saturationTemperature</font>(p),
                  <font color="red">Medium.saturationPressure</font>(wall.T[j]) - p,
                  hv - hl, 0) - gamma_ls)*
         (<font color="blue">if </font>j==1<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
       0)<font color="blue"> else </font>
    <font color="blue">if </font>h[j] &gt; hCHF<font color="blue"> then </font>
      (<font color="blue">if </font>(h[j+1]+h[j])/2 &lt; hCHF<font color="blue"> then </font>
        ((hCHF-h[j+1])/(h[j]-h[j+1])-0.5)*
         (<font color="red">f_chen</font>(w, Dhyd, A, mu_ls, k_ls, cp_ls, rhol,
                  sigma, rhov, mu_vs,
                  wall.T[j] -<font color="red"> Medium.saturationTemperature</font>(p),
                  <font color="red">Medium.saturationPressure</font>(wall.T[j]) - p,
                  hv - hl, xCHF) - gamma_chf)*
         (<font color="blue">if </font>j==1<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
        0)<font color="blue"> else </font>
      <font color="blue">if </font>(h[j+1]+h[j])/2 &lt; hl<font color="blue"> then </font>
        ((hl-h[j+1])/(h[j]-h[j+1])-0.5)*
         (gamma_ls -<font color="red"> f_chen</font>(w, Dhyd, A, mu_ls, k_ls, cp_ls, rhol,
                        sigma, rhov, mu_vs,
                        wall.T[j] -<font color="red"> Medium.saturationTemperature</font>(p),
                        <font color="red">Medium.saturationPressure</font>(wall.T[j]) - p,
                        hv - hl, 0))*
         (<font color="blue">if </font>j==1<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
      <font color="blue">if </font>(h[j+1]+h[j])/2 &gt; hCHF<font color="blue"> then </font>
        ((h[j+1]-hCHF)/(h[j+1]-h[j])-0.5)*
          (gamma_chf -<font color="red"> f_chen</font>(w, Dhyd, A, mu_ls, k_ls, cp_ls, rhol,
                             sigma, rhov, mu_vs,
                             wall.T[j] -<font color="red"> Medium.saturationTemperature</font>(p),
                             <font color="red">Medium.saturationPressure</font>(wall.T[j]) - p,
                             hv - hl, xCHF))*
           (<font color="blue">if </font>j==1<font color="blue"> then </font>2<font color="blue"> else </font>1)<font color="blue"> else </font>
       0);
  <font color="blue">end for</font>;

  wall.gamma = gamma + gamma_corr_left + gamma_corr_right <font color="darkgreen">
    &quot;H.t.c. including smoothing terms&quot;</font>;
<font color="blue">end </font>Flow1D2phChen;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Flow1Dfem<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.Flow1DBaseI.png" ALT="ThermoPower.Water.Flow1Dfem" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Flow1Dfem"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Flow1Dfem</H2>
<B>1-dimensional fluid flow model for water/steam (finite elements)</B><p>
<IMG SRC="ThermoPower.Water.Flow1DBaseD.png" ALT="ThermoPower.Water.Flow1Dfem">
<H3>Information</H3>
<PRE></pre>
<p>This model describes the flow of water or steam in a rigid tube. The basic modelling assumptions are:
<ul><li>The fluid state is always one-phase (i.e. subcooled liquid or superheated steam).
<li>Uniform velocity is assumed on the cross section, leading to a 1-D distributed parameter model.
<li>Turbulent friction is always assumed; a small linear term is added to avoid numerical singularities at zero flowrate. The friction effects are not accurately computed in the laminar and transitional flow regimes, which however should not be an issue in most applications using water or steam as a working fluid.
<li>The model is based on dynamic mass, momentum, and energy balances. The dynamic momentum term can be switched off, to avoid the fast oscillations that can arise from its coupling with the mass balance (sound wave dynamics).
<li>The longitudinal heat diffusion term is neglected.
<li>The energy balance equation is written by assuming a uniform pressure distribution; the pressure drop is lumped either at the inlet or at the outlet.
<li>The fluid flow can exchange thermal power through the lateral surface, which is represented by the <tt>wall</tt> connector. The actual heat flux must be computed by a connected component (heat transfer computation module).
</ul>
<p>The mass, momentum, and energy balance equation are discretised with the finite element method. The state variables are one pressure, one flowrate (optional) and N specific enthalpies.
<p>The turbulent friction factor can be either assumed as a constant, or computed by Colebrook's equation. In the former case, the friction factor can be supplied directly, or given implicitly by a specified operating point. In any case, the multiplicative correction coefficient <tt>Kfc</tt> can be used to modify the friction coefficient, e.g. to fit experimental data.
<p>A small linear pressure drop is added to avoid numerical singularities at low or zero flowrate. The <tt>wnom</tt> parameter must be always specified: the additional linear pressure drop is such that it is equal to the turbulent pressure drop when the flowrate is equal to <tt>wnf*wnom</tt> (the default value is 1% of the nominal flowrate). Increase <tt>wnf</tt> if numerical instabilities occur in tubes with very low pressure drops.
<p>Flow reversal is fully supported.
<p><b>Modelling options</b></p>
<p>Thermal variables (enthalpy, temperature, density) are computed in <tt>N</tt> equally spaced nodes, including the inlet (node 1) and the outlet (node N); <tt>N</tt> must be greater or equal than 2.
<p>The dynamic momentum term is included or neglected depending on the <tt>DynamicMomentum</tt> parameter.
<p> Two parameters are available to tune the numerical method. The stabilisation coefficient <tt>alpha</tt> varies from 0.0 to 1.0; <tt>alpha=0.0</tt> corresponds to a non-stabilised method, which gives rise to non-physical oscillations; the default value of 1.0 corresponds to a stabilised method, with well-damped oscillations. The mass lumping coefficient (<tt>ML</tt>) allows to use a hybrid finite-element/finite-volume discretisation method for the dynamic matrix; the default value <tt>ML=0.0</tt> corresponds to a standard FEM model, <tt>ML=1.0</tt> corresponds to a full finite-volume method, with the associated numerical diffusion effects. Intermediate values can be used.
<p>The following options are available to specify the friction coefficient:
<ul><li><tt>FFtype = FFtypes.Kfnom</tt>: the hydraulic friction coefficient <tt>Kf</tt> is set directly to <tt>Kfnom</tt>.
<li><tt>FFtype = FFtypes.OpPoint</tt>: the hydraulic friction coefficient is specified by a nominal operating point (<tt>wnom</tt>,<tt>dpnom</tt>, <tt>rhonom</tt>).
<li><tt>FFtype = FFtypes.Cfnom</tt>: the friction coefficient is computed by giving the (constant) value of the Fanning friction factor <tt>Cfnom</tt>.
<li><tt>FFtype = FFtypes.Colebrook</tt>: the Fanning friction factor is computed by Colebrook's equation (assuming Re > 2100, e.g. turbulent flow).
<li><tt>FFtype = FFtypes.NoFriction</tt>: no friction is assumed across the pipe.</ul>
<p>If <tt>HydraulicCapacitance = 2</tt> (default option) then the mass buildup term depending on the pressure is lumped at the outlet, while the optional momentum buildup term depending on the flowrate is lumped at the inlet. If <tt>HydraulicCapacitance = 1</tt> the reverse takes place.
<p>Start values for pressure and flowrate are specified by <tt>pstart</tt>, <tt>wstart</tt>. The start values for the node enthalpies are linearly distributed from <tt>hstartin</tt> at the inlet to <tt>hstartout</tt> at the outlet.
<p>A bank of <tt>Nt</tt> identical tubes working in parallel can be modelled by setting <tt>Nt > 1</tt>. The geometric parameters always refer to a <i>single</i> tube.
<p>This models makes the temperature and external heat flow distributions visible through the <tt>wall</tt> connector. If other variables (e.g. the heat transfer coefficient) are needed by external components to compute the actual heat flow, the <tt>wall</tt> connector can be replaced by an extended version of the <tt>DHT</tt> connector.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>StandardWater</TD><TD>Medium model</TD></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>2</TD><TD>Number of nodes for thermal variables</TD></TR>
<TR><TD>Integer</TD><TD>Nt</TD><TD>1</TD><TD>Number of tubes in parallel</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Distance"
>Distance</A></TD><TD>L</TD><TD>&nbsp;</TD><TD>Tube length [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A></TD><TD>H</TD><TD>0</TD><TD>Elevation of outlet over inlet [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Cross-sectional area (single tube) [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>omega</TD><TD>&nbsp;</TD><TD>Perimeter of heat transfer surface (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>Dhyd</TD><TD>&nbsp;</TD><TD>Hydraulic Diameter (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate (total) [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes.Temp"
>Temp</A></TD><TD>FFtype</TD><TD>&nbsp;</TD><TD>Friction Factor Type</TD></TR>
<TR><TD>Real</TD><TD>Kfnom</TD><TD>0</TD><TD>Nominal hydraulic resistance coefficient [Pa.kg/m^3/(kg/s)^2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>0</TD><TD>Nominal pressure drop (friction term only!) [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>0</TD><TD>Nominal inlet density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>Cfnom</TD><TD>0</TD><TD>Nominal Fanning friction factor</TD></TR>
<TR><TD>Real</TD><TD>e</TD><TD>0</TD><TD>Relative roughness (ratio roughness/diameter)</TD></TR>
<TR><TD>Boolean</TD><TD>DynamicMomentum</TD><TD>false</TD><TD>Inertial phenomena accounted for</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_HCtypes.html#ThermoPower.Choices.Flow1D.HCtypes.Temp"
>Temp</A></TD><TD>HydraulicCapacitance</TD><TD>HCtypes.Downstream</TD><TD>Location of the hydraulic capacitance</TD></TR>
<TR><TD>Boolean</TD><TD>avoidInletEnthalpyDerivative</TD><TD>true</TD><TD>Avoid inlet enthalpy derivative</TD></TR>
<TR><TD>Real</TD><TD>wnf</TD><TD>0.01</TD><TD>Fraction of nominal flow rate at which linear friction equals turbulent friction</TD></TR>
<TR><TD>Real</TD><TD>Kfc</TD><TD>1</TD><TD>Friction factor correction coefficient</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHT"
>DHT</A></TD><TD>wall</TD><TD>redeclare ThermoPower.Therma...</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>alpha</TD><TD>1</TD><TD>Numerical stabilization coefficient</TD></TR>
<TR><TD>Real</TD><TD>ML</TD><TD>0</TD><TD>Mass Lumping Coefficient</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartin</TD><TD>1e5</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartout</TD><TD>1e5</TD><TD>Outlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartin</TD><TD>1e5</TD><TD>Inlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartout</TD><TD>1e5</TD><TD>Outlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart[N]</TD><TD>linspace(hstartin, hstartout...</TD><TD>Start value of enthalpy vector (initialized by default) [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHT"
>DHT</A></TD><TD>wall</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Flow1Dfem <font color="darkgreen">
  &quot;1-dimensional fluid flow model for water/steam (finite elements)&quot;</font>

  <font color="blue">extends </font><A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1DBase"
>Flow1DBase</A>;
  <font color="blue">import </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Math.html#Modelica.Math"
>Modelica.Math</A>.*;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes"
>ThermoPower.Choices.Flow1D.FFtypes</A>;
  Medium.BaseProperties fluid[N](<font color="blue">each </font>p(start=pstartin),
    h(start=hstart)) <font color="darkgreen">&quot;Properties of the fluid at the nodes&quot;</font>;
  <font color="blue">parameter </font>Real alpha(
    min=0,
    max=1) = 1 <font color="darkgreen">&quot;Numerical stabilization coefficient&quot;</font>;
  <font color="blue">parameter </font>Real ML(
    min=0,
    max=1) = 0 <font color="darkgreen">&quot;Mass Lumping Coefficient&quot;</font>;
  <font color="blue">constant </font>Real g=Modelica.Constants.g_n;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> omega_hyd <font color="darkgreen">&quot;Hydraulic perimeter (single tube)&quot;</font>;
  Real Kf[N] <font color="darkgreen">&quot;Friction coefficient&quot;</font>;
  Real Kfl[N] <font color="darkgreen">&quot;Linear friction coefficient&quot;</font>;
  Real Cf[N] <font color="darkgreen">&quot;Fanning friction factor&quot;</font>;
  Real dwdt <font color="darkgreen">&quot;Dynamic momentum term&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p(start=<font color="blue">if </font>HydraulicCapacitance==1<font color="blue"> then </font>pstartin<font color="blue"> else </font>
         pstartout) <font color="darkgreen">&quot;Fluid pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> Dpfric <font color="darkgreen">&quot;Pressure drop due to friction&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> Dpstat <font color="darkgreen">&quot;Pressure drop due to static head&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w[N](<font color="blue">each </font>start=wnom/Nt) <font color="darkgreen">&quot;Mass flowrate (single tube)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Velocity</A> u[N] <font color="darkgreen">&quot;Fluid velocity&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlux"
>HeatFlux</A> phi[N] <font color="darkgreen">&quot;External heat flux&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> T[N] <font color="darkgreen">&quot;Fluid temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> h[N](start=hstart) <font color="darkgreen">&quot;Fluid specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Medium.Density</A> rho[N] <font color="darkgreen">&quot;Fluid density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificVolume"
>SpecificVolume</A> v[N] <font color="darkgreen">&quot;Fluid specific volume&quot;</font>;
<font color="blue">protected </font>
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByEnthalpy"
>DerDensityByEnthalpy</A> drdh[N] <font color="darkgreen">&quot;Derivative of density by enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByPressure"
>DerDensityByPressure</A> drdp[N] <font color="darkgreen">&quot;Derivative of density by pressure&quot;</font>;

  Real Y[N, N];
  Real M[N, N];
  Real D[N];
  Real G[N];
  Real B[N, N];
  Real C[N, N];
  Real K[N, N];

  Real alpha_sgn;

  Real YY[N, N];

<font color="blue">equation </font>
  <font color="darkgreen">//All equations are referred to a single tube</font>

  <font color="darkgreen">// Selection of representative pressure and flow rate variables</font>
  <font color="blue">if </font>HydraulicCapacitance == 1<font color="blue"> then</font>
    p = infl.p;
  <font color="blue">else</font>
    p = outfl.p;
  <font color="blue">end if</font>;

  <font color="darkgreen">//Friction factor selection</font>
  omega_hyd = 4*A/Dhyd;
  <font color="blue">for </font>i<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    <font color="blue">if </font>FFtype == FFtypes.Kfnom<font color="blue"> then</font>
      Kf[i] = Kfnom*Kfc;
      Cf[i] = 2*Kf[i]*A^3/(omega_hyd*L);
    <font color="blue">elseif </font>FFtype == FFtypes.OpPoint<font color="blue"> then</font>
      Kf[i] = dpnom*rhonom/(wnom/Nt)^2*Kfc;
      Cf[i] = 2*Kf[i]*A^3/(omega_hyd*L);
    <font color="blue">elseif </font>FFtype == FFtypes.Cfnom<font color="blue"> then</font>
      Kf[i] = Cfnom*omega_hyd*L/(2*A^3)*Kfc;
      Cf[i] = Cfnom*Kfc;
    <font color="blue">elseif </font>FFtype == FFtypes.Colebrook<font color="blue"> then</font>
      Cf[i] =<font color="red"> f_colebrook</font>(w[i], Dhyd/A, e,
        <font color="red">Medium.dynamicViscosity</font>(fluid[i].state))*Kfc;
      Kf[i] = Cf[i]*omega_hyd*L/(2*A^3);
    <font color="blue">elseif </font>FFtype == FFtypes.NoFriction<font color="blue"> then</font>
      Cf[i] = 0;
      Kf[i] = 0;
    <font color="blue">end if</font>;
    <font color="red">assert</font>(Kf[i]&gt;=0, &quot;Negative friction coefficient&quot;);
    Kfl[i] = wnom/Nt*wnf*Kf[i];
  <font color="blue">end for</font>;

  <font color="darkgreen">//Dynamic Momentum [not] accounted for</font>
  <font color="blue">if </font>DynamicMomentum<font color="blue"> then</font>
    <font color="blue">if </font>HydraulicCapacitance == 1<font color="blue"> then</font>
      dwdt = -<font color="red">der</font>(outfl.w)/Nt;
    <font color="blue">else</font>
      dwdt =<font color="red"> der</font>(infl.w)/Nt;
    <font color="blue">end if</font>;
  <font color="blue">else</font>
    dwdt = 0;
  <font color="blue">end if</font>;

  L/A*dwdt + (outfl.p - infl.p) + Dpstat + Dpfric = 0 <font color="darkgreen">
    &quot;Momentum balance equation&quot;</font>;

  w[1] = infl.w/Nt <font color="darkgreen">&quot;Inlet flow rate - single tube&quot;</font>;
  w[N] = -outfl.w/Nt <font color="darkgreen">&quot;Outlet flow rate - single tube&quot;</font>;

  Dpfric = <font color="blue">if </font>FFtype == FFtypes.NoFriction<font color="blue"> then </font>0<font color="blue"> else </font>
    <font color="red">noEvent</font>(<font color="red">sign</font>(infl.w))*<font color="red">sum</font>((Kf[i]*w[i]^2/rho[i] + Kfl[i]*w[i]/
    rho[i])*D[i] <font color="blue">for </font>i<font color="blue"> in </font>1:N)/L <font color="darkgreen">&quot;Pressure drop due to friction&quot;</font>;
  Dpstat = <font color="blue">if </font><font color="red">abs</font>(dzdx)&lt;1e-6<font color="blue"> then </font>0<font color="blue"> else </font>g*dzdx*rho*D <font color="darkgreen">
    &quot;Pressure drop due to static head&quot;</font>;
  ((1 - ML)*Y + ML*YY)*<font color="red">der</font>(h) + B/A*h + C*h/A =<font color="red"> der</font>(p)*G + M*(omega/A)*phi
     + K*w/A <font color="darkgreen">&quot;Energy balance equation&quot;</font>;

  <font color="darkgreen">//Computation of fluid properties </font>
  <font color="blue">for </font>i<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    fluid[i].p=p;
    fluid[i].h=h[i];
    T[i]=fluid[i].T;
    rho[i]=fluid[i].d;
    drdp[i]= <font color="blue">if </font>Medium.singleState<font color="blue"> then </font>0<font color="blue"> else </font>
            <font color="red">Medium.density_derp_h</font>(fluid[i].state);
    drdh[i]=<font color="red">Medium.density_derh_p</font>(fluid[i].state);
    v[i] = 1/rho[i];
    u[i] = w[i]/(rho[i]*A);
  <font color="blue">end for</font>;

  <font color="darkgreen">//Wall energy flux and  temperature</font>
  T = wall.T;
  phi = wall.phi;

  <font color="darkgreen">//Boundary Values of outflowing fluid enthalpies</font>
  h[1] = infl.hAB;
  h[N] = outfl.hBA;

  alpha_sgn = alpha*<font color="red">sign</font>(infl.w - outfl.w);

  <font color="blue">for </font>i<font color="blue"> in </font>1:N - 1<font color="blue"> loop</font>
    (w[i + 1] - w[i]) = -A*l*(<font color="red">der</font>(p)*1/2*(drdp[i + 1] + drdp[i]) + 1/6*(<font color="red">der</font>(
      h[i])*(2*drdh[i] + drdh[i + 1]) +<font color="red"> der</font>(h[i + 1])*(drdh[i] + 2*drdh[i
       + 1]))) <font color="darkgreen">&quot;Mass balance equations&quot;</font>;
  <font color="blue">end for</font>;

  <font color="darkgreen">// Energy equation FEM matrices</font>
  Y[1, 1] = rho[1]*((-l/12)*(2*alpha_sgn - 3)) + rho[2]*((-l/12)*(alpha_sgn
     - 1));
  Y[1, 2] = rho[1]*((-l/12)*(alpha_sgn - 1)) + rho[2]*((-l/12)*(2*alpha_sgn
     - 1));
  Y[N, N] = rho[N - 1]*((l/12)*(alpha_sgn + 1)) + rho[N]*((l/12)*(2*
    alpha_sgn + 3));
  Y[N, N - 1] = rho[N - 1]*((l/12)*(2*alpha_sgn + 1)) + rho[N]*((l/12)*(
    alpha_sgn + 1));
  <font color="blue">if </font>N &gt; 2<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:N - 1<font color="blue"> loop</font>
      Y[i, i - 1] = rho[i - 1]*((l/12)*(2*alpha_sgn + 1)) + rho[i]*((l/12)*
        (alpha_sgn + 1));
      Y[i, i] = rho[i - 1]*((l/12)*(alpha_sgn + 1)) + rho[i]*(l/2) + rho[i
         + 1]*(-(l/12)*(alpha_sgn - 1));
      Y[i, i + 1] = rho[i]*((-l/12)*(alpha_sgn - 1)) + rho[i + 1]*((-l/12)*
        (2*alpha_sgn - 1));
      Y[1, i + 1] = 0;
      Y[N, i - 1] = 0;
      <font color="blue">for </font>j<font color="blue"> in </font>1:(i - 2)<font color="blue"> loop</font>
        Y[i, j] = 0;
      <font color="blue">end for</font>;
      <font color="blue">for </font>j<font color="blue"> in </font>(i + 2):N<font color="blue"> loop</font>
        Y[i, j] = 0;
      <font color="blue">end for</font>;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  <font color="blue">for </font>i<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    <font color="blue">for </font>j<font color="blue"> in </font>1:N<font color="blue"> loop</font>
      YY[i, j] = <font color="blue">if </font>(i &lt;&gt; j)<font color="blue"> then </font>0<font color="blue"> else </font><font color="red">sum</font>(Y[:, j]);
    <font color="blue">end for</font>;
  <font color="blue">end for</font>;

  M[1, 1] = l/3 - l*alpha_sgn/4;
  M[N, N] = l/3 + l*alpha_sgn/4;
  M[1, 2] = l/6 - l*alpha_sgn/4;
  M[N, (N - 1)] = l/6 + l*alpha_sgn/4;
  <font color="blue">if </font>N &gt; 2<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:N - 1<font color="blue"> loop</font>
      M[i, i - 1] = l/6 + l*alpha_sgn/4;
      M[i, i] = 2*l/3;
      M[i, i + 1] = l/6 - l*alpha_sgn/4;
      M[1, i + 1] = 0;
      M[N, i - 1] = 0;
      <font color="blue">for </font>j<font color="blue"> in </font>1:(i - 2)<font color="blue"> loop</font>
        M[i, j] = 0;
      <font color="blue">end for</font>;
      <font color="blue">for </font>j<font color="blue"> in </font>(i + 2):N<font color="blue"> loop</font>
        M[i, j] = 0;
      <font color="blue">end for</font>;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  B[1, 1] = (-1/3 + alpha_sgn/4)*w[1] + (-1/6 + alpha_sgn/4)*w[2];
  B[1, 2] = (1/3 - alpha_sgn/4)*w[1] + (1/6 - alpha_sgn/4)*w[2];
  B[N, N] = (1/6 + alpha_sgn/4)*w[N - 1] + (1/3 + alpha_sgn/4)*w[N];
  B[N, N - 1] = (-1/(6) - alpha_sgn/4)*w[N - 1] + (-1/3 - alpha_sgn/4)*w[N];
  <font color="blue">if </font>N &gt; 2<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:N - 1<font color="blue"> loop</font>
      B[i, i - 1] = (-1/6 - alpha_sgn/4)*w[i - 1] + (-1/3 - alpha_sgn/4)*w[
        i];
      B[i, i] = (1/6 + alpha_sgn/4)*w[i - 1] + (alpha_sgn/2)*w[i] + (-1/6
         + alpha_sgn/4)*w[i + 1];
      B[i, i + 1] = (1/3 - alpha_sgn/4)*w[i] + (1/6 - alpha_sgn/4)*w[i + 1];
      B[1, i + 1] = 0;
      B[N, i - 1] = 0;
      <font color="blue">for </font>j<font color="blue"> in </font>1:(i - 2)<font color="blue"> loop</font>
        B[i, j] = 0;
      <font color="blue">end for</font>;
      <font color="blue">for </font>j<font color="blue"> in </font>(i + 2):N<font color="blue"> loop</font>
        B[i, j] = 0;
      <font color="blue">end for</font>;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  <font color="blue">if </font>Medium.singleState<font color="blue"> then</font>
    G=<font color="red">zeros</font>(N) <font color="darkgreen">&quot;No influence of pressure&quot;</font>;
  <font color="blue">else</font>
    G[1] = l/2*(1 - alpha_sgn);
    G[N] = l/2*(1 + alpha_sgn);
    <font color="blue">if </font>N &gt; 2<font color="blue"> then</font>
      <font color="blue">for </font>i<font color="blue"> in </font>2:N - 1<font color="blue"> loop</font>
        G[i] = l;
      <font color="blue">end for</font>;
    <font color="blue">end if</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">//boundary condition matrices</font>
  C[1, 1] = <font color="blue">if </font><font color="red">noEvent</font>(infl.w &gt;= 0)<font color="blue"> then </font>(1 - alpha_sgn/2)*w[1]<font color="blue"> else </font>0;
  C[N, N] = <font color="blue">if </font><font color="red">noEvent</font>(outfl.w &gt;= 0)<font color="blue"> then </font>-(1 + alpha_sgn/2)*w[N]<font color="blue"> else </font>0;
  C[N, 1] = 0;
  C[1, N] = 0;
  <font color="blue">if </font>(N &gt; 2)<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:(N - 1)<font color="blue"> loop</font>
      C[1, i] = 0;
      C[N, i] = 0;
      <font color="blue">for </font>j<font color="blue"> in </font>1:N<font color="blue"> loop</font>
        C[i, j] = 0;
      <font color="blue">end for</font>;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  K[1, 1] = <font color="blue">if </font><font color="red">noEvent</font>(infl.w &gt;= 0)<font color="blue"> then </font>(1 - alpha_sgn/2)*infl.hBA<font color="blue"> else </font>0;
  K[N, N] = <font color="blue">if </font><font color="red">noEvent</font>(outfl.w &gt;= 0)<font color="blue"> then </font>-(1 + alpha_sgn/2)*outfl.hAB<font color="blue"> else </font>
          0;
  K[N, 1] = 0;
  K[1, N] = 0;
  <font color="blue">if </font>(N &gt; 2)<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:(N - 1)<font color="blue"> loop</font>
      K[1, i] = 0;
      K[N, i] = 0;
      <font color="blue">for </font>j<font color="blue"> in </font>1:N<font color="blue"> loop</font>
        K[i, j] = 0;
      <font color="blue">end for</font>;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Momentum and Mass balance equation matrices</font>
  D[1] = l/2;
  D[N] = l/2;
  <font color="blue">if </font>N &gt; 2<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:N - 1<font color="blue"> loop</font>
      D[i] = l;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  Q = Nt*l*omega*D*phi <font color="darkgreen">&quot;Total heat flow through lateral boundary&quot;</font>;
  Tr=<font color="red">noEvent</font>(<font color="red">sum</font>(rho)*A*l/<font color="red">max</font>(infl.w/Nt,Modelica.Constants.eps)) <font color="darkgreen">
    &quot;Residence time&quot;</font>;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="red">der</font>(h) =<font color="red"> zeros</font>(N);
    <font color="blue">if </font>(<font color="blue">not </font>Medium.singleState)<font color="blue"> then</font>
      <font color="red">der</font>(p) = 0;
    <font color="blue">end if</font>;
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyStateNoP<font color="blue"> then</font>
    <font color="red">der</font>(h) =<font color="red"> zeros</font>(N);
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;
<font color="blue">end </font>Flow1Dfem;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Flow1Dfem2ph<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.Flow1DBaseI.png" ALT="ThermoPower.Water.Flow1Dfem2ph" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Flow1Dfem2ph"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Flow1Dfem2ph</H2>
<B>1-dimensional fluid flow model for water/steam (finite elements)</B><p>
<IMG SRC="ThermoPower.Water.Flow1DBaseD.png" ALT="ThermoPower.Water.Flow1Dfem2ph">
<H3>Information</H3>
<PRE></pre>
<p>This model describes the flow of water or steam in a rigid tube. The basic modelling assumptions are:
<ul><li>The fluid state is either one-phase, or a two-phase mixture.
<li>In case of two-phase flow, the same velocity is assumed for both phases (homogeneous model).
<li>Uniform velocity is assumed on the cross section, leading to a 1-D distributed parameter model.
<li>Turbulent friction is always assumed; a small linear term is added to avoid numerical singularities at zero flowrate. The friction effects are not accurately computed in the laminar and transitional flow regimes, which however should not be an issue in most applications using water or steam as a working fluid.
<li>The model is based on dynamic mass, momentum, and energy balances. The dynamic momentum term can be switched off, to avoid the fast oscillations that can arise from its coupling with the mass balance (sound wave dynamics).
<li>The longitudinal heat diffusion term is neglected.
<li>The energy balance equation is written by assuming a uniform pressure distribution; the pressure drop is lumped either at the inlet or at the outlet.
<li>The fluid flow can exchange thermal power through the lateral surface, which is represented by the <tt>wall</tt> connector. The actual heat flux must be computed by a connected component (heat transfer computation module).
</ul>
<p>The mass, momentum, and energy balance equation are discretised with the Finite Element Method (Stabilised Galerkin Least Squares). The state variables are one pressure, one flowrate (optional) and N specific enthalpies.
<p>The turbulent friction factor can be either assumed as a constant, or computed by Colebrook's equation. In the former case, the friction factor can be supplied directly, or given implicitly by a specified operating point. In any case, the multiplicative correction coefficient <tt>Kfc</tt> can be used to modify the friction coefficient, e.g. to fit experimental data.
<p>A small linear pressure drop is added to avoid numerical singularities at low or zero flowrate. The <tt>wnom</tt> parameter must be always specified: the additional linear pressure drop is such that it is equal to the turbulent pressure drop when the flowrate is equal to <tt>wnf*wnom</tt> (the default value is 1% of the nominal flowrate). Increase <tt>wnf</tt> if numerical instabilities occur in tubes with very low pressure drops.
<p>Flow reversal is fully supported.
<p><b>Modelling options</b></p>
<p>Thermal variables (enthalpy, temperature, density) are computed in <tt>N</tt> equally spaced nodes, including the inlet (node 1) and the outlet (node N); <tt>N</tt> must be greater or equal than 2.
<p>The dynamic momentum term is included or neglected depending on the <tt>DynamicMomentum</tt> parameter.
<p> Two parameters are available to tune the numerical method. The stabilisation coefficient <tt>alpha</tt> varies from 0.0 to 1.0; <tt>alpha=0.0</tt> corresponds to a non-stabilised method, which gives rise to non-physical oscillations; the default value of 1.0 corresponds to a stabilised method, with well-damped oscillations. The mass lumping coefficient (<tt>ML</tt>) allows to use a hybrid finite-element/finite-volume discretisation method for the dynamic matrix; the default value <tt>ML=0.0</tt> corresponds to a standard FEM model, <tt>ML=1.0</tt> corresponds to a full finite-volume method, with the associated numerical diffusion effects. Intermediate values can be used.
<p>The following options are available to specify the friction coefficient:
<ul><li><tt>FFtype = FFtypes.Kfnom</tt>: the hydraulic friction coefficient <tt>Kf</tt> is set directly to <tt>Kfnom</tt>.
<li><tt>FFtype = FFtypes.OpPoint</tt>: the hydraulic friction coefficient is specified by a nominal operating point (<tt>wnom</tt>,<tt>dpnom</tt>, <tt>rhonom</tt>).
<li><tt>FFtype = FFtypes.Cfnom</tt>: the friction coefficient is computed by giving the (constant) value of the Fanning friction factor <tt>Cfnom</tt>.
<li><tt>FFtype = FFtypes.Colebrook</tt>: the Fanning friction factor is computed by Colebrook's equation (assuming Re > 2100, e.g. turbulent flow).
<li><tt>FFtype = FFtypes.NoFriction</tt>: no friction is assumed across the pipe.</ul><p>If <tt>HydraulicCapacitance = 2</tt> (default option) then the mass buildup term depending on the pressure is lumped at the outlet, while the optional momentum buildup term depending on the flowrate is lumped at the inlet. If <tt>HydraulicCapacitance = 1</tt> the reverse takes place.
<p>Start values for pressure and flowrate are specified by <tt>pstart</tt>, <tt>wstart</tt>. The start values for the node enthalpies are linearly distributed from <tt>hstartin</tt> at the inlet to <tt>hstartout</tt> at the outlet.
<p>A bank of <tt>Nt</tt> identical tubes working in parallel can be modelled by setting <tt>Nt > 1</tt>. The geometric parameters always refer to a <i>single</i> tube.
<p>This models makes the temperature and external heat flow distributions visible through the <tt>wall</tt> connector. If other variables (e.g. the heat transfer coefficient) are needed by external components to compute the actual heat flow, the <tt>wall</tt> connector can be replaced by an extended version of the <tt>DHT</tt> connector.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>2</TD><TD>Number of nodes for thermal variables</TD></TR>
<TR><TD>Integer</TD><TD>Nt</TD><TD>1</TD><TD>Number of tubes in parallel</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Distance"
>Distance</A></TD><TD>L</TD><TD>&nbsp;</TD><TD>Tube length [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A></TD><TD>H</TD><TD>0</TD><TD>Elevation of outlet over inlet [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Cross-sectional area (single tube) [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>omega</TD><TD>&nbsp;</TD><TD>Perimeter of heat transfer surface (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>Dhyd</TD><TD>&nbsp;</TD><TD>Hydraulic Diameter (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate (total) [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes.Temp"
>Temp</A></TD><TD>FFtype</TD><TD>&nbsp;</TD><TD>Friction Factor Type</TD></TR>
<TR><TD>Real</TD><TD>Kfnom</TD><TD>0</TD><TD>Nominal hydraulic resistance coefficient [Pa.kg/m^3/(kg/s)^2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>0</TD><TD>Nominal pressure drop (friction term only!) [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>0</TD><TD>Nominal inlet density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>Cfnom</TD><TD>0</TD><TD>Nominal Fanning friction factor</TD></TR>
<TR><TD>Real</TD><TD>e</TD><TD>0</TD><TD>Relative roughness (ratio roughness/diameter)</TD></TR>
<TR><TD>Boolean</TD><TD>DynamicMomentum</TD><TD>false</TD><TD>Inertial phenomena accounted for</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Flow1D_HCtypes.html#ThermoPower.Choices.Flow1D.HCtypes.Temp"
>Temp</A></TD><TD>HydraulicCapacitance</TD><TD>HCtypes.Downstream</TD><TD>Location of the hydraulic capacitance</TD></TR>
<TR><TD>Boolean</TD><TD>avoidInletEnthalpyDerivative</TD><TD>true</TD><TD>Avoid inlet enthalpy derivative</TD></TR>
<TR><TD>Real</TD><TD>wnf</TD><TD>0.01</TD><TD>Fraction of nominal flow rate at which linear friction equals turbulent friction</TD></TR>
<TR><TD>Real</TD><TD>Kfc</TD><TD>1</TD><TD>Friction factor correction coefficient</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHT"
>DHT</A></TD><TD>wall</TD><TD>redeclare ThermoPower.Therma...</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>alpha</TD><TD>1</TD><TD>Numerical stabilization coefficient</TD></TR>
<TR><TD>Real</TD><TD>ML</TD><TD>0.2</TD><TD>Mass Lumping Coefficient</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartin</TD><TD>1e5</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartout</TD><TD>1e5</TD><TD>Outlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartin</TD><TD>1e5</TD><TD>Inlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartout</TD><TD>1e5</TD><TD>Outlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart[N]</TD><TD>linspace(hstartin, hstartout...</TD><TD>Start value of enthalpy vector (initialized by default) [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Thermal.html#ThermoPower.Thermal.DHT"
>DHT</A></TD><TD>wall</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Flow1Dfem2ph <font color="darkgreen">
  &quot;1-dimensional fluid flow model for water/steam (finite elements)&quot;</font>
  <font color="blue">import </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Math.html#Modelica.Math"
>Modelica.Math</A>.*;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_Flow1D_FFtypes.html#ThermoPower.Choices.Flow1D.FFtypes"
>ThermoPower.Choices.Flow1D.FFtypes</A>;
  <font color="blue">extends </font><A HREF="ThermoPower_Water.html#ThermoPower.Water.Flow1DBase"
>Flow1DBase</A>(<font color="blue">redeclare </font><font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
      Modelica.Media.Interfaces.PartialTwoPhaseMedium <font color="darkgreen">&quot;Medium model&quot;</font>);
  <font color="blue">package</font> SmoothMedium=<A HREF="ThermoPower_Water_Medium.html#ThermoPower.Water.Flow1DBase.Medium"
>Medium</A>(<font color="blue">final </font>smoothModel = true);
  <font color="blue">parameter </font>Real alpha(
    min=0,
    max=2) = 1 <font color="darkgreen">&quot;Numerical stabilization coefficient&quot;</font>;
  <font color="blue">parameter </font>Real ML(
    min=0,
    max=1) = 0.2 <font color="darkgreen">&quot;Mass Lumping Coefficient&quot;</font>;
  <font color="blue">constant </font>Real g=Modelica.Constants.g_n;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pzero=10 <font color="darkgreen">&quot;Small deltap for calculations&quot;</font>;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pc=Medium.fluidConstants[1].criticalPressure;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hzero=1e-3;
  SmoothMedium.BaseProperties fluid[N] <font color="darkgreen">&quot;Properties of the fluid at the nodes&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialTwoPhaseMedium.html#Modelica.Media.Interfaces.PartialTwoPhaseMedium.SaturationProperties"
>Medium.SaturationProperties</A> sat <font color="darkgreen">&quot;Properties of saturated fluid&quot;</font>;
  Medium.ThermodynamicState dew <font color="darkgreen">&quot;Thermodynamic state at dewpoint&quot;</font>;
  Medium.ThermodynamicState bubble <font color="darkgreen">&quot;Thermodynamic state at bubblepoint&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> omega_hyd <font color="darkgreen">&quot;Hydraulic perimeter (single tube)&quot;</font>;
  Real dwdt <font color="darkgreen">&quot;Dynamic momentum term&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p(start=<font color="blue">if </font>HydraulicCapacitance==1<font color="blue"> then </font>pstartin<font color="blue"> else </font>
         pstartout) <font color="darkgreen">&quot;Fluid pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> Dpfric <font color="darkgreen">&quot;Pressure drop due to friction&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> Dpstat <font color="darkgreen">&quot;Pressure drop due to static head&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w[N](start=wnom*<font color="red">ones</font>(N)) <font color="darkgreen">&quot;Mass flowrate (single tube)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Velocity"
>Velocity</A> u[N] <font color="darkgreen">&quot;Fluid velocity&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlux"
>HeatFlux</A> phi[N] <font color="darkgreen">&quot;External heat flux&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> T[N] <font color="darkgreen">&quot;Fluid temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> h[N](start=hstart) <font color="darkgreen">&quot;Fluid specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Medium.Density</A> rho[N] <font color="darkgreen">&quot;Fluid density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificVolume"
>SpecificVolume</A> v[N] <font color="darkgreen">&quot;Fluid specific volume&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> Ts <font color="darkgreen">&quot;Saturation temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hl <font color="darkgreen">&quot;Saturated liquid specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hv <font color="darkgreen">&quot;Saturated vapour specific enthalpy&quot;</font>;
  Real x[N] <font color="darkgreen">&quot;Steam quality&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.LiquidDensity"
>LiquidDensity</A> rhol <font color="darkgreen">&quot;Saturated liquid density&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.GasDensity"
>GasDensity</A> rhov <font color="darkgreen">&quot;Saturated vapour density&quot;</font>;
<font color="blue">protected </font>
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByEnthalpy"
>DerDensityByEnthalpy</A> drdh[N] <font color="darkgreen">&quot;Derivative of density by enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByPressure"
>DerDensityByPressure</A> drdp[N] <font color="darkgreen">&quot;Derivative of density by pressure&quot;</font>;

  Real Kf[N] <font color="darkgreen">&quot;Friction coefficient&quot;</font>;
  Real Kfl[N] <font color="darkgreen">&quot;Linear friction coefficient&quot;</font>;
  Real Cf[N] <font color="darkgreen">&quot;Fanning friction factor&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByPressure"
>DerDensityByPressure</A> drl_dp <font color="darkgreen">
    &quot;Derivative of liquid density by pressure just before saturation&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByPressure"
>DerDensityByPressure</A> drv_dp <font color="darkgreen">
    &quot;Derivative of vapour density by pressure just before saturation&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByEnthalpy"
>DerDensityByEnthalpy</A> drl_dh <font color="darkgreen">
    &quot;Derivative of liquid density by enthalpy just before saturation&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DerDensityByEnthalpy"
>DerDensityByEnthalpy</A> drv_dh <font color="darkgreen">
    &quot;Derivative of vapour density by enthalpy just before saturation&quot;</font>;

  Real dhl <font color="darkgreen">&quot;Derivative of saturated liquid enthalpy by pressure&quot;</font>;
  Real dhv <font color="darkgreen">&quot;Derivative of saturated vapour enthalpy by pressure&quot;</font>;

  Real drl <font color="darkgreen">&quot;Derivative of saturatd liquid density by pressure&quot;</font>;
  Real drv <font color="darkgreen">&quot;Derivative of saturated vapour density by pressure&quot;</font>;

  <A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A> rhos[N - 1];
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> ws[N - 1];
  Real rs[N - 1];

  Real Y[N, N];
  Real YY[N, N];

  Real Y2ph[N, N];
  Real M[N, N];
  Real D[N];
  Real G[N];
  Real B[N, N];
  Real B2ph[N, N];
  Real C[N, N];
  Real K[N, N];

  Real by[8, N];
  Real beta[8, N];
  <font color="darkgreen">//coefficients matrix for 2-phases augmented FEM matrices </font>
  Real alpha_sgn;

  Real gamma_rho[N - 1];
  Real gamma_w[N - 1];
  <font color="darkgreen">//coefficients for gamma functions</font>

  Real a;
  Real b;
  Real betap;
  Real c;
  Real d;
  Real ee[N - 1];
  Real f[N - 1];

  Real dMbif[N - 1];
  Real dMmono[N - 1];

<font color="blue">equation </font>
  <font color="darkgreen">//All equations are referred to a single tube</font>

  <font color="darkgreen">// Selection of representative pressure and flow rate variables</font>
  <font color="blue">if </font>HydraulicCapacitance == 1<font color="blue"> then</font>
    p = infl.p;
  <font color="blue">else</font>
    p = outfl.p;
  <font color="blue">end if</font>;

  <font color="darkgreen">//Friction factor calculation</font>
  omega_hyd = 4*A/Dhyd;
  <font color="blue">for </font>i<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    <font color="blue">if </font>FFtype == FFtypes.Kfnom<font color="blue"> then</font>
      Kf[i] = Kfnom*Kfc;
      Cf[i] = 2*Kf[i]*A^3/(omega_hyd*L);
    <font color="blue">elseif </font>FFtype == FFtypes.OpPoint<font color="blue"> then</font>
      Kf[i] = dpnom*rhonom/(wnom/Nt)^2*Kfc;
      Cf[i] = 2*Kf[i]*A^3/(omega_hyd*L);
    <font color="blue">elseif </font>FFtype == FFtypes.Cfnom<font color="blue"> then</font>
      Kf[i] = Cfnom*omega_hyd*L/(2*A^3)*Kfc;
      Cf[i] = Cfnom*Kfc;
    <font color="blue">elseif </font>FFtype == FFtypes.Colebrook<font color="blue"> then</font>
      <font color="blue">if </font><font color="red">noEvent</font>(h[i] &lt; hl<font color="blue"> or </font>h[i] &gt; hv)<font color="blue"> then</font>
        Cf[i] =<font color="red"> f_colebrook</font>(w[i], Dhyd/A, e,
          <font color="red">Medium.dynamicViscosity</font>(fluid[i].state))*Kfc;
      <font color="blue">else</font>
        Cf[i] =<font color="red"> f_colebrook_2ph</font>(w[i], Dhyd/A, e,
          <font color="red">Medium.dynamicViscosity</font>(bubble),
          <font color="red">Medium.dynamicViscosity</font>(dew), x[i])*Kfc;
      <font color="blue">end if</font>;
      Kf[i] = Cf[i]*omega_hyd*L/(2*A^3);
    <font color="blue">elseif </font>FFtype == FFtypes.NoFriction<font color="blue"> then</font>
      Cf[i] = 0;
      Kf[i] = 0;
    <font color="blue">end if</font>;
    <font color="red">assert</font>(Kf[i]&gt;=0, &quot;Negative friction coefficient&quot;);
    Kfl[i] = wnom/Nt*wnf*Kf[i];
  <font color="blue">end for</font>;

  <font color="darkgreen">//Dynamic Momentum [not] accounted for</font>
  <font color="blue">if </font>DynamicMomentum<font color="blue"> then</font>
    <font color="blue">if </font>HydraulicCapacitance == 1<font color="blue"> then</font>
      dwdt = -<font color="red">der</font>(outfl.w)/Nt;
    <font color="blue">else</font>
      dwdt =<font color="red"> der</font>(infl.w)/Nt;
    <font color="blue">end if</font>;

  <font color="blue">else</font>
    dwdt = 0;
  <font color="blue">end if</font>;

  <font color="darkgreen">//Momentum balance equation</font>
  L/A*dwdt + (outfl.p - infl.p) + Dpstat + Dpfric = 0;

  w[1] = infl.w/Nt;
  w[N] = -outfl.w/Nt;

  Dpfric = <font color="blue">if </font>FFtype == FFtypes.NoFriction<font color="blue"> then </font>0<font color="blue"> else </font>
    <font color="red">sum</font>((Kf[i]*w[i]*<font color="red">noEvent</font>(<font color="red">abs</font>(w[i]))/rho[i] + Kfl[i]*w[i]/rho[i])*
    D[i] <font color="blue">for </font>i<font color="blue"> in </font>1:N)/L;
  Dpstat = <font color="blue">if </font><font color="red">abs</font>(dzdx)&lt;1e-6<font color="blue"> then </font>0<font color="blue"> else </font>g*dzdx*rho*D <font color="darkgreen">
    &quot;Pressure drop due to static head&quot;</font>;

  <font color="darkgreen">//Energy balance equations </font>
  l/12*((1 - ML)*Y + ML*YY + 0*Y2ph)*<font color="red">der</font>(h) + (1/A)*(B + 0*B2ph)*h + C*h/A
    =<font color="red"> der</font>(p)*G + M*(omega/A)*phi + K*w/A;

<font color="darkgreen">//  (Ts,rhol,rhov,hl,hv,drl_dp,drv_dp,drl_dh,drv_dh,dhl,dhv,drl,drv) =</font>
<font color="darkgreen">//  propsat_p_2der(noEvent(min(p, pc - pzero)));</font>

  sat.psat=p;
  sat.Tsat=<font color="red">Medium.saturationTemperature</font>(p);
  Ts=sat.Tsat;
  bubble=<font color="red">Medium.setBubbleState</font>(sat);
  dew=<font color="red">Medium.setDewState</font>(sat);
  rhol=<font color="red">Medium.bubbleDensity</font>(sat);
  rhov=<font color="red">Medium.dewDensity</font>(sat);
  hl=<font color="red">Medium.bubbleEnthalpy</font>(sat);
  hv=<font color="red">Medium.dewEnthalpy</font>(sat);
  drl=<font color="red">Medium.dBubbleDensity_dPressure</font>(sat);
  drv=<font color="red">Medium.dDewDensity_dPressure</font>(sat);
  dhl=<font color="red">Medium.dBubbleEnthalpy_dPressure</font>(sat);
  dhv=<font color="red">Medium.dDewEnthalpy_dPressure</font>(sat);
  drl_dp=<font color="red">Medium.density_derp_h</font>(bubble);
  drv_dp=<font color="red">Medium.density_derp_h</font>(dew);
  drl_dh=<font color="red">Medium.density_derh_p</font>(bubble);
  drv_dh=<font color="red">Medium.density_derh_p</font>(dew);

  a = ((hv - hl)*(rhol^2*drv + rhov^2*drl) + rhov*rhol*(rhol - rhov)*(dhv
     - dhl))/(rhol - rhov)^2;

  betap = ((rhol - rhov)*(rhov*dhv - rhol*dhl) + (hv - hl)*(rhol*drv - rhov
    *drl))/(rhol - rhov)^2;

  b = a*c + d*betap;

  c = (rhov*hv - rhol*hl)/(rhol - rhov);

  d = -rhol*rhov*(hv - hl)/(rhol - rhov);

  <font color="darkgreen">//Computation of fluid properties </font>
  <font color="blue">for </font>i<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    fluid[i].p=p;
    fluid[i].h=h[i];
    T[i]=fluid[i].T;
    rho[i]=fluid[i].d;
    drdp[i]=<font color="red">Medium.density_derp_h</font>(fluid[i].state);
    drdh[i]=<font color="red">Medium.density_derh_p</font>(fluid[i].state);
    v[i] = 1/rho[i];
    u[i] = w[i]/(rho[i]*A);
    x[i]=<font color="red">noEvent</font>(<font color="blue">if </font>h[i]&lt;=hl<font color="blue"> then </font>0<font color="blue"> else </font>
              <font color="blue">if </font>h[i]&gt;=hv<font color="blue"> then </font>1<font color="blue"> else </font>(h[i]-hl)/(hv-hl));
  <font color="blue">end for</font>;

  <font color="darkgreen">//Wall energy flux and  temperature</font>
  T = wall.T;
  phi = wall.phi;

  <font color="darkgreen">//Boundary Values</font>

  h[1] = infl.hAB;
  h[N] = outfl.hBA;

  alpha_sgn = alpha*<font color="red">sign</font>(infl.w - outfl.w);

  <font color="darkgreen">//phase change determination</font>
  <font color="blue">for </font>i<font color="blue"> in </font>1:N - 1<font color="blue"> loop</font>
    (w[i] - w[i + 1]) = dMmono[i] + dMbif[i];
    <font color="blue">if </font><font color="red">noEvent</font>(<font color="red">abs</font>(h[i + 1] - h[i]) &lt; hzero)<font color="blue"> then</font>

      rs[i] = 0;
      rhos[i] = 0;
      gamma_rho[i] = 0;

      gamma_w[i] = 0;
      ws[i] = 0;

      dMmono[i] = A*l*(<font color="red">der</font>(p)*1/2*(drdp[i + 1] + drdp[i]) + 1/6*(<font color="red">der</font>(h[i])*
        (2*drdh[i] + drdh[i + 1]) +<font color="red"> der</font>(h[i + 1])*(drdh[i] + 2*drdh[i + 1])));
      dMbif[i] = 0;

      ee[i] = 0;
      f[i] = 0;
    <font color="blue">else</font>

      <font color="blue">if </font><font color="red">noEvent</font>((h[i] &lt; hl)<font color="blue"> and </font>(h[i + 1] &gt;= hl)<font color="blue"> and </font>(h[i + 1] &lt;= hv))<font color="blue"> then</font>
        <font color="darkgreen">//liquid - two phase</font>

        rs[i] = (hl - h[i])/(h[i + 1] - h[i]);
        rhos[i] = rhol;
        gamma_rho[i] = (rhos[i] - rho[i]*(1 - rs[i]) - rho[i + 1]*rs[i]);

        gamma_w[i] = (ws[i] - w[i]*(1 - rs[i]) - w[i + 1]*rs[i]);

        (w[i] - ws[i]) = dMmono[i];

        dMmono[i] = A*rs[i]*l*(<font color="red">der</font>(p)*1/2*(drl_dp + drdp[i]) + 1/6*(<font color="red">der</font>(h[i])
          *(2*drdh[i] + drl_dh) + (<font color="red">der</font>(h[i])*(1 - rs[i]) +<font color="red"> der</font>(h[i + 1])*rs[
          i])*(drdh[i] + 2*drl_dh)));

        dMbif[i] = A*(1 - rs[i])*l/(h[i + 1] - hl)*(<font color="red">der</font>(p)*((b - a*c)*(h[i
           + 1] - hl)/((c + h[i + 1])*(c + hl)) + a*<font color="red">log</font>((c + h[i + 1])/(c
           + hl))) + ((d*f[i] - d*c*ee[i])*(h[i + 1] - hl)/((c + h[i + 1])*
          (c + hl)) + d*ee[i]*<font color="red">log</font>((c + h[i + 1])/(c + hl))));

        <font color="darkgreen">//(der(h[i + 1])*rs[i] + der(h[i])*(1 - rs[i])) = 0;</font>

        ee[i] = (<font color="red">der</font>(h[i + 1]) - (<font color="red">der</font>(h[i + 1])*rs[i] +<font color="red"> der</font>(h[i])*(1 - rs[i])))
          /(h[i + 1] - hl);
        f[i] = ((<font color="red">der</font>(h[i + 1])*rs[i] +<font color="red"> der</font>(h[i])*(1 - rs[i]))*h[i + 1] -
          <font color="red">der</font>(h[i + 1])*hl)/(h[i + 1] - hl);

      <font color="blue">elseif </font><font color="red">noEvent</font>((h[i] &gt;= hl)<font color="blue"> and </font>(h[i] &lt;= hv)<font color="blue"> and </font>(h[i + 1] &lt; hl))<font color="blue"> then</font>
        <font color="darkgreen">//two phase-liquid</font>

        rs[i] = (hl - h[i])/(h[i + 1] - h[i]);
        rhos[i] = rhol;
        gamma_rho[i] = (rhos[i] - rho[i]*(1 - rs[i]) - rho[i + 1]*rs[i]);

        gamma_w[i] = (ws[i] - w[i]*(1 - rs[i]) - w[i + 1]*rs[i]);

        (w[i] - ws[i]) = dMbif[i];

        dMmono[i] = A*(1 - rs[i])*l*(<font color="red">der</font>(p)*1/2*(drdp[i + 1] + drl_dp) + 1/
          6*(<font color="red">der</font>(h[i])*(2*drl_dh + drdh[i + 1]) + (<font color="red">der</font>(h[i + 1])*rs[i] +
          <font color="red">der</font>(h[i])*(1 - rs[i]))*(drl_dh + 2*drdh[i + 1])));

        dMbif[i] = A*rs[i]*l/(hl - h[i])*(<font color="red">der</font>(p)*((b - a*c)*(hl - h[i])/((c
           + hl)*(c + h[i])) + a*<font color="red">log</font>((c + hl)/(c + h[i]))) + ((d*f[i] - d*c
          *ee[i])*(hl - h[i])/((c + hl)*(c + h[i])) + d*ee[i]*<font color="red">log</font>((c + hl)/
          (c + h[i]))));

        ee[i] = ((<font color="red">der</font>(h[i + 1])*rs[i] +<font color="red"> der</font>(h[i])*(1 - rs[i])) -<font color="red"> der</font>(h[i]))
          /(hl - h[i]);
        f[i] = (<font color="red">der</font>(h[i])*hl - (<font color="red">der</font>(h[i + 1])*rs[i] +<font color="red"> der</font>(h[i])*(1 - rs[i]))
          *h[i])/(hl - h[i]);

      <font color="blue">elseif </font><font color="red">noEvent</font>((h[i] &gt;= hl)<font color="blue"> and </font>(h[i] &lt;= hv)<font color="blue"> and </font>(h[i + 1] &gt; hv))<font color="blue"> then</font>
        <font color="darkgreen">//two phase - vapour</font>

        rs[i] = (hv - h[i])/(h[i + 1] - h[i]);
        rhos[i] = rhov;
        gamma_rho[i] = (rhos[i] - rho[i]*(1 - rs[i]) - rho[i + 1]*rs[i]);

        gamma_w[i] = (ws[i] - w[i]*(1 - rs[i]) - w[i + 1]*rs[i]);
        (w[i] - ws[i]) = dMbif[i];

        dMmono[i] = A*(1 - rs[i])*l*(<font color="red">der</font>(p)*1/2*(drdp[i + 1] + drv_dp) + 1/
          6*(<font color="red">der</font>(h[i])*(2*drv_dh + drdh[i + 1]) + (<font color="red">der</font>(h[i + 1])*rs[i] +
          <font color="red">der</font>(h[i])*(1 - rs[i]))*(drv_dh + 2*drdh[i + 1])));

        dMbif[i] = A*rs[i]*l/(hv - h[i])*(<font color="red">der</font>(p)*((b - a*c)*(hv - h[i])/((c
           + hv)*(c + h[i])) + a*<font color="red">log</font>((c + hv)/(c + h[i]))) + ((d*f[i] - d*c
          *ee[i])*(hv - h[i])/((c + hv)*(c + h[i])) + d*ee[i]*<font color="red">log</font>((c + hv)/
          (c + h[i]))));

        ee[i] = ((<font color="red">der</font>(h[i + 1])*rs[i] +<font color="red"> der</font>(h[i])*(1 - rs[i])) -<font color="red"> der</font>(h[i]))
          /(hv - h[i]);
        f[i] = (<font color="red">der</font>(h[i])*hv - (<font color="red">der</font>(h[i + 1])*rs[i] +<font color="red"> der</font>(h[i])*(1 - rs[i]))
          *h[i])/(hv - h[i]);

      <font color="blue">elseif </font><font color="red">noEvent</font>((h[i] &gt; hv)<font color="blue"> and </font>(h[i + 1] &gt;= hl)<font color="blue"> and </font>(h[i + 1] &lt;= hv))<font color="blue"> then</font>
        <font color="darkgreen">// vapour - two phase</font>

        rs[i] = (hv - h[i])/(h[i + 1] - h[i]);
        rhos[i] = rhov;
        gamma_rho[i] = (rhos[i] - rho[i]*(1 - rs[i]) - rho[i + 1]*rs[i]);

        gamma_w[i] = (ws[i] - w[i]*(1 - rs[i]) - w[i + 1]*rs[i]);
        (w[i] - ws[i]) = dMmono[i];

        dMmono[i] = A*rs[i]*l*(<font color="red">der</font>(p)*1/2*(drv_dp + drdp[i]) + 1/6*(<font color="red">der</font>(h[i])
          *(2*drdh[i] + drv_dh) + (<font color="red">der</font>(h[i])*(1 - rs[i]) +<font color="red"> der</font>(h[i + 1])*rs[
          i])*(drdh[i] + 2*drv_dh)));

        dMbif[i] = A*(1 - rs[i])*(<font color="red">der</font>(p)*((b - a*c)*(h[i + 1] - hv)/((c + h[
          i + 1])*(c + hv)) + a*<font color="red">log</font>((c + h[i + 1])/(c + hv))) + ((d*f[i] -
          d*c*ee[i])*(h[i + 1] - hv)/((c + h[i + 1])*(c + hv)) + d*ee[i]*
          <font color="red">log</font>((c + h[i + 1])/(c + hv))));

        ee[i] = (<font color="red">der</font>(h[i + 1]) - (<font color="red">der</font>(h[i + 1])*rs[i] +<font color="red"> der</font>(h[i])*(1 - rs[i])))
          /(h[i + 1] - hv);
        f[i] = ((<font color="red">der</font>(h[i + 1])*rs[i] +<font color="red"> der</font>(h[i])*(1 - rs[i]))*h[i + 1] -
          <font color="red">der</font>(h[i + 1])*hv)/(h[i + 1] - hv);

      <font color="blue">elseif </font><font color="red">noEvent</font>((h[i] &gt;= hl)<font color="blue"> and </font>(h[i] &lt;= hv)<font color="blue"> and </font>(h[i + 1] &gt;= hl)<font color="blue">
           and </font>(h[i + 1] &lt;= hv))<font color="blue"> then</font>
        <font color="darkgreen">//two phase</font>
        rs[i] = 0;
        rhos[i] = 0;
        gamma_rho[i] = 0;

        gamma_w[i] = 0;

        ws[i] = 0;

        dMmono[i] = 0;

        dMbif[i] = A*l/(h[i + 1] - h[i])*(<font color="red">der</font>(p)*((b - a*c)*(h[i + 1] - h[i])
          /((c + h[i + 1])*(c + h[i])) + a*<font color="red">log</font>((c + h[i + 1])/(c + h[i])))
           + ((d*f[i] - d*c*ee[i])*(h[i + 1] - h[i])/((c + h[i + 1])*(c + h[
          i])) + d*ee[i]*<font color="red">log</font>((c + h[i + 1])/(c + h[i]))));

        ee[i] = (<font color="red">der</font>(h[i + 1]) -<font color="red"> der</font>(h[i]))/(h[i + 1] - h[i]);
        f[i] = (<font color="red">der</font>(h[i])*h[i + 1] -<font color="red"> der</font>(h[i + 1])*h[i])/(h[i + 1] - h[i]);

      <font color="blue">elseif </font><font color="red">noEvent</font>(((h[i] &lt; hl)<font color="blue"> and </font>(h[i + 1] &lt; hl))<font color="blue"> or </font>((h[i] &gt; hv)<font color="blue"> and </font>
          (h[i + 1] &gt; hv)))<font color="blue"> then</font>

        <font color="darkgreen">//single-phase</font>
        rs[i] = 0;
        rhos[i] = 0;
        gamma_rho[i] = 0;

        gamma_w[i] = 0;
        ws[i] = 0;

        dMmono[i] = A*l*(<font color="red">der</font>(p)*1/2*(drdp[i + 1] + drdp[i]) + 1/6*(<font color="red">der</font>(h[i])
          *(2*drdh[i] + drdh[i + 1]) +<font color="red"> der</font>(h[i + 1])*(drdh[i] + 2*drdh[i +
          1])));
        dMbif[i] = 0;

        ee[i] = 0;
        f[i] = 0;
      <font color="blue">else</font>
        <font color="darkgreen">//double transition (not supported!)</font>
        <font color="red">assert</font>(0 &gt; 1,
          &quot;Error: two phase trasitions between two adiacent nodes. Try increasing the number of nodes&quot;);
        rs[i] = 0;
        rhos[i] = 0;
        gamma_rho[i] = 0;

        gamma_w[i] = 0;
        ws[i] = 0;

        dMmono[i] = 0;
        dMbif[i] = 0;

        ee[i] = 0;
        f[i] = 0;
      <font color="blue">end if</font>;
    <font color="blue">end if</font>;
  <font color="blue">end for</font>;

  <font color="darkgreen">// Energy equation FEM matrices</font>

  Y[1, 1] = rho[1]*(3 - 2*alpha_sgn) + rho[2]*(1 - alpha_sgn);
  Y[1, 2] = rho[1]*(1 - alpha_sgn) + rho[2]*(1 - 2*alpha_sgn);
  Y[N, N] = rho[N - 1]*(alpha_sgn + 1) + rho[N]*(3 + 2*alpha_sgn);
  Y[N, N - 1] = rho[N - 1]*(1 + 2*alpha_sgn) + rho[N]*(1 + alpha_sgn);
  <font color="blue">if </font>N &gt; 2<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:N - 1<font color="blue"> loop</font>
      Y[i, i - 1] = rho[i - 1]*(1 + 2*alpha_sgn) + rho[i]*(1 + alpha_sgn);
      Y[i, i] = rho[i - 1]*(1 + alpha_sgn) + rho[i]*6 + rho[i + 1]*(1 -
        alpha_sgn);
      Y[i, i + 1] = rho[i]*(1 - alpha_sgn) + rho[i + 1]*(1 - 2*alpha_sgn);
      Y[1, i + 1] = 0;
      Y[N, i - 1] = 0;
      <font color="blue">for </font>j<font color="blue"> in </font>1:(i - 2)<font color="blue"> loop</font>
        Y[i, j] = 0;
      <font color="blue">end for</font>;
      <font color="blue">for </font>j<font color="blue"> in </font>(i + 2):N<font color="blue"> loop</font>
        Y[i, j] = 0;
      <font color="blue">end for</font>;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  <font color="blue">for </font>i<font color="blue"> in </font>1:N<font color="blue"> loop</font>
    <font color="blue">for </font>j<font color="blue"> in </font>1:N<font color="blue"> loop</font>
      YY[i, j] = <font color="blue">if </font>(i &lt;&gt; j)<font color="blue"> then </font>0<font color="blue"> else </font><font color="red">sum</font>(Y[:, j]);
    <font color="blue">end for</font>;
  <font color="blue">end for</font>;

  M[1, 1] = l/3 - l*alpha_sgn/4;
  M[N, N] = l/3 + l*alpha_sgn/4;
  M[1, 2] = l/6 - l*alpha_sgn/4;
  M[N, (N - 1)] = l/6 + l*alpha_sgn/4;
  <font color="blue">if </font>N &gt; 2<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:N - 1<font color="blue"> loop</font>
      M[i, i - 1] = l/6 + l*alpha_sgn/4;
      M[i, i] = 2*l/3;
      M[i, i + 1] = l/6 - l*alpha_sgn/4;
      M[1, i + 1] = 0;
      M[N, i - 1] = 0;
      <font color="blue">for </font>j<font color="blue"> in </font>1:(i - 2)<font color="blue"> loop</font>
        M[i, j] = 0;
      <font color="blue">end for</font>;
      <font color="blue">for </font>j<font color="blue"> in </font>(i + 2):N<font color="blue"> loop</font>
        M[i, j] = 0;
      <font color="blue">end for</font>;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  B[1, 1] = (-1/(3) + alpha_sgn/4)*w[1] + (-1/(6) + alpha_sgn/4)*w[2];
  B[1, 2] = (1/(3) - alpha_sgn/4)*w[1] + (1/(6) - alpha_sgn/4)*w[2];
  B[N, N] = (1/(6) + alpha_sgn/4)*w[N - 1] + (1/(3) + alpha_sgn/4)*w[N];
  B[N, N - 1] = (-1/(6) - alpha_sgn/4)*w[N - 1] + (-1/(3) - alpha_sgn/4)*w[
    N];
  <font color="blue">if </font>N &gt; 2<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:N - 1<font color="blue"> loop</font>
      B[i, i - 1] = (-1/(6) - alpha_sgn/4)*w[i - 1] + (-1/(3) - alpha_sgn/4)
        *w[i];
      B[i, i] = (1/(6) + alpha_sgn/4)*w[i - 1] + (alpha_sgn/2)*w[i] + (-1/(
        6) + alpha_sgn/4)*w[i + 1];
      B[i, i + 1] = (1/(3) - alpha_sgn/4)*w[i] + (1/(6) - alpha_sgn/4)*w[i
         + 1];
      B[1, i + 1] = 0;
      B[N, i - 1] = 0;
      <font color="blue">for </font>j<font color="blue"> in </font>1:(i - 2)<font color="blue"> loop</font>
        B[i, j] = 0;
      <font color="blue">end for</font>;
      <font color="blue">for </font>j<font color="blue"> in </font>(i + 2):N<font color="blue"> loop</font>
        B[i, j] = 0;
      <font color="blue">end for</font>;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  G[1] = l/2*(1 - alpha_sgn);
  G[N] = l/2*(1 + alpha_sgn);
  <font color="blue">if </font>N &gt; 2<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:N - 1<font color="blue"> loop</font>
      G[i] = l;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">//boundary conditions</font>

  C[1, 1] = <font color="blue">if </font><font color="red">noEvent</font>(infl.w &gt;= 0)<font color="blue"> then </font>(1 - alpha_sgn/2)*w[1]<font color="blue"> else </font>0;
  C[N, N] = <font color="blue">if </font><font color="red">noEvent</font>(outfl.w &gt;= 0)<font color="blue"> then </font>-(1 + alpha_sgn/2)*w[N]<font color="blue"> else </font>0;
  C[N, 1] = 0;
  C[1, N] = 0;
  <font color="blue">if </font>(N &gt; 2)<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:(N - 1)<font color="blue"> loop</font>
      C[1, i] = 0;
      C[N, i] = 0;
      <font color="blue">for </font>j<font color="blue"> in </font>1:N<font color="blue"> loop</font>
        C[i, j] = 0;
      <font color="blue">end for</font>;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  K[1, 1] = <font color="blue">if </font><font color="red">noEvent</font>(infl.w &gt;= 0)<font color="blue"> then </font>(1 - alpha_sgn/2)*infl.hBA<font color="blue"> else </font>0;
  K[N, N] = <font color="blue">if </font><font color="red">noEvent</font>(outfl.w &gt;= 0)<font color="blue"> then </font>-(1 + alpha_sgn/2)*outfl.hAB<font color="blue"> else </font>
          0;
  K[N, 1] = 0;
  K[1, N] = 0;
  <font color="blue">if </font>(N &gt; 2)<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:(N - 1)<font color="blue"> loop</font>
      K[1, i] = 0;
      K[N, i] = 0;
      <font color="blue">for </font>j<font color="blue"> in </font>1:N<font color="blue"> loop</font>
        K[i, j] = 0;
      <font color="blue">end for</font>;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Momentum and Mass balance equation matrices</font>
  D[1] = l/2;
  D[N] = l/2;
  <font color="blue">if </font>N &gt; 2<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:N - 1<font color="blue"> loop</font>
      D[i] = l;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  by[1, 1] = 0;
  by[2, 1] = 0;
  by[3, 1] = l/12*rs[1]*(6 - 8*rs[1] + 3*rs[1]^2 + alpha_sgn*(2*rs[1] - 3));
  by[4, 1] = -l/12*(1 - rs[1])^2*(2*alpha_sgn + 3*rs[1] - 3);
  by[5, 1] = -l/12*rs[1]^2*(2*alpha_sgn + 3*rs[1] - 4);
  by[6, 1] = -l/12*(1 - rs[1])*(3*rs[1]^2 - 2*rs[1] + 2*alpha_sgn*rs[1] +
    alpha_sgn - 1);
  by[7, 1] = 0;
  by[8, 1] = 0;
  by[1, N] = l/12*rs[N - 1]^2*(2*alpha_sgn + 3*rs[N - 1]);
  by[2, N] = l/12*(1 - rs[N - 1])*(1 + alpha_sgn + 2*rs[N - 1] + 2*
    alpha_sgn*rs[N - 1] + 3*rs[N - 1]^2);
  by[3, N] = 0;
  by[4, N] = 0;
  by[5, N] = 0;
  by[6, N] = 0;
  by[7, N] = l/12*rs[N - 1]*(alpha_sgn*(3 - 2*rs[N - 1]) + rs[N - 1]*(4 - 3
    *rs[N - 1]));
  by[8, N] = l/12*(1 - rs[N - 1])^2*(2*alpha_sgn + 3*rs[N - 1] + 1);
  <font color="blue">if </font>N &gt; 2<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:N - 1<font color="blue"> loop</font>
      by[1, i] = l/12*rs[i - 1]^2*(2*alpha_sgn + 3*rs[i - 1]);
      by[2, i] = l/12*(1 - rs[i - 1])*(1 + alpha_sgn + 2*rs[i - 1] + 2*
        alpha_sgn*rs[i - 1] + 3*rs[i - 1]^2);

      by[3, i] = l/12*rs[i]*(6 - 8*rs[i] + 3*rs[i]^2 + alpha_sgn*(2*rs[i]
         - 3));
      by[4, i] = -l/12*(1 - rs[i])^2*(2*alpha_sgn + 3*rs[i] - 3);

      by[5, i] = -l/12*rs[i]^2*(2*alpha_sgn + 3*rs[i] - 4);
      by[6, i] = -l/12*(1 - rs[i])*(3*rs[i]^2 - 2*rs[i] + 2*alpha_sgn*rs[i]
         + alpha_sgn - 1);
      by[7, i] = l/12*rs[i - 1]*(alpha_sgn*(3 - 2*rs[i - 1]) + rs[i - 1]*(4
         - 3*rs[i - 1]));
      by[8, i] = l/12*(1 - rs[i - 1])^2*(2*alpha_sgn + 3*rs[i - 1] + 1);
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">//additional 2 phases Y-matrix</font>
  Y2ph[1, 1] = (gamma_rho[1]*by[3, 1] + gamma_rho[1]*by[4, 1]);
  Y2ph[1, 2] = (gamma_rho[1]*by[5, 1] + gamma_rho[1]*by[6, 1]);
  Y2ph[N, N] = (gamma_rho[N - 1]*by[1, N] + gamma_rho[N - 1]*by[2, N]);
  Y2ph[N, N - 1] = (gamma_rho[N - 1]*by[7, N] + gamma_rho[N - 1]*by[8, N]);
  <font color="blue">if </font>N &gt; 2<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:N - 1<font color="blue"> loop</font>
      Y2ph[i, i - 1] = (gamma_rho[i - 1]*by[7, i] + gamma_rho[i - 1]*by[8,
        i]);
      Y2ph[i, i] = (gamma_rho[i - 1]*by[1, i] + gamma_rho[i - 1]*by[2, i])
         + (gamma_rho[i]*by[3, i] + gamma_rho[i]*by[4, i]);
      Y2ph[i, i + 1] = (gamma_rho[i]*by[5, i] + gamma_rho[i]*by[6, i]);
      Y2ph[1, i + 1] = 0;
      Y2ph[N, i - 1] = 0;
      <font color="blue">for </font>j<font color="blue"> in </font>1:(i - 2)<font color="blue"> loop</font>
        Y2ph[i, j] = 0;
      <font color="blue">end for</font>;
      <font color="blue">for </font>j<font color="blue"> in </font>(i + 2):N<font color="blue"> loop</font>
        Y2ph[i, j] = 0;
      <font color="blue">end for</font>;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">//computation of beta functions for additional matrices</font>
  beta[1, 1] = 0;
  beta[2, 1] = 0;
  beta[3, 1] = 1/12*rs[1]*(3*alpha_sgn + 4*rs[1] - 6);
  beta[4, 1] = 1/12*(1 - rs[1])*(3*alpha_sgn + 4*rs[1] - 4);
  beta[5, 1] = -beta[3, 1];
  beta[6, 1] = -beta[4, 1];
  beta[7, 1] = 0;
  beta[8, 1] = 0;
  beta[1, N] = 1/12*rs[N - 1]*(3*alpha_sgn + 4*rs[N - 1]);
  beta[2, N] = 1/12*(1 - rs[N - 1])*(3*alpha_sgn + 4*rs[N - 1] + 2);
  beta[3, N] = 0;
  beta[4, N] = 0;
  beta[5, N] = 0;
  beta[6, N] = 0;
  beta[7, N] = -beta[1, N];
  beta[8, N] = -beta[2, N];
  <font color="blue">if </font>N &gt; 2<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:N - 1<font color="blue"> loop</font>
      beta[1, i] = 1/12*rs[i - 1]*(3*alpha_sgn + 4*rs[i - 1]);
      beta[2, i] = 1/12*(1 - rs[i - 1])*(3*alpha_sgn + 4*rs[i - 1] + 2);
      beta[3, i] = 1/12*rs[i]*(3*alpha_sgn + 4*rs[i] - 6);
      beta[4, i] = 1/12*(1 - rs[i])*(3*alpha_sgn + 4*rs[i] - 4);
      beta[5, i] = -beta[3, i];
      beta[6, i] = -beta[4, i];
      beta[7, i] = -beta[1, i];
      beta[8, i] = -beta[2, i];
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">//additional 2 phases B-matrix</font>
  B2ph[1, 1] = (gamma_w[1]*beta[3, 1] + gamma_w[1]*beta[4, 1]);
  B2ph[1, 2] = (gamma_w[1]*beta[5, 1] + gamma_w[1]*beta[6, 1]);
  B2ph[N, N] = (gamma_w[N - 1]*beta[1, N] + gamma_w[N - 1]*beta[2, N]);
  B2ph[N, N - 1] = (gamma_w[N - 1]*beta[7, N] + gamma_w[N - 1]*beta[8, N]);
  <font color="blue">if </font>N &gt; 2<font color="blue"> then</font>
    <font color="blue">for </font>i<font color="blue"> in </font>2:N - 1<font color="blue"> loop</font>
      B2ph[i, i - 1] = (gamma_w[i - 1]*beta[7, i] + gamma_w[i - 1]*beta[8,
        i]);
      B2ph[i, i] = (gamma_w[i - 1]*beta[1, i] + gamma_w[i - 1]*beta[2, i])
         + (gamma_w[i]*beta[3, i] + gamma_w[i]*beta[4, i]);
      B2ph[i, i + 1] = (gamma_w[i]*beta[5, i] + gamma_w[i]*beta[6, i]);
      B2ph[1, i + 1] = 0;
      B2ph[N, i - 1] = 0;
      <font color="blue">for </font>j<font color="blue"> in </font>1:(i - 2)<font color="blue"> loop</font>
        B2ph[i, j] = 0;
      <font color="blue">end for</font>;
      <font color="blue">for </font>j<font color="blue"> in </font>(i + 2):N<font color="blue"> loop</font>
        B2ph[i, j] = 0;
      <font color="blue">end for</font>;
    <font color="blue">end for</font>;
  <font color="blue">end if</font>;
  Q = Nt*l*omega*D*phi <font color="darkgreen">&quot;Total heat flow through lateral boundary&quot;</font>;
  Tr=<font color="red">noEvent</font>(<font color="red">sum</font>(rho)*A*l/<font color="red">max</font>(infl.w/Nt,Modelica.Constants.eps));
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="red">der</font>(h) =<font color="red"> zeros</font>(N);
    <font color="blue">if </font>(<font color="blue">not </font>Medium.singleState)<font color="blue"> then</font>
      <font color="red">der</font>(p) = 0;
    <font color="blue">end if</font>;
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyStateNoP<font color="blue"> then</font>
    <font color="red">der</font>(h) =<font color="red"> zeros</font>(N);
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;
<font color="blue">end </font>Flow1Dfem2ph;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE FlowJoin<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.FlowJoinI.png" ALT="ThermoPower.Water.FlowJoin" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.FlowJoin"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.FlowJoin</H2>
<B>Joins two water/steam flows</B><p>
<IMG SRC="ThermoPower.Water.FlowJoinD.png" ALT="ThermoPower.Water.FlowJoin">
<H3>Information</H3>
<PRE></pre>
<p>This component allows to join two separate flows into one. The model is based on mass and energy balance equations, without any mass or energy buildup, and without any pressure drop between the inlet and the outlets.
<p><b>Modelling options</b></p>
<p> If <tt>rev_in1</tt>, <tt>rev_in2</tt> or <tt>rev_out</tt> is true, the respective flows reversal is allowed. If at least ona among these parameters is false, it is possible to set <tt>checkFlowDirection</tt>.</p>
<p>If <tt>checkFlowDirection</tt> is true, when the flow reversal happen where it is not allowed, the error message is showed.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>rev_in1</TD><TD>true</TD><TD>Allow flow reversal at in1</TD></TR>
<TR><TD>Boolean</TD><TD>rev_in2</TD><TD>true</TD><TD>Allow flow reversal at in2</TD></TR>
<TR><TD>Boolean</TD><TD>rev_out</TD><TD>true</TD><TD>Allow flow reversal at out</TD></TR>
<TR><TD>Boolean</TD><TD>checkFlowDirection</TD><TD>false</TD><TD>Check flow direction</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>1e5</TD><TD>Pressure start value [Pa]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>out</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>in1</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>in2</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> FlowJoin <font color="darkgreen">&quot;Joins two water/steam flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.FlowJoin"
>Icons.Water.FlowJoin</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wzero=1e-9 <font color="darkgreen">
    &quot;Small flowrate to avoid singularity in computing the outlet enthalpy&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstart=1e5 <font color="darkgreen">&quot;Pressure start value&quot;</font>;
  <font color="blue">parameter </font>Boolean rev_in1 = true <font color="darkgreen">&quot;Allow flow reversal at in1&quot;</font>;
  <font color="blue">parameter </font>Boolean rev_in2 = true <font color="darkgreen">&quot;Allow flow reversal at in2&quot;</font>;
  <font color="blue">parameter </font>Boolean rev_out = true <font color="darkgreen">&quot;Allow flow reversal at out&quot;</font>;
  <font color="blue">parameter </font>Boolean checkFlowDirection = false <font color="darkgreen">&quot;Check flow direction&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> out(p(start=pstart), <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> in1(p(start=pstart), <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> in2(p(start=pstart), <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
<font color="blue">equation </font>
  in1.w + in2.w + out.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  in1.p = out.p;
  in2.p = out.p;
  <font color="darkgreen">// Energy balance</font>
  out.hBA = <font color="blue">if </font>(in2.w &lt; 0<font color="blue"> and </font>rev_in2)<font color="blue"> then </font>in1.hBA<font color="blue"> else </font><font color="blue">if </font>(in1.w &lt; 0<font color="blue"> and </font>rev_in1)<font color="blue"> then </font>in2.hBA<font color="blue"> else </font>(
    in1.hBA*(in1.w + wzero) + in2.hBA*(in2.w + wzero))/(in1.w + 2*wzero + in2.w);
  in1.hAB = <font color="blue">if </font>(in2.w &lt; 0<font color="blue"> and </font>rev_in2)<font color="blue"> then </font>out.hAB<font color="blue"> else </font><font color="blue">if </font>(out.w &lt; 0<font color="blue"> or </font><font color="blue">not </font>rev_out)<font color="blue"> then </font>in2.hBA<font color="blue"> else </font>(
    out.hAB*(out.w + wzero) + in2.hBA*(in2.w + wzero))/(out.w + 2*wzero + in2.w);
  in2.hAB = <font color="blue">if </font>(in1.w &lt; 0<font color="blue"> and </font>rev_in1)<font color="blue"> then </font>out.hAB<font color="blue"> else </font><font color="blue">if </font>(out.w &lt; 0<font color="blue"> or </font><font color="blue">not </font>rev_out)<font color="blue"> then </font>in1.hBA<font color="blue"> else </font>(
    out.hAB*(out.w + wzero) + in1.hBA*(in1.w + wzero))/(out.w + 2*wzero + in1.w);
  <font color="darkgreen">//Check flow direction</font>
  <font color="red">assert</font>( <font color="blue">not </font>checkFlowDirection<font color="blue"> or </font>((rev_in1<font color="blue"> or </font>in1.w &gt;= 0)<font color="blue"> and </font>
                                     (rev_in2<font color="blue"> or </font>in2.w &gt;= 0)<font color="blue"> and </font>
                                     (rev_out<font color="blue"> or </font>out.w &lt;= 0)),
                                    &quot;Flow reversal not supported&quot;);
<font color="blue">end </font>FlowJoin;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE FlowSplit<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.FlowSplitI.png" ALT="ThermoPower.Water.FlowSplit" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.FlowSplit"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.FlowSplit</H2>
<B>Splits a flow in two</B><p>
<IMG SRC="ThermoPower.Water.FlowSplitD.png" ALT="ThermoPower.Water.FlowSplit">
<H3>Information</H3>
<PRE></pre>
<p>This component allows to split a single flow in two ones. The model is based on mass and energy balance equations, without any mass or energy buildup, and without any pressure drop between the inlet and the outlets.
<p><b>Modelling options</b></p>
<p> If <tt>rev_in1</tt>, <tt>rev_out1</tt> or <tt>rev_out2</tt> is true, the respective flows reversal is allowed. If at least ona among these parameters is false, it is possible to set <tt>checkFlowDirection</tt>.</p>
<p>If <tt>checkFlowDirection</tt> is true, when the flow reversal happen where it is not allowed, the error message is showed.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>rev_in1</TD><TD>true</TD><TD>Allow flow reversal at in1</TD></TR>
<TR><TD>Boolean</TD><TD>rev_out1</TD><TD>true</TD><TD>Allow flow reversal at out1</TD></TR>
<TR><TD>Boolean</TD><TD>rev_out2</TD><TD>true</TD><TD>Allow flow reversal at out2</TD></TR>
<TR><TD>Boolean</TD><TD>checkFlowDirection</TD><TD>false</TD><TD>Check flow direction</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>1e5</TD><TD>Pressure start value [Pa]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>in1</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>out1</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>out2</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> FlowSplit <font color="darkgreen">&quot;Splits a flow in two&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.FlowSplit"
>Icons.Water.FlowSplit</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wzero=1e-9 <font color="darkgreen">
    &quot;Small flowrate to avoid singularity in computing the outlet enthalpy&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstart=1e5 <font color="darkgreen">&quot;Pressure start value&quot;</font>;
  <font color="blue">parameter </font>Boolean rev_in1 = true <font color="darkgreen">&quot;Allow flow reversal at in1&quot;</font>;
  <font color="blue">parameter </font>Boolean rev_out1 = true <font color="darkgreen">&quot;Allow flow reversal at out1&quot;</font>;
  <font color="blue">parameter </font>Boolean rev_out2 = true <font color="darkgreen">&quot;Allow flow reversal at out2&quot;</font>;
  <font color="blue">parameter </font>Boolean checkFlowDirection = false <font color="darkgreen">&quot;Check flow direction&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> in1(p(start=pstart), <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> out1(p(start=pstart), <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> out2(p(start=pstart), <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
<font color="blue">equation </font>
  in1.w + out1.w + out2.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  out1.p = in1.p;
  out2.p = in1.p;
  <font color="darkgreen">// Energy balance</font>
  out1.hBA = <font color="blue">if </font>(in1.w &lt; 0<font color="blue"> and </font>rev_in1)<font color="blue"> then </font>out2.hAB<font color="blue"> else </font><font color="blue">if </font>(out2.w &lt; 0<font color="blue"> or </font><font color="blue">not </font>rev_out2)<font color="blue"> then </font>in1.hBA<font color="blue"> else </font>
          (in1.hBA*(in1.w + wzero) + out2.hAB*(out2.w + wzero))/(in1.w + 2*wzero + out2.w);
  out2.hBA = <font color="blue">if </font>(in1.w &lt; 0<font color="blue"> and </font>rev_in1)<font color="blue"> then </font>out1.hAB<font color="blue"> else </font><font color="blue">if </font>(out1.w &lt; 0<font color="blue"> or </font><font color="blue">not </font>rev_out1)<font color="blue"> then </font>in1.hBA<font color="blue"> else </font>
          (in1.hBA*(in1.w + wzero) + out1.hAB*(out1.w + wzero))/(in1.w + 2*wzero + out1.w);
  in1.hAB = <font color="blue">if </font>(out1.w &lt; 0<font color="blue"> or </font><font color="blue">not </font>rev_out1)<font color="blue"> then </font>out2.hAB<font color="blue"> else </font><font color="blue">if </font>(out2.w &lt; 0<font color="blue"> or </font><font color="blue">not </font>rev_out2)<font color="blue"> then </font>out1.hAB<font color="blue"> else </font>
          (out1.hAB*(out1.w + wzero) + out2.hAB*(out2.w + wzero))/(out1.w + 2*wzero + out2.w);
  <font color="darkgreen">//Check flow direction</font>
  <font color="red">assert</font>( <font color="blue">not </font>checkFlowDirection<font color="blue"> or </font>((rev_in1<font color="blue"> or </font>in1.w &gt;= 0)<font color="blue"> and </font>
                                     (rev_out1<font color="blue"> or </font>out1.w &lt;= 0)<font color="blue"> and </font>
                                     (rev_out2<font color="blue"> or </font>out2.w &lt;= 0)),
                                    &quot;Flow reversal not supported&quot;);
<font color="blue">end </font>FlowSplit;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SensT<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.SensTI.png" ALT="ThermoPower.Water.SensT" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.SensT"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.SensT</H2>
<B>Temperature sensor for water-steam</B><p>
<IMG SRC="ThermoPower.Water.SensTD.png" ALT="ThermoPower.Water.SensT">
<H3>Information</H3>
<PRE></pre>
<p>This component can be inserted in a hydraulic circuit to measure the temperature of the fluid flowing through it.
<p>Flow reversal is supported.
<pre></PRE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD>output <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>T</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SensT <font color="darkgreen">&quot;Temperature sensor for water-steam&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.SensThrough"
>Icons.Water.SensThrough</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  Medium.BaseProperties fluid;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>ThermoPower.Water.FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>ThermoPower.Water.FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> T;
<font color="blue">equation </font>
  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  inlet.p = outlet.p <font color="darkgreen">&quot;No pressure drop&quot;</font>;
  <font color="darkgreen">// Set fluid properties</font>
  fluid.p=inlet.p;
  fluid.h = <font color="blue">if </font>inlet.w &gt;= 0<font color="blue"> then </font>inlet.hBA<font color="blue"> else </font>inlet.hAB;
  T = fluid.T;

  <font color="darkgreen">// Boundary conditions</font>
  inlet.hAB = outlet.hAB;
  inlet.hBA = outlet.hBA;
<font color="blue">end </font>SensT;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SensW<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.SensWI.png" ALT="ThermoPower.Water.SensW" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.SensW"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.SensW</H2>
<B>Mass Flowrate sensor for water/steam</B><p>
<IMG SRC="ThermoPower.Water.SensWD.png" ALT="ThermoPower.Water.SensW">
<H3>Information</H3>
<PRE></pre>
<p>This component can be inserted in a hydraulic circuit to measure the flowrate of the fluid flowing through it.
<p>Flow reversal is supported.
<pre></PRE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD>output <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>w</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SensW <font color="darkgreen">&quot;Mass Flowrate sensor for water/steam&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.SensThrough"
>Icons.Water.SensThrough</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>ThermoPower.Water.FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>ThermoPower.Water.FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> w;
<font color="blue">equation </font>
  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;

  <font color="darkgreen">// Boundary conditions</font>
  inlet.p = outlet.p;
  inlet.hAB = outlet.hAB;
  inlet.hBA = outlet.hBA;
  w = inlet.w;
<font color="blue">end </font>SensW;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SensP<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.SensPI.png" ALT="ThermoPower.Water.SensP" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.SensP"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.SensP</H2>
<B>Pressure sensor for water/steam flows</B><p>
<IMG SRC="ThermoPower.Water.SensPD.png" ALT="ThermoPower.Water.SensP">
<H3>Information</H3>
<PRE></pre>
<p>This component can be connected to any A-type or B-type connector to measure the pressure of the fluid flowing through it. In this case, it is possible to connect more than two <tt>Flange</tt> connectors together.
<pre></PRE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>output <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>p</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.Flange"
>Flange</A></TD><TD>flange</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SensP <font color="darkgreen">&quot;Pressure sensor for water/steam flows&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.SensP"
>Icons.Water.SensP</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> p;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.Flange"
>Flange</A> flange(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
<font color="blue">equation </font>
  flange.w = 0;
  p = flange.p;
<font color="blue">end </font>SensP;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Accumulator<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.AccumulatorI.png" ALT="ThermoPower.Water.Accumulator" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Accumulator"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Accumulator</H2>
<B>Water-Gas Accumulator</B><p>
<IMG SRC="ThermoPower.Water.AccumulatorD.png" ALT="ThermoPower.Water.Accumulator">
<H3>Information</H3>
<PRE></pre>
<p>This model describes a water-gas accumulator (the gas is modeled as ideal bi-atomic). <p>
Water flows in and out through the interfaces at the component bottom (flow reversal supported). <p>
The gas is supposed to flow in at constant temperature (parameter <tt>Tgin</tt>) and with variable flow-rate (<tt>GasInfl</tt> signal port), and to flow out by a valve operating in choked condition; the valve coefficient is determined by the working point at full opening (<tt>wg_out0,Tg0, Pg0</tt>) while the valve opening (in the range <tt>0-1</tt>) is an input signal (<tt>OutletValveOpening</tt> signal port).
<p><b>Dimensional parameters</b></p>
<ul>
<li><tt>V</tt>: accumulator total volume;
<li><tt>Vl0</tt>: volume occupied by water at the nominal level (reference value);
<li><tt>zl0</tt>: height of water nominal level above the water connectors;
<li><tt>A</tt>: cross-sectional area at actual water level;
</ul>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V</TD><TD>&nbsp;</TD><TD>Total volume [m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>Vl0</TD><TD>&nbsp;</TD><TD>Water nominal volume (at reference level) [m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Cross Sectional Area [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A></TD><TD>zl0</TD><TD>&nbsp;</TD><TD>Height of water reference level over inlet/outlet connectors [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A></TD><TD>zl_start</TD><TD>&nbsp;</TD><TD>Water start level (relative to reference) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hl_start</TD><TD>&nbsp;</TD><TD>Water start specific enthalpy [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pg_start</TD><TD>&nbsp;</TD><TD>Gas start pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tg_start</TD><TD>300</TD><TD>Gas start temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>gamma_ex</TD><TD>50</TD><TD>Water-Gas heat transfer coefficient [W/(m2.K)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>Tgin</TD><TD>300</TD><TD>Inlet gas temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MolarMass"
>MolarMass</A></TD><TD>MM</TD><TD>29e-3</TD><TD>Gas molar mass [kg/mol]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wg_out0</TD><TD>&nbsp;</TD><TD>Nominal gas outlet flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A></TD><TD>Tg0</TD><TD>300</TD><TD>Nominal gas temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pg0</TD><TD>&nbsp;</TD><TD>Nominal gas pressure [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>GasInfl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>WaterInfl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>WaterOutfl</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>OutletValveOpening</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Accumulator <font color="darkgreen">&quot;Water-Gas Accumulator&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.Accumulator"
>ThermoPower.Icons.Water.Accumulator</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Liquid medium model&quot;</font>;
  Medium.BaseProperties liquid <font color="darkgreen">&quot;Liquid properties&quot;</font>;

  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> V <font color="darkgreen">&quot;Total volume&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vl0 <font color="darkgreen">&quot;Water nominal volume (at reference level)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> A <font color="darkgreen">&quot;Cross Sectional Area&quot;</font>;

  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A> zl0 <font color="darkgreen">
    &quot;Height of water reference level over inlet/outlet connectors&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A> zl_start <font color="darkgreen">&quot;Water start level (relative to reference)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hl_start <font color="darkgreen">&quot;Water start specific enthalpy&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pg_start <font color="darkgreen">&quot;Gas start pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tg_start=300 <font color="darkgreen">&quot;Gas start temperature&quot;</font>;

  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gamma_ex=50 <font color="darkgreen">
    &quot;Water-Gas heat transfer coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A> Tgin=300 <font color="darkgreen">&quot;Inlet gas temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MolarMass"
>MolarMass</A> MM=29e-3 <font color="darkgreen">&quot;Gas molar mass&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wg_out0 <font color="darkgreen">&quot;Nominal gas outlet flowrate&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tg0=300 <font color="darkgreen">&quot;Nominal gas temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pg0 <font color="darkgreen">&quot;Nominal gas pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Choices.Init.Options.Temp</A> initOpt=Choices.Init.Options.noInit <font color="darkgreen">
    &quot;Initialisation option&quot;</font>;
<font color="blue">protected </font>
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Acceleration"
>Acceleration</A> g=Modelica.Constants.g_n;
  <font color="blue">constant </font>Real R=Modelica.Constants.R <font color="darkgreen">&quot;Universal gas constant&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacityAtConstantPressure"
>SpecificHeatCapacityAtConstantPressure</A> cpg = (7/2)*Rstar <font color="darkgreen">
    &quot;Cp of gas&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacityAtConstantVolume"
>SpecificHeatCapacityAtConstantVolume</A> cvg = (5/2)*Rstar <font color="darkgreen">&quot;Cv of gas&quot;</font>;
  <font color="blue">parameter </font>Real Rstar = R/MM <font color="darkgreen">&quot;Gas constant&quot;</font>;
  <font color="blue">parameter </font>Real K = wg_out0/(pg0*<font color="red">sqrt</font>(Tg0)) <font color="darkgreen">&quot;Gas outlet flow coefficient&quot;</font>;
<font color="blue">public </font>
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wl_in <font color="darkgreen">&quot;Water inflow mass flow rate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wl_out <font color="darkgreen">&quot;Water outflow mass flow rate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A> zl(start=zl_start) <font color="darkgreen">&quot;Water level (relative to reference)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hl_in <font color="darkgreen">&quot;Water inlet specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hl_out <font color="darkgreen">&quot;Water outlet specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hl(start=hl_start, stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;Water internal specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vl <font color="darkgreen">&quot;Volume occupied by water&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> Mg <font color="darkgreen">&quot;Mass of gas&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> pf <font color="darkgreen">&quot;Water Pressure at the inlet/outlet flanges&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.EnergyFlowRate"
>EnergyFlowRate</A> Qp <font color="darkgreen">&quot;Water-Gas heat flow&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wg_in <font color="darkgreen">&quot;Gas inflow mass flow rate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wg_out <font color="darkgreen">&quot;Gas outflow mass flow rate&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.GasDensity"
>GasDensity</A> rhog(start=pg_start*MM/(R*Tg_start)) <font color="darkgreen">&quot;Gas density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> Tg(start=Tg_start) <font color="darkgreen">&quot;Gas temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vg <font color="darkgreen">&quot;Volume occupied by gas&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> pg(start=pg_start) <font color="darkgreen">&quot;Gas pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> GasInfl;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>ThermoPower.Water.FlangeA</A> WaterInfl(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>ThermoPower.Water.FlangeB</A> WaterOutfl(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> OutletValveOpening;
<font color="blue">equation </font>

  <font color="darkgreen">//Equations for water and gas volumes and exchanged thermal power</font>
  Vl = Vl0 + A*zl;
  Vg = V - Vl;
  Qp = gamma_ex*A*(liquid.T - Tg);

  <font color="darkgreen">// Boundary conditions </font>
  <font color="darkgreen">// (Thermal effects of the water going out of the accumulator are neglected)</font>
  hl_in = <font color="blue">if </font>wl_in &gt;= 0<font color="blue"> then </font>WaterInfl.hBA<font color="blue"> else </font>hl;
  hl_out = <font color="blue">if </font>wl_out &gt;= 0<font color="blue"> then </font>WaterOutfl.hAB<font color="blue"> else </font>hl;
  WaterInfl.hAB = WaterOutfl.hAB;
  WaterOutfl.hBA = WaterInfl.hBA;
  wl_in = WaterInfl.w;
  wl_out = WaterOutfl.w;
  WaterInfl.p = pf;
  WaterOutfl.p = pf;

  liquid.d*A*<font color="red">der</font>(zl) = wl_in + wl_out <font color="darkgreen">
    &quot;Water mass balance (density variations neglected)&quot;</font>;
  liquid.d*Vl*<font color="red">der</font>(hl)-Vl*<font color="red">der</font>(pg)-pg*<font color="red">der</font>(Vl) = wl_in*(hl_in-hl) + wl_out*(hl_out-hl) - Qp <font color="darkgreen">
    &quot;Water energy balance&quot;</font>;

  <font color="darkgreen">// Set liquid properties</font>
  liquid.p=pg;
  liquid.h=hl;

  pf = pg + liquid.d*g*(zl + zl0) <font color="darkgreen">&quot;Stevino's law&quot;</font>;

  wg_in =GasInfl <font color="darkgreen">&quot;Gas inlet mass-flow rate&quot;</font>;

  <font color="darkgreen">//Gas outlet mass-flow rate</font>
  wg_out = -OutletValveOpening*K*pg*<font color="red">sqrt</font>(Tg);

  pg = rhog*Rstar*Tg <font color="darkgreen">&quot;Gas state equation&quot;</font>;
  Mg=Vg*rhog <font color="darkgreen">&quot;Gas mass&quot;</font>;
  <font color="red">der</font>(Mg) = wg_in + wg_out <font color="darkgreen">&quot;Gas mass balance&quot;</font>;
  rhog*Vg*cpg*<font color="red">der</font>(Tg) = wg_in*cpg*(Tgin - Tg) + Vg*<font color="red">der</font>(pg) + Qp <font color="darkgreen">
    &quot;Gas energy balance&quot;</font>;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    zl = zl_start;
    <font color="red">der</font>(Tg) = 0;
    <font color="red">der</font>(hl) = 0;
    <font color="red">der</font>(Vl) = 0;
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyStateNoP<font color="blue"> then</font>
    zl = zl_start;
    <font color="red">der</font>(Tg) = 0;
    <font color="red">der</font>(hl) = 0;
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;
<font color="blue">end </font>Accumulator;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Drum2States<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.Drum2StatesI.png" ALT="ThermoPower.Water.Drum2States" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Drum2States"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Drum2States</H2>
<IMG SRC="ThermoPower.Water.Drum2StatesD.png" ALT="ThermoPower.Water.Drum2States">
<H3>Information</H3>
<PRE></pre>
<p>Simplified model of a drum for drum boilers. This model assumes thermodynamic equilibrium between the liquid and vapour volumes. The model has two state variables (i.e., pressure and liquid volume).
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>Vd</TD><TD>&nbsp;</TD><TD>Drum volume [m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>Vdcr</TD><TD>&nbsp;</TD><TD>Volume of downcomer and risers [m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A></TD><TD>Mmd</TD><TD>&nbsp;</TD><TD>Drum metal mass [kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A></TD><TD>Mmdcr</TD><TD>&nbsp;</TD><TD>Metal mass of downcomer and risers [kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>SpecificHeatCapacity</A></TD><TD>cm</TD><TD>&nbsp;</TD><TD>Specific heat capacity of the metal [J/(kg.K)]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>&nbsp;</TD><TD>Pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>Vldstart</TD><TD>&nbsp;</TD><TD>Start value of drum water volume [m3]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>feed</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>steam</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>heat</TD><TD>Metal wall thermal port</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Drum2States
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.Drum"
>Icons.Water.Drum</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialTwoPhaseMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vd <font color="darkgreen">&quot;Drum volume&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vdcr <font color="darkgreen">&quot;Volume of downcomer and risers&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> Mmd <font color="darkgreen">&quot;Drum metal mass&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> Mmdcr <font color="darkgreen">&quot;Metal mass of downcomer and risers&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>SpecificHeatCapacity</A> cm <font color="darkgreen">&quot;Specific heat capacity of the metal&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstart <font color="darkgreen">&quot;Pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vldstart <font color="darkgreen">&quot;Start value of drum water volume&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Choices.Init.Options.Temp</A> initOpt=Choices.Init.Options.noInit <font color="darkgreen">
    &quot;Initialisation option&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialTwoPhaseMedium.html#Modelica.Media.Interfaces.PartialTwoPhaseMedium.SaturationProperties"
>Medium.SaturationProperties</A> sat <font color="darkgreen">&quot;Saturation conditions&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> feed(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> steam(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</A> heat <font color="darkgreen">
    &quot;Metal wall thermal port&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> Ml <font color="darkgreen">&quot;Liquid water mass&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> Mv <font color="darkgreen">&quot;Steam mass&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> M <font color="darkgreen">&quot;Total liquid+steam mass&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Energy"
>Energy</A> E <font color="darkgreen">&quot;Total energy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vt <font color="darkgreen">&quot;Total volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vl(start=Vldstart+Vdcr) <font color="darkgreen">&quot;Liquid water total volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vld(start=Vldstart, stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;Liquid water volume in the drum&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vv <font color="darkgreen">&quot;Steam volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p(start=pstart,stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;Drum pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> qf <font color="darkgreen">&quot;Feedwater mass flowrate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> qs <font color="darkgreen">&quot;Steam mass flowrate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>HeatFlowRate</A> Q <font color="darkgreen">&quot;Heat flow to the risers&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hf <font color="darkgreen">&quot;Feedwater specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hl <font color="darkgreen">&quot;Specific enthalpy of saturated liquid&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hv <font color="darkgreen">&quot;Specific enthalpy of saturated steam&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> Ts <font color="darkgreen">&quot;Saturation temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Medium.Density</A> rhol <font color="darkgreen">&quot;Density of saturated liquid&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Medium.Density</A> rhov <font color="darkgreen">&quot;Density of saturated steam&quot;</font>;
<font color="blue">equation </font>
  Ml=Vl*rhol <font color="darkgreen">&quot;Mass of liquid&quot;</font>;
  Mv=Vv*rhov <font color="darkgreen">&quot;Mass of vapour&quot;</font>;
  M=Ml+Mv <font color="darkgreen">&quot;Total mass&quot;</font>;
  E=Ml*hl+Mv*hv-p*Vt+(Mmd+Mmdcr)*cm*Ts <font color="darkgreen">&quot;Total energy&quot;</font>;
  Ts=sat.Tsat <font color="darkgreen">&quot;Saturation temperature&quot;</font>;
  <font color="red">der</font>(M) = qf - qs <font color="darkgreen">&quot;Mass balance&quot;</font>;
  <font color="red">der</font>(E) = Q + qf*hf - qs*hv <font color="darkgreen">&quot;Energy balance&quot;</font>;
  Vl = Vld+Vdcr <font color="darkgreen">&quot;Liquid volume&quot;</font>;
  Vt = Vd + Vdcr <font color="darkgreen">&quot;Total volume&quot;</font>;
  Vt = Vl + Vv <font color="darkgreen">&quot;Total volume&quot;</font>;

  <font color="darkgreen">// Boundary conditions</font>
  p = feed.p;
  p = steam.p;
  hf = <font color="blue">if </font>feed.w &gt;= 0<font color="blue"> then </font>feed.hBA<font color="blue"> else </font>hl;
  feed.w = qf;
  -steam.w = qs;
  feed.hAB = hl;
  steam.hBA = hv;
  Q =heat.Q_flow;
  heat.T = Ts;

  <font color="darkgreen">// Fluid properties</font>
  sat.psat=p;
  sat.Tsat=<font color="red">Medium.saturationTemperature</font>(p);
  rhol=<font color="red">Medium.bubbleDensity</font>(sat);
  rhov=<font color="red">Medium.dewDensity</font>(sat);
  hl=<font color="red">Medium.bubbleEnthalpy</font>(sat);
  hv=<font color="red">Medium.dewEnthalpy</font>(sat);
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="red">der</font>(p) = 0;
    <font color="red">der</font>(Vld) = 0;
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;
<font color="blue">end </font>Drum2States;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Drum<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.DrumI.png" ALT="ThermoPower.Water.Drum" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Drum"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Drum</H2>
<B>Drum for circulation boilers</B><p>
<IMG SRC="ThermoPower.Water.DrumD.png" ALT="ThermoPower.Water.Drum">
<H3>Information</H3>
<PRE></pre>
<p>This model describes the cylindrical drum of a drum boiler, without assuming thermodynamic equilibrium between the liquid and vapour holdups. Connectors are provided for feedwater inlet, steam outlet, downcomer outlet, riser inlet, and blowdown outlet.
<p>The model is based on dynamic mass and energy balance equations of the liquid volume and vapour volume inside the drum. Mass and energy tranfer between the two phases is provided by bulk condensation and surface condensation of the vapour phase, and by bulk boiling of the liquid phase. Additional energy transfer can take place at the surface if the steam is superheated.
<p>The riser flowrate is separated before entering the drum, at the vapour pressure. The (saturated) liquid fraction goes into the liquid volume; the (wet) vapour fraction goes into the vapour volume, vith a steam quality depending on the liquid/vapour density ratio and on the <tt>avr</tt> parameter.
<p>The enthalpy of the liquid going to the downcomer is computed by assuming that a fraction of the total mass flowrate (<tt>afd</tt>) comes directly from the feedwater inlet. The pressure at the downcomer connector is equal to the vapour pressure plus the liquid head.
<p>The metal wall dynamics is taken into account, assuming uniform temperature. Heat transfer takes place between the metal wall and the liquid phase, vapour phase, and external atmosphere, the corresponding heat transfer coefficients being <tt>gl</tt>, <tt>gv</tt>, and <tt>gext</tt>.
<p>The drum level is referenced to the centreline.
<p>The start values of drum pressure, liquid specific enthalpy, vapour specific enthalpy, and metal wall temperature can be specified by setting the parameters <tt>pstart</tt>, <tt>hlstart</tt>, <tt>hvstart</tt>, <tt>Tmstart</tt>
<p><b>Modelling options</b></p>
<p>The following options are available to specify the orientation of the cylindrical drum:
<ul><li><tt>DrumOrientation = 0</tt>: horizontal axis.
<li><tt>DrumOrientation = 1</tt>: vertical axis.
</ul>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>rint</TD><TD>0</TD><TD>Internal radius [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>rext</TD><TD>0</TD><TD>External radius [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>L</TD><TD>0</TD><TD>Length [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>HeatCapacity</A></TD><TD>Cm</TD><TD>0</TD><TD>Total Heat Capacity of the metal wall [J/K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>Text</TD><TD>293</TD><TD>External atmospheric temperature [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A></TD><TD>tauev</TD><TD>15</TD><TD>Time constant of bulk evaporation [s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A></TD><TD>tauc</TD><TD>15</TD><TD>Time constant of bulk condensation [s]</TD></TR>
<TR><TD>Real</TD><TD>Kcs</TD><TD>0</TD><TD>Surface condensation coefficient [kg/(s.m^2.K)]</TD></TR>
<TR><TD>Real</TD><TD>Ks</TD><TD>0</TD><TD>Surface heat transfer coefficient [W/(m^2.K)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>gext</TD><TD>0</TD><TD>Heat transfer coefficient between metal wall and external atmosphere [W/(m2.K)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>gl</TD><TD>200</TD><TD>Heat transfer coefficient between metal wall and liquid phase [W/(m2.K)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>gv</TD><TD>200</TD><TD>Heat transfer coefficient between metal wall and vapour phase [W/(m2.K)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>lm</TD><TD>20</TD><TD>Metal wall thermal conductivity [W/(m.K)]</TD></TR>
<TR><TD>Real</TD><TD>afd</TD><TD>0.05</TD><TD>Ratio of feedwater in downcomer flowrate</TD></TR>
<TR><TD>Real</TD><TD>avr</TD><TD>1.2</TD><TD>Phase separation efficiency coefficient</TD></TR>
<TR><TD>Integer</TD><TD>DrumOrientation</TD><TD>0</TD><TD>0: Horizontal; 1: Vertical</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart</TD><TD>1e5</TD><TD>Pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hlstart</TD><TD>1e5</TD><TD>Liquid enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hvstart</TD><TD>2.78e6</TD><TD>Vapour enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>Tmstart</TD><TD>300</TD><TD>Metal wall temperature start value [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>ystart</TD><TD>0</TD><TD>Start level value [m]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>feedwater</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>riser</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>downcomer</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>blowdown</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>steam</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Drum <font color="darkgreen">&quot;Drum for circulation boilers&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.Drum"
>Icons.Water.Drum</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialTwoPhaseMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  Medium.BaseProperties liquid;
  Medium.BaseProperties vapour;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialTwoPhaseMedium.html#Modelica.Media.Interfaces.PartialTwoPhaseMedium.SaturationProperties"
>Medium.SaturationProperties</A> sat;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> rint=0 <font color="darkgreen">&quot;Internal radius&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> rext=0 <font color="darkgreen">&quot;External radius&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> L=0 <font color="darkgreen">&quot;Length&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.HeatCapacity"
>HeatCapacity</A> Cm=0 <font color="darkgreen">&quot;Total Heat Capacity of the metal wall&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A> Text=293 <font color="darkgreen">&quot;External atmospheric temperature&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A> tauev=15 <font color="darkgreen">&quot;Time constant of bulk evaporation&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A> tauc=15 <font color="darkgreen">&quot;Time constant of bulk condensation&quot;</font>;
  <font color="blue">parameter </font>Real Kcs=0 <font color="darkgreen">&quot;Surface condensation coefficient [kg/(s.m^2.K)]&quot;</font>;
  <font color="blue">parameter </font>Real Ks=0 <font color="darkgreen">&quot;Surface heat transfer coefficient [W/(m^2.K)]&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gext=0 <font color="darkgreen">
    &quot;Heat transfer coefficient between metal wall and external atmosphere&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gl=200 <font color="darkgreen">
    &quot;Heat transfer coefficient between metal wall and liquid phase&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> gv=200 <font color="darkgreen">
    &quot;Heat transfer coefficient between metal wall and vapour phase&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A> lm=20 <font color="darkgreen">&quot;Metal wall thermal conductivity&quot;</font>;
  <font color="blue">parameter </font>Real afd=0.05 <font color="darkgreen">&quot;Ratio of feedwater in downcomer flowrate&quot;</font>;
  <font color="blue">parameter </font>Real avr=1.2 <font color="darkgreen">&quot;Phase separation efficiency coefficient&quot;</font>;
  <font color="blue">parameter </font>Integer DrumOrientation=0 <font color="darkgreen">&quot;0: Horizontal; 1: Vertical&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstart=1e5 <font color="darkgreen">&quot;Pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hlstart=1e5 <font color="darkgreen">&quot;Liquid enthalpy start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hvstart=2.78e6 <font color="darkgreen">&quot;Vapour enthalpy start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A> Tmstart=300 <font color="darkgreen">&quot;Metal wall temperature start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> ystart=0 <font color="darkgreen">&quot;Start level value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Choices.Init.Options.Temp</A> initOpt=Choices.Init.Options.noInit <font color="darkgreen">
    &quot;Initialisation option&quot;</font>;
  <font color="blue">constant </font>Real g=Modelica.Constants.g_n;
  <font color="blue">constant </font>Real pi=Modelica.Constants.pi;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vv(start=pi*rint^2*L/2) <font color="darkgreen">&quot;Volume occupied by the vapour&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vl(start=pi*rint^2*L/2) <font color="darkgreen">&quot;Volume occupied by the liquid&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> p(start=pstart, stateSelect=StateSelect.prefer) <font color="darkgreen">&quot;Surface pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hl(start=hlstart, stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;Liquid specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hv(start=hvstart, stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;Vapour specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hrv <font color="darkgreen">
    &quot;Specific enthalpy of vapour from the risers after separation&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hrl <font color="darkgreen">
    &quot;Specific enthalpy of liquid from the risers after separation&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hls <font color="darkgreen">&quot;Specific enthalpy of saturated liquid&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hvs <font color="darkgreen">&quot;Specific enthalpy of saturated vapour&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hf <font color="darkgreen">&quot;Specific enthalpy of feedwater&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hd <font color="darkgreen">&quot;Specific enthalpy of liquid to the downcomers&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hvout <font color="darkgreen">&quot;Specific enthalpy of steam at the outlet&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hr <font color="darkgreen">&quot;Specific enthalpy of fluid from the risers&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wf <font color="darkgreen">&quot;Mass flowrate of feedwater&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wd <font color="darkgreen">&quot;Mass flowrate to the downcomers&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wb <font color="darkgreen">&quot;Mass flowrate of blowdown&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wr <font color="darkgreen">&quot;Mass flowrate from the risers&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wrl <font color="darkgreen">&quot;Mass flowrate of liquid from the risers&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wrv <font color="darkgreen">&quot;Mass flowrate of vapour from the risers&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wv <font color="darkgreen">&quot;Mass flowrate of steam at the outlet&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wc <font color="darkgreen">&quot;Mass flowrate of bulk condensation&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wcs <font color="darkgreen">&quot;Mass flowrate of surface condensation&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wev <font color="darkgreen">&quot;Mass flowrate of bulk evaporation&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tl <font color="darkgreen">&quot;Liquid temperature&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tv <font color="darkgreen">&quot;Vapour temperature&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Tm(start=Tmstart, stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;Wall temperature&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.AbsoluteTemperature"
>AbsoluteTemperature</A> Ts <font color="darkgreen">&quot;Saturated water temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> Qmv <font color="darkgreen">&quot;Heat flow from the wall to the vapour&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> Qvl <font color="darkgreen">&quot;Heat flow from the vapour to the liquid&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> Qml <font color="darkgreen">&quot;Heat flow from the wall to the liquid&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> Qme <font color="darkgreen">&quot;Heat flow from the wall to the atmosphere&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> Ml <font color="darkgreen">&quot;Liquid mass&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> Mv <font color="darkgreen">&quot;Vapour mass&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Energy"
>Energy</A> El <font color="darkgreen">&quot;Liquid internal energy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Energy"
>Energy</A> Ev <font color="darkgreen">&quot;Vapour internal energy&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.LiquidDensity"
>LiquidDensity</A> rhol <font color="darkgreen">&quot;Liquid density&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.GasDensity"
>GasDensity</A> rhov <font color="darkgreen">&quot;Vapour density&quot;</font>;
  Real xl <font color="darkgreen">&quot;Mass fraction of vapour in the liquid volume&quot;</font>;
  Real xv <font color="darkgreen">&quot;Steam quality in the vapour volume&quot;</font>;
  Real xr <font color="darkgreen">&quot;Steam quality of the fluid from the risers&quot;</font>;
  Real xrv <font color="darkgreen">&quot;Steam quality of the separated steam from the risers&quot;</font>;
  Real gml <font color="darkgreen">&quot;Total heat transfer coefficient (wall-liquid)&quot;</font>;
  Real gmv <font color="darkgreen">&quot;Total heat transfer coefficient (wall-vapour)&quot;</font>;
  Real a;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> y(start=ystart, stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;Level (referred to the centreline)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> Aml <font color="darkgreen">&quot;Surface of the wall-liquid interface&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> Amv <font color="darkgreen">&quot;Surface of the wall-vapour interface&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> Asup <font color="darkgreen">&quot;Surface of the liquid-vapour interface&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> Aext <font color="darkgreen">&quot;External drum surface&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> feedwater(p(start=pstart), hAB(start=hlstart),
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> riser(p(start=pstart), hAB(start=hlstart),
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> downcomer(p(start=pstart), hAB(start=hlstart),
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> blowdown(p(start=pstart), hBA(start=hlstart),
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> steam(p(start=pstart), hBA(start=hvstart),
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
<font color="blue">equation </font>
  <font color="red">der</font>(Mv)= wrv + wev - wv - wc - wcs <font color="darkgreen">&quot;Vapour volume mass balance&quot;</font>;
  <font color="red">der</font>(Ml)= wf + wrl + wc +  wcs - wd - wb - wev <font color="darkgreen">&quot;Liquid volume mass balance&quot;</font>;
  <font color="red">der</font>(Ev)= wrv*hrv + (wev - wcs)*hvs - wc*hls - wv*hvout + Qmv - Qvl-p*<font color="red">der</font>(Vv) <font color="darkgreen">
    &quot;Vapour volume energy balance&quot;</font>;
  <font color="red">der</font>(El)= wf*hf + wrl*hrl + wc*hls + (wcs - wev)*hvs - wd*hd -wb*hl + Qml + Qvl-p*<font color="red">der</font>(Vl) <font color="darkgreen">
    &quot;Liquid volume energy balance&quot;</font>;
  <font color="darkgreen">//Metal wall energy balance with singular cases</font>
  <font color="blue">if </font>Cm &gt; 0<font color="blue"> and </font>(gl &gt; 0<font color="blue"> or </font>gv &gt; 0)<font color="blue"> then</font>
    Cm*<font color="red">der</font>(Tm) = -Qml - Qmv - Qme <font color="darkgreen">&quot;Metal wall dynamic energy balance&quot;</font>;
  <font color="blue">elseif </font>(gl &gt; 0<font color="blue"> or </font>gv &gt; 0)<font color="blue"> then</font>
    0 = -Qml - Qmv - Qme <font color="darkgreen">&quot;Metal wall static energy balance&quot;</font>;
  <font color="blue">else</font>
    Tm = 300 <font color="darkgreen">&quot;Wall temperature doesn't matter&quot;</font>;
  <font color="blue">end if</font>;
  Mv=Vv*rhov <font color="darkgreen">&quot;Vapour volume mass&quot;</font>;
  Ml=Vl*rhol <font color="darkgreen">&quot;Liquid volume mass&quot;</font>;
  Ev=Mv*vapour.u <font color="darkgreen">&quot;Vapour volume energy&quot;</font>;
  El=Ml*liquid.u <font color="darkgreen">&quot;Liquid volume energy&quot;</font>;
  wev = xl*rhol*Vl/tauev <font color="darkgreen">&quot;Bulk evaporation flow rate in the liquid volume&quot;</font>;
  wc = (1 - xv)*rhov*Vv/tauc <font color="darkgreen">&quot;Bulk condensation flow rate in the vapour volume&quot;</font>;
  wcs = Kcs*Asup*(Ts - Tl) <font color="darkgreen">&quot;Surface condensation flow rate&quot;</font>;
  Qme = gext*Aext*(Tm - Text) <font color="darkgreen">
    &quot;Heat flow from metal wall to external environment&quot;</font>;
  Qml = gml*Aml*(Tm - Tl) <font color="darkgreen">&quot;Heat flow from metal wall to liquid volume&quot;</font>;
  Qmv = gmv*Amv*(Tm - Tv) <font color="darkgreen">&quot;Heat flow from metal wall to vapour volume&quot;</font>;
  Qvl = Ks*Asup*(Tv - Ts) <font color="darkgreen">&quot;Heat flow from vapour to liquid volume&quot;</font>;
  xv = <font color="blue">if </font>hv &gt;= hvs<font color="blue"> then </font>1<font color="blue"> else </font>(hv - hls)/(hvs - hls) <font color="darkgreen">
    &quot;Steam quality in the vapour volume&quot;</font>;
  xl = <font color="blue">if </font>hl &lt;= hls<font color="blue"> then </font>0<font color="blue"> else </font>(hl - hls)/(hvs - hls) <font color="darkgreen">
    &quot;Steam quality in the liquid volume&quot;</font>;
  gml = <font color="blue">if </font>gl == 0<font color="blue"> then </font>0<font color="blue"> else </font>1/(1/gl + a*rint/lm) <font color="darkgreen">
    &quot;Total Heat conductance metal-liquid&quot;</font>;
  gmv = <font color="blue">if </font>gv == 0<font color="blue"> then </font>0<font color="blue"> else </font>1/(1/gv + a*rint/lm) <font color="darkgreen">
    &quot;Total Heat conductance metal-vapour&quot;</font>;
  a = rext^2/(rext^2 - rint^2)*<font color="red">log</font>(rext/rint) - 0.5;
  <font color="blue">if </font>DrumOrientation == 0<font color="blue"> then</font>
    Vl = L*(rint^2*<font color="red">acos</font>(-y/rint) + y*<font color="red">sqrt</font>(rint^2 - y^2)) <font color="darkgreen">&quot;Liquid volume&quot;</font>;
    Aml = 2*Vl/L + 2*rint*<font color="red">acos</font>(-y/rint)*L <font color="darkgreen">&quot;Metal-liquid interface area&quot;</font>;
    Asup = 2*<font color="red">sqrt</font>(rint^2 - y^2)*L <font color="darkgreen">&quot;Liquid-vapour interface area&quot;</font>;
  <font color="blue">else</font>
    Vl = pi*rint^2*(y + L/2) <font color="darkgreen">&quot;Liquid volume&quot;</font>;
    Aml = pi*rint^2 + 2*pi*rint*(y + L/2) <font color="darkgreen">&quot;Metal-liquid interface area&quot;</font>;
    Asup = pi*rint^2 <font color="darkgreen">&quot;Liquid-vapour interface area&quot;</font>;
  <font color="blue">end if</font>;
  Vv = pi*rint^2*L - Vl <font color="darkgreen">&quot;Vapour volume&quot;</font>;
  Amv = 2*pi*rint*L + 2*pi*rint^2 - Aml <font color="darkgreen">&quot;Metal-vapour interface area&quot;</font>;
  Aext = 2*pi*rext^2 + 2*pi*rext*L <font color="darkgreen">&quot;External metal surface area&quot;</font>;

  <font color="darkgreen">// Fluid properties</font>
  liquid.p=p;
  liquid.h=hl;
  Tl=liquid.T;
  rhol=liquid.d;
  vapour.p=p;
  vapour.h=hv;
  Tv=vapour.T;
  rhov=vapour.d;
  sat.psat=p;
  sat.Tsat=<font color="red">Medium.saturationTemperature</font>(p);
  hls=<font color="red"> Medium.bubbleEnthalpy</font>(sat);
  hvs=<font color="red"> Medium.dewEnthalpy</font>(sat);
  Ts=sat.Tsat;

  <font color="darkgreen">// Boundary conditions</font>
  feedwater.p = p;
  feedwater.w = wf;
  feedwater.hAB = hl;
  hf =<font color="red"> noEvent</font>(<font color="blue">if </font>wf &gt;= 0<font color="blue"> then </font>feedwater.hBA<font color="blue"> else </font>hl);
  downcomer.p = p + rhol*g*y;
  downcomer.w = -wd;
  downcomer.hBA = hd;
  hd =<font color="red"> noEvent</font>(<font color="blue">if </font>wd &gt;= 0<font color="blue"> then </font>afd*hf + (1 - afd)*hl<font color="blue"> else </font>downcomer.hAB);
  blowdown.p = p;
  blowdown.w = -wb;
  blowdown.hBA = hl;
  riser.p = p;
  riser.w = wr;
  riser.hAB = hl;
  hrv = hls + xrv*(hvs - hls);
  xrv = 1 - (rhov/rhol)^avr;
  hr=<font color="red">noEvent</font>(<font color="blue">if </font>wr&gt;=0<font color="blue"> then </font>riser.hBA<font color="blue"> else </font>hl);
  xr=<font color="red">noEvent</font>(<font color="blue">if </font>wr&gt;=0<font color="blue"> then </font>(<font color="blue">if </font>hr&gt;hls<font color="blue"> then </font>(hr - hls)/(hvs - hls)<font color="blue"> else </font>0)<font color="blue"> else </font>xl);
  hrl=<font color="red">noEvent</font>(<font color="blue">if </font>wr&gt;=0<font color="blue"> then </font>(<font color="blue">if </font>hr&gt;hls<font color="blue"> then </font>hls<font color="blue"> else </font>hr)<font color="blue"> else </font>hl);
  wrv=<font color="red">noEvent</font>(<font color="blue">if </font>wr&gt;=0<font color="blue"> then </font>xr*wr/xrv<font color="blue"> else </font>0);
  wrl=wr-wrv;
  steam.p = p;
  steam.w = -wv;
  steam.hBA = hv;
  hvout =<font color="red"> noEvent</font>(<font color="blue">if </font>wv &gt;= 0<font color="blue"> then </font>hv<font color="blue"> else </font>steam.hAB);
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="red">der</font>(p) = 0;
    <font color="red">der</font>(hl) = 0;
    <font color="red">der</font>(hv) = 0;
    <font color="red">der</font>(y) = 0;
    <font color="blue">if </font>Cm &gt; 0<font color="blue"> and </font>(gl &gt; 0<font color="blue"> or </font>gv &gt; 0)<font color="blue"> then</font>
      <font color="red">der</font>(Tm)=0;
    <font color="blue">end if</font>;
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyStateNoP<font color="blue"> then</font>
    <font color="red">der</font>(hl) = 0;
    <font color="red">der</font>(hv) = 0;
    <font color="red">der</font>(y) = 0;
    <font color="blue">if </font>Cm &gt; 0<font color="blue"> and </font>(gl &gt; 0<font color="blue"> or </font>gv &gt; 0)<font color="blue"> then</font>
      <font color="red">der</font>(Tm)=0;
    <font color="blue">end if</font>;
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;
<font color="blue">end </font>Drum;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ValveLin<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.ValveLinI.png" ALT="ThermoPower.Water.ValveLin" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.ValveLin"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.ValveLin</H2>
<B>Valve for water/steam flows with linear pressure drop</B><p>
<IMG SRC="ThermoPower.Water.ValveLinD.png" ALT="ThermoPower.Water.ValveLin">
<H3>Information</H3>
<PRE></pre>
<p>This very simple model provides a pressure drop which is proportional to the flowrate and to the <tt>cmd</tt> signal, without computing any fluid property.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.HydraulicConductance"
>HydraulicConductance</A></TD><TD>Kv</TD><TD>&nbsp;</TD><TD>Nominal hydraulic conductance [(kg/s)/Pa]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>cmd</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ValveLin <font color="darkgreen">
  &quot;Valve for water/steam flows with linear pressure drop&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.Valve"
>Icons.Water.Valve</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.HydraulicConductance"
>HydraulicConductance</A> Kv <font color="darkgreen">&quot;Nominal hydraulic conductance&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass flowrate&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> cmd;
<font color="blue">equation </font>
  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  w = Kv*cmd *(inlet.p - outlet.p) <font color="darkgreen">&quot;Valve characteristics&quot;</font>;

  <font color="darkgreen">// Boundary conditions</font>
  w = inlet.w;
  inlet.hAB = outlet.hAB;
  inlet.hBA = outlet.hBA;

<font color="blue">end </font>ValveLin;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ValveBase<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.ValveLinI.png" ALT="ThermoPower.Water.ValveBase" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.ValveBase"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.ValveBase</H2>
<B>Base model for valves</B><p>
<IMG SRC="ThermoPower.Water.ValveBaseD.png" ALT="ThermoPower.Water.ValveBase">
<H3>Information</H3>
<PRE></pre>
<p>This is the base model for the <tt>ValveLiq</tt>, <tt>ValveLiqChoked</tt>, and <tt>ValveVap</tt> valve models. The model is based on the IEC 534 / ISA S.75 standards for valve sizing.
<p>The model optionally supports reverse flow conditions (assuming symmetrical behaviour) or check valve operation, and has been suitably modified to avoid numerical singularities at zero pressure drop.
<p><b>Modelling options</b></p>
<p>The following options are available to specify the valve flow coefficient in fully open conditions:
<ul><li><tt>CvData = ThermoPower.Water.ValveBase.CvTypes.Av</tt>: the flow coefficient is given by the metric <tt>Av</tt> coefficient (m^2).
<li><tt>CvData = ThermoPower.Water.ValveBase.CvTypes.Kv</tt>: the flow coefficient is given by the metric <tt>Kv</tt> coefficient (m^3/h).
<li><tt>CvData = ThermoPower.Water.ValveBase.CvTypes.Cv</tt>: the flow coefficient is given by the US <tt>Cv</tt> coefficient (USG/min).
<li><tt>CvData = ThermoPower.Water.ValveBase.CvTypes.OpPoint</tt>: the flow coefficient is specified by the nominal operating point:  <tt>pnom</tt>, <tt>dpnom</tt>, <tt>wnom</tt>, <tt>rhonom</tt>, <tt>thetanom</tt> (in forward flow).
</ul>
<p>The nominal pressure drop <tt>dpnom</tt> must always be specified; to avoid numerical singularities, the flow characteristic is modified for pressure drops less than <tt>b*dpnom</tt> (the default value is 1% of the nominal pressure drop). Increase this parameter if numerical instabilities occur in valves with very low pressure drops.
<p>If <tt>CheckValve</tt> is true, then the flow is stopped when the outlet pressure is higher than the inlet pressure; otherwise, reverse flow takes place.
<p>The default flow characteristic <tt>FlowChar</tt> is linear; it can be replaced by functions taken from <tt>Functions.ValveCharacteristics</tt>, or by any suitable user-defined function extending <tt>Functions.ValveCharacteristics.baseFun</tt>.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Choices_Valve_CvTypes.html#ThermoPower.Choices.Valve.CvTypes.Temp"
>Temp</A></TD><TD>CvData</TD><TD>CvTypes.Av</TD><TD>Selection of flow coefficient</TD></TR>
<TR><TD>Boolean</TD><TD>CheckValve</TD><TD>false</TD><TD>Reverse flow stopped</TD></TR>
<TR><TD>Real</TD><TD>b</TD><TD>0.01</TD><TD>Regularisation factor</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Flow Coefficient</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>Av</TD><TD>0</TD><TD>Av (metric) flow coefficient [m2]</TD></TR>
<TR><TD>Real</TD><TD>Kv</TD><TD>0</TD><TD>Kv (metric) flow coefficient [m^3/h]</TD></TR>
<TR><TD>Real</TD><TD>Cv</TD><TD>0</TD><TD>Cv (US) flow coefficient [USG/min]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal operating point</TD></TR>
<TR><TD>Real</TD><TD>pnom</TD><TD>&nbsp;</TD><TD>Nominal inlet pressure</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>&nbsp;</TD><TD>Nominal pressure drop [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>1000</TD><TD>Nominal density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>thetanom</TD><TD>1</TD><TD>Nominal valve opening</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pin_start</TD><TD>pnom</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pout_start</TD><TD>pnom - dpnom</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart</TD><TD>1e5</TD><TD>Specific enthalpy start value [J/kg]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>theta</TD><TD>Valve opening in per unit</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> ValveBase <font color="darkgreen">&quot;Base model for valves&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.Valve"
>Icons.Water.Valve</A>;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_Valve_CvTypes.html#ThermoPower.Choices.Valve.CvTypes"
>ThermoPower.Choices.Valve.CvTypes</A>;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  Medium.BaseProperties fluid(p(start=pin_start), h(start=hstart));
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Valve_CvTypes.html#ThermoPower.Choices.Valve.CvTypes.Temp"
>CvTypes.Temp</A> CvData = CvTypes.Av <font color="darkgreen">&quot;Selection of flow coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> Av(fixed = <font color="blue">if </font>CvData==CvTypes.Av<font color="blue"> then </font>true<font color="blue"> else </font>false,
    start = wnom/(<font color="red">sqrt</font>(rhonom*dpnom))*<font color="red">FlowChar</font>(thetanom))=0 <font color="darkgreen">
    &quot;Av (metric) flow coefficient&quot;</font>;
  <font color="blue">parameter </font>Real Kv(unit=&quot;m^3/h&quot;)=0 <font color="darkgreen">&quot;Kv (metric) flow coefficient&quot;</font>;
  <font color="blue">parameter </font>Real Cv(unit=&quot;USG/min&quot;)=0 <font color="darkgreen">&quot;Cv (US) flow coefficient&quot;</font>;
  <font color="blue">parameter </font>Real pnom <font color="darkgreen">&quot;Nominal inlet pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> dpnom <font color="darkgreen">&quot;Nominal pressure drop&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wnom <font color="darkgreen">&quot;Nominal mass flowrate&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A> rhonom = 1000 <font color="darkgreen">&quot;Nominal density&quot;</font>;
  <font color="blue">parameter </font>Real thetanom = 1 <font color="darkgreen">&quot;Nominal valve opening&quot;</font>;
  <font color="blue">parameter </font>Boolean CheckValve=false <font color="darkgreen">&quot;Reverse flow stopped&quot;</font>;
  <font color="blue">parameter </font>Real b=0.01 <font color="darkgreen">&quot;Regularisation factor&quot;</font>;
  <font color="blue">replaceable </font><font color="blue">function</font> FlowChar = <A HREF="ThermoPower_Functions_ValveCharacteristics.html#ThermoPower.Functions.ValveCharacteristics.linear"
>Functions.ValveCharacteristics.linear</A>
    <font color="blue">extends </font>Functions.ValveCharacteristics.baseFun <font color="darkgreen">&quot;Flow characteristic&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pin_start = pnom <font color="darkgreen">&quot;Inlet pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pout_start = pnom-dpnom <font color="darkgreen">&quot;Inlet pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hstart=1e5 <font color="darkgreen">&quot;Specific enthalpy start value&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass flow rate&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.LiquidDensity"
>LiquidDensity</A> rho <font color="darkgreen">&quot;Inlet density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> Tin;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> dp <font color="darkgreen">&quot;Pressure drop across the valve&quot;</font>;
<font color="blue">protected </font>
  <font color="blue">function</font> sqrtR = <A HREF="ThermoPower_Functions.html#ThermoPower.Functions.sqrtReg"
>Functions.sqrtReg</A>(delta = b*dpnom);
<font color="blue">public </font>
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> inlet(w(start=wnom),p(start=pin_start),<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> outlet(w(start=-wnom),p(start=pout_start),<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> theta <font color="darkgreen">&quot;Valve opening in per unit&quot;</font>;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>CvData == CvTypes.Kv<font color="blue"> then</font>
    Av = 2.7778e-5*Kv;
  <font color="blue">elseif </font>CvData == CvTypes.Cv<font color="blue"> then</font>
    Av = 2.4027e-5*Cv;
  <font color="blue">end if</font>;
  <font color="red">assert</font>(CvData&gt;=0<font color="blue"> and </font>CvData&lt;=3, &quot;Invalid CvData&quot;);
<font color="blue">equation </font>
  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  w = inlet.w;

  <font color="darkgreen">// Fluid properties</font>
  fluid.p = inlet.p;
  fluid.h = inlet.hBA;
  Tin = fluid.T;
  rho = fluid.d;

  <font color="darkgreen">// Energy balance</font>
  inlet.hAB = outlet.hAB;
  inlet.hBA = outlet.hBA;

  dp = inlet.p - outlet.p <font color="darkgreen">&quot;Definition of dp&quot;</font>;
<font color="blue">end </font>ValveBase;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ValveLiq<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.ValveLinI.png" ALT="ThermoPower.Water.ValveLiq" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.ValveLiq"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.ValveLiq</H2>
<B>Valve for liquid water flow</B><p>
<IMG SRC="ThermoPower.Water.ValveBaseD.png" ALT="ThermoPower.Water.ValveLiq">
<H3>Information</H3>
<PRE></pre>
<p>Liquid water valve model according to the IEC 534/ISA S.75 standards for valve sizing, incompressible fluid. <p>
Extends the <tt>ValveBase</tt> model (see the corresponding documentation for common valve features).
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>StandardWater</TD><TD>Medium model</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Valve_CvTypes.html#ThermoPower.Choices.Valve.CvTypes.Temp"
>Temp</A></TD><TD>CvData</TD><TD>CvTypes.Av</TD><TD>Selection of flow coefficient</TD></TR>
<TR><TD>Boolean</TD><TD>CheckValve</TD><TD>false</TD><TD>Reverse flow stopped</TD></TR>
<TR><TD>Real</TD><TD>b</TD><TD>0.01</TD><TD>Regularisation factor</TD></TR>
<TR><TD colspan="2">replaceable function FlowChar</TD><TD>Functions.ValveCharacteristi...</TD><TD>Flow characteristic</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Flow Coefficient</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>Av</TD><TD>0</TD><TD>Av (metric) flow coefficient [m2]</TD></TR>
<TR><TD>Real</TD><TD>Kv</TD><TD>0</TD><TD>Kv (metric) flow coefficient [m^3/h]</TD></TR>
<TR><TD>Real</TD><TD>Cv</TD><TD>0</TD><TD>Cv (US) flow coefficient [USG/min]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal operating point</TD></TR>
<TR><TD>Real</TD><TD>pnom</TD><TD>&nbsp;</TD><TD>Nominal inlet pressure</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>&nbsp;</TD><TD>Nominal pressure drop [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>1000</TD><TD>Nominal density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>thetanom</TD><TD>1</TD><TD>Nominal valve opening</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pin_start</TD><TD>pnom</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pout_start</TD><TD>pnom - dpnom</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart</TD><TD>1e5</TD><TD>Specific enthalpy start value [J/kg]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>theta</TD><TD>Valve opening in per unit</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ValveLiq <font color="darkgreen">&quot;Valve for liquid water flow&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Water.html#ThermoPower.Water.ValveBase"
>ValveBase</A>;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_Valve_CvTypes.html#ThermoPower.Choices.Valve.CvTypes"
>ThermoPower.Choices.Valve.CvTypes</A>;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>CvData == CvTypes.OpPoint<font color="blue"> then</font>
    wnom =<font color="red"> FlowChar</font>(thetanom)*Av*<font color="red">sqrt</font>(rhonom)*<font color="red">sqrtR</font>(dpnom) <font color="darkgreen">
      &quot;Determination of Av by the operating point&quot;</font>;
  <font color="blue">end if</font>;

<font color="blue">equation </font>
  <font color="blue">if </font>CheckValve<font color="blue"> then</font>
    w =<font color="red"> FlowChar</font>(theta)*Av*<font color="red">sqrt</font>(rho)*<font color="red">smooth</font>(0,<font color="blue">if </font>dp&gt;=0<font color="blue"> then </font><font color="red">sqrtR</font>(dp)<font color="blue"> else </font>0);
  <font color="blue">else</font>
    w =<font color="red"> FlowChar</font>(theta)*Av*<font color="red">sqrt</font>(rho)*<font color="red">sqrtR</font>(dp);
  <font color="blue">end if</font>;
<font color="blue">end </font>ValveLiq;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ValveVap<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.ValveLinI.png" ALT="ThermoPower.Water.ValveVap" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.ValveVap"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.ValveVap</H2>
<B>Valve for steam flow</B><p>
<IMG SRC="ThermoPower.Water.ValveBaseD.png" ALT="ThermoPower.Water.ValveVap">
<H3>Information</H3>
<PRE></pre>
<p>Liquid water valve model according to the IEC 534/ISA S.75 standards for valve sizing, compressible fluid. <p>
Extends the <tt>ValveBase</tt> model (see the corresponding documentation for common valve features).
<p>The product Fk*xt is given by the parameter <tt>Fxt_full</tt>, and is assumed constant by default. The relative change (per unit) of the xt coefficient with the valve opening can be specified by customising the <tt>xtfun</tt> function.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>StandardWater</TD><TD>Medium model</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Valve_CvTypes.html#ThermoPower.Choices.Valve.CvTypes.Temp"
>Temp</A></TD><TD>CvData</TD><TD>CvTypes.Av</TD><TD>Selection of flow coefficient</TD></TR>
<TR><TD>Boolean</TD><TD>CheckValve</TD><TD>false</TD><TD>Reverse flow stopped</TD></TR>
<TR><TD>Real</TD><TD>b</TD><TD>0.01</TD><TD>Regularisation factor</TD></TR>
<TR><TD colspan="2">replaceable function FlowChar</TD><TD>Functions.ValveCharacteristi...</TD><TD>Flow characteristic</TD></TR>
<TR><TD>Real</TD><TD>Fxt_full</TD><TD>0.5</TD><TD>Fk*xt critical ratio at full opening</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Flow Coefficient</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>Av</TD><TD>0</TD><TD>Av (metric) flow coefficient [m2]</TD></TR>
<TR><TD>Real</TD><TD>Kv</TD><TD>0</TD><TD>Kv (metric) flow coefficient [m^3/h]</TD></TR>
<TR><TD>Real</TD><TD>Cv</TD><TD>0</TD><TD>Cv (US) flow coefficient [USG/min]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal operating point</TD></TR>
<TR><TD>Real</TD><TD>pnom</TD><TD>&nbsp;</TD><TD>Nominal inlet pressure</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>&nbsp;</TD><TD>Nominal pressure drop [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>1000</TD><TD>Nominal density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>thetanom</TD><TD>1</TD><TD>Nominal valve opening</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pin_start</TD><TD>pnom</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pout_start</TD><TD>pnom - dpnom</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart</TD><TD>1e5</TD><TD>Specific enthalpy start value [J/kg]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>theta</TD><TD>Valve opening in per unit</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ValveVap <font color="darkgreen">&quot;Valve for steam flow&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Water.html#ThermoPower.Water.ValveBase"
>ValveBase</A>;
  <font color="blue">import </font><A HREF="ThermoPower_Choices_Valve_CvTypes.html#ThermoPower.Choices.Valve.CvTypes"
>ThermoPower.Choices.Valve.CvTypes</A>;
  <font color="blue">parameter </font>Real Fxt_full=0.5 <font color="darkgreen">&quot;Fk*xt critical ratio at full opening&quot;</font>;
  <font color="blue">replaceable </font><font color="blue">function</font> xtfun = <A HREF="ThermoPower_Functions_ValveCharacteristics.html#ThermoPower.Functions.ValveCharacteristics.one"
>Functions.ValveCharacteristics.one</A>
    <font color="blue">extends </font>Functions.ValveCharacteristics.baseFun <font color="darkgreen">
    &quot;Critical ratio characteristic&quot;</font>;
  Real x <font color="darkgreen">&quot;Pressure drop ratio&quot;</font>;
  Real xs <font color="darkgreen">&quot;Saturated pressure drop ratio&quot;</font>;
  Real Y <font color="darkgreen">&quot;Compressibility factor&quot;</font>;
  Real Fxt <font color="darkgreen">&quot;Fxt coefficient&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p <font color="darkgreen">&quot;Inlet pressure&quot;</font>;
<font color="blue">protected </font>
  <font color="blue">parameter </font>Real Fxt_nom(fixed=false) <font color="darkgreen">&quot;Nominal Fxt&quot;</font>;
  <font color="blue">parameter </font>Real x_nom(fixed=false) <font color="darkgreen">&quot;Nominal pressure drop ratio&quot;</font>;
  <font color="blue">parameter </font>Real xs_nom(fixed=false) <font color="darkgreen">&quot;Nominal saturated pressure drop ratio&quot;</font>;
  <font color="blue">parameter </font>Real Y_nom(fixed=false) <font color="darkgreen">&quot;Nominal compressibility factor&quot;</font>;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>CvData == CvTypes.OpPoint<font color="blue"> then</font>
    <font color="darkgreen">// Determination of Av by the nominal operating point conditions</font>
    Fxt_nom = Fxt_full*<font color="red">xtfun</font>(thetanom);
    x_nom = dpnom/pnom;
    xs_nom =<font color="red"> smooth</font>(0, <font color="blue">if </font>x_nom &gt; Fxt_nom<font color="blue"> then </font>Fxt_nom<font color="blue"> else </font>x_nom);
    Y_nom = 1 -<font color="red"> abs</font>(xs_nom)/(3*Fxt_nom);
    wnom =<font color="red"> FlowChar</font>(thetanom)*Av*Y_nom*<font color="red">sqrt</font>(rhonom)*<font color="red">sqrtR</font>(pnom*xs_nom);
  <font color="blue">else</font>
    <font color="darkgreen">// Dummy values</font>
    Fxt_nom = 0;
    x_nom = 0;
    xs_nom = 0;
    Y_nom = 0;
  <font color="blue">end if</font>;
<font color="blue">equation </font>
  p =<font color="red"> noEvent</font>(<font color="blue">if </font>dp&gt;=0<font color="blue"> then </font>inlet.p<font color="blue"> else </font>outlet.p);
  Fxt = Fxt_full*<font color="red">xtfun</font>(theta);
  x = dp/p;
  xs =<font color="red"> smooth</font>(0, <font color="blue">if </font>x &lt; -Fxt<font color="blue"> then </font>-Fxt<font color="blue"> else </font><font color="blue">if </font>x &gt; Fxt<font color="blue"> then </font>Fxt<font color="blue"> else </font>x);
  Y = 1 -<font color="red"> abs</font>(xs)/(3*Fxt);
  <font color="blue">if </font>CheckValve<font color="blue"> then</font>
    w =<font color="red"> FlowChar</font>(theta)*Av*Y*<font color="red">sqrt</font>(rho)*
        <font color="red">smooth</font>(0,<font color="blue">if </font>xs&gt;=0<font color="blue"> then </font><font color="red">sqrtR</font>(p*xs)<font color="blue"> else </font>0);
  <font color="blue">else</font>
    w =<font color="red"> FlowChar</font>(theta)*Av*Y*<font color="red">sqrt</font>(rho)*<font color="red">sqrtR</font>(p*xs);
  <font color="blue">end if</font>;
<font color="blue">end </font>ValveVap;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE ValveLiqChoked<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.ValveLinI.png" ALT="ThermoPower.Water.ValveLiqChoked" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.ValveLiqChoked"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.ValveLiqChoked</H2>
<B>Valve for liquid water flow, allows choked flow conditions</B><p>
<IMG SRC="ThermoPower.Water.ValveBaseD.png" ALT="ThermoPower.Water.ValveLiqChoked">
<H3>Information</H3>
<PRE></pre>
<p>Liquid water valve model according to the IEC 534/ISA S.75 standards for valve sizing, incompressible fluid, with possible choked flow conditions. <p>
Extends the <tt>ValveBase</tt> model (see the corresponding documentation for common valve features).<p>
The model operating range includes choked flow operation, which takes place for low outlet pressures due to flashing in the vena contracta; otherwise, non-choking conditions are assumed.
<p>The default liquid pressure recovery coefficient <tt>Fl</tt> is constant and given by the parameter <tt>Flnom</tt>. The relative change (per unit) of the recovery coefficient can be specified as a given function of the valve opening by customising the <tt>Flfun</tt> function.
<p>If the flow coefficient is specified in terms of a nominal operating point, this should be in non-chocked conditions.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Choices_Valve_CvTypes.html#ThermoPower.Choices.Valve.CvTypes.Temp"
>Temp</A></TD><TD>CvData</TD><TD>CvTypes.Av</TD><TD>Selection of flow coefficient</TD></TR>
<TR><TD>Boolean</TD><TD>CheckValve</TD><TD>false</TD><TD>Reverse flow stopped</TD></TR>
<TR><TD>Real</TD><TD>b</TD><TD>0.01</TD><TD>Regularisation factor</TD></TR>
<TR><TD colspan="2">replaceable function FlowChar</TD><TD>Functions.ValveCharacteristi...</TD><TD>Flow characteristic</TD></TR>
<TR><TD>Real</TD><TD>Flnom</TD><TD>0.9</TD><TD>Liquid pressure recovery factor</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Flow Coefficient</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>Av</TD><TD>0</TD><TD>Av (metric) flow coefficient [m2]</TD></TR>
<TR><TD>Real</TD><TD>Kv</TD><TD>0</TD><TD>Kv (metric) flow coefficient [m^3/h]</TD></TR>
<TR><TD>Real</TD><TD>Cv</TD><TD>0</TD><TD>Cv (US) flow coefficient [USG/min]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Nominal operating point</TD></TR>
<TR><TD>Real</TD><TD>pnom</TD><TD>&nbsp;</TD><TD>Nominal inlet pressure</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>&nbsp;</TD><TD>Nominal pressure drop [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>1000</TD><TD>Nominal density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>thetanom</TD><TD>1</TD><TD>Nominal valve opening</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pin_start</TD><TD>pnom</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pout_start</TD><TD>pnom - dpnom</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart</TD><TD>1e5</TD><TD>Specific enthalpy start value [J/kg]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>theta</TD><TD>Valve opening in per unit</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> ValveLiqChoked <font color="darkgreen">
  &quot;Valve for liquid water flow, allows choked flow conditions&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Water.html#ThermoPower.Water.ValveBase"
>ValveBase</A>(<font color="blue">redeclare </font><font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
      Modelica.Media.Interfaces.PartialTwoPhaseMedium);
  <font color="blue">import </font><A HREF="ThermoPower_Choices_Valve_CvTypes.html#ThermoPower.Choices.Valve.CvTypes"
>ThermoPower.Choices.Valve.CvTypes</A>;
  <font color="blue">parameter </font>Real Flnom=0.9 <font color="darkgreen">&quot;Liquid pressure recovery factor&quot;</font>;
  <font color="blue">replaceable </font><font color="blue">function</font> Flfun = <A HREF="ThermoPower_Functions_ValveCharacteristics.html#ThermoPower.Functions.ValveCharacteristics.one"
>Functions.ValveCharacteristics.one</A>
    <font color="blue">extends </font>Functions.ValveCharacteristics.baseFun <font color="darkgreen">
    &quot;Pressure recovery characteristic&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass flowrate&quot;</font>;
  Real Ff <font color="darkgreen">&quot;Ff coefficient (see IEC/ISA standard)&quot;</font>;
  Real Fl <font color="darkgreen">&quot;Pressure recovery coefficient Fl (see IEC/ISA standard)&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.AbsolutePressure"
>AbsolutePressure</A> pv <font color="darkgreen">&quot;Saturation pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> dpEff <font color="darkgreen">&quot;Effective pressure drop&quot;</font>;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>CvData == CvTypes.OpPoint<font color="blue"> then</font>
    wnom =<font color="red"> FlowChar</font>(theta)*Av*<font color="red">sqrt</font>(rhonom)*<font color="red">sqrtR</font>(dpnom) <font color="darkgreen">
      &quot;Determination of Av by the operating point&quot;</font>;
  <font color="blue">end if</font>;
<font color="blue">equation </font>
  pv =<font color="red"> Medium.saturationPressure</font>(Tin);
  Ff = 0.96 - 0.28*<font color="red">sqrt</font>(pv/Medium.fluidConstants[1].criticalPressure);
  Fl = Flnom*<font color="red">Flfun</font>(theta);
  dpEff = <font color="blue">if </font>outlet.p &lt; (1 - Fl^2)*inlet.p + Ff*Fl^2*pv<font color="blue"> then </font>
            Fl^2*(inlet.p - Ff*pv)<font color="blue"> else </font>inlet.p - outlet.p <font color="darkgreen">
    &quot;Effective pressure drop, accounting for possible choked conditions&quot;</font>;
  <font color="blue">if </font>CheckValve<font color="blue"> then</font>
     w =<font color="red"> FlowChar</font>(theta)*Av*<font color="red">sqrt</font>(rho)*
         (<font color="blue">if </font>dpEff&gt;=0<font color="blue"> then </font><font color="red">sqrtR</font>(dpEff)<font color="blue"> else </font>0);
   <font color="blue">else</font>
     w =<font color="red"> FlowChar</font>(theta)*Av*<font color="red">sqrt</font>(rho)*<font color="red">sqrtR</font>(dpEff);
  <font color="blue">end if</font>;
<font color="blue">end </font>ValveLiqChoked;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE PumpBase<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.PumpBaseI.png" ALT="ThermoPower.Water.PumpBase" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.PumpBase"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.PumpBase</H2>
<B>Base model for centrifugal pumps</B><p>
<IMG SRC="ThermoPower.Water.PumpBaseD.png" ALT="ThermoPower.Water.PumpBase">
<H3>Information</H3>
<PRE></pre>
<p>This is the base model for the <tt>Pump</tt> and <tt>
PumpMech</tt> pump models.
<p>The model describes a centrifugal pump, or a group of <tt>Np</tt> identical pumps in parallel. The pump model is based on the theory of kinematic similarity: the pump characteristics are given for nominal operating conditions (rotational speed and fluid density), and then adapted to actual operating condition, according to the similarity equations.
<p>In order to avoid singularities in the computation of the outlet enthalpy at zero flowrate, the thermal capacity of the fluid inside the pump body can be taken into account.
<p>The model can either support reverse flow conditions or include a built-in check valve to avoid flow reversal.
<p><b>Modelling options</b></p>
<p> The nominal hydraulic characteristic (head vs. volume flow rate) is given by the the replaceable function <tt>flowCharacteristic</tt>.
<p> The pump energy balance can be specified in two alternative ways:
<ul>
<li><tt>usePowerCharacteristic = false</tt> (default option): the replaceable function <tt>efficiencyCharacteristic</tt> (efficiency vs. volume flow rate in nominal conditions) is used to determine the efficiency, and then the power consumption. The default is a constant efficiency of 0.8.
<li><tt>usePowerCharacteristic = true</tt>: the replaceable function <tt>powerCharacteristic</tt> (power consumption vs. volume flow rate in nominal conditions) is used to determine the power consumption, and then the efficiency.
</ul>
<p>
Several functions are provided in the package <tt>Functions.PumpCharacteristics</tt> to specify the characteristics as a function of some operating points at nominal conditions.
<p>Depending on the value of the <tt>checkValve</tt> parameter, the model either supports reverse flow conditions, or includes a built-in check valve to avoid flow reversal.

<p>If the <tt>in_Np</tt> input connector is wired, it provides the number of pumps in parallel; otherwise,  <tt>Np0</tt> parallel pumps are assumed.</p>
<p>It is possible to take into account the heat capacity of the fluid inside the pump by specifying its volume <tt>V</tt> at nominal conditions; this is necessary to avoid singularities in the computation of the outlet enthalpy in case of zero flow rate. If zero flow rate conditions are always avoided, this dynamic effect can be neglected by leaving the default value <tt>V = 0</tt>, thus avoiding a fast state variable in the model.
<p>The <tt>CheckValve</tt> parameter determines whether the pump has a built-in check valve or not.
<p>If <tt>computeNPSHa = true</tt>, the available net positive suction head is also computed; this requires a two-phase medium model to provide the fluid saturation pressure.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Integer</TD><TD>Np0</TD><TD>1</TD><TD>Nominal number of pumps in parallel</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V</TD><TD>0</TD><TD>Pump Internal Volume [m3]</TD></TR>
<TR><TD>Boolean</TD><TD>CheckValve</TD><TD>false</TD><TD>Reverse flow stopped</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Characteristics</TD></TR>
<TR><TD>Boolean</TD><TD>usePowerCharacteristic</TD><TD>false</TD><TD>Use powerCharacteristic (vs. efficiencyCharacteristic)</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rho0</TD><TD>1000</TD><TD>Nominal Liquid Density [kg/m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A></TD><TD>n0</TD><TD>&nbsp;</TD><TD>Nominal rotational speed [rev/min]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pin_start</TD><TD>&nbsp;</TD><TD>Inlet Pressure Start Value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pout_start</TD><TD>&nbsp;</TD><TD>Outlet Pressure Start Value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wstart</TD><TD>&nbsp;</TD><TD>Mass Flow Rate Start Value [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart</TD><TD>1e5</TD><TD>Fluid Specific Enthalpy Start Value [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.IntegerInput"
>IntegerInput</A></TD><TD>in_Np</TD><TD>Number of  parallel pumps</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> PumpBase <font color="darkgreen">&quot;Base model for centrifugal pumps&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.Pump"
>Icons.Water.Pump</A>;
  <font color="blue">import </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits"
>Modelica.SIunits.Conversions.NonSIunits</A>.*;
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  Medium.BaseProperties inletFluid(p(start=pin_start),h(start=hstart)) <font color="darkgreen">
    &quot;Fluid properties at the inlet&quot;</font>;
  <font color="blue">replaceable </font><font color="blue">function</font> flowCharacteristic =
      <A HREF="ThermoPower_Functions_PumpCharacteristics.html#ThermoPower.Functions.PumpCharacteristics.baseFlow"
>Functions.PumpCharacteristics.baseFlow</A> <font color="darkgreen">
    &quot;Head vs. q_flow characteristic at nominal speed and density&quot;</font>;
  <font color="blue">parameter </font>Boolean usePowerCharacteristic = false <font color="darkgreen">
    &quot;Use powerCharacteristic (vs. efficiencyCharacteristic)&quot;</font>;
  <font color="blue">replaceable </font><font color="blue">function</font> powerCharacteristic =
      <A HREF="ThermoPower_Functions_PumpCharacteristics.html#ThermoPower.Functions.PumpCharacteristics.constantPower"
>Functions.PumpCharacteristics.constantPower</A>
    <font color="blue">extends </font>Functions.PumpCharacteristics.basePower <font color="darkgreen">
    &quot;Power consumption vs. q_flow at nominal speed and density&quot;</font>;
  <font color="blue">replaceable </font><font color="blue">function</font> efficiencyCharacteristic =
    <A HREF="ThermoPower_Functions_PumpCharacteristics.html#ThermoPower.Functions.PumpCharacteristics.constantEfficiency"
>Functions.PumpCharacteristics.constantEfficiency</A>(eta_nom = 0.8)
    <font color="blue">extends </font>Functions.PumpCharacteristics.baseEfficiency <font color="darkgreen">
    &quot;Efficiency vs. q_flow at nominal speed and density&quot;</font>;
  <font color="blue">parameter </font>Integer Np0(min=1) = 1 <font color="darkgreen">&quot;Nominal number of pumps in parallel&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A> rho0=1000 <font color="darkgreen">&quot;Nominal Liquid Density&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A> n0 <font color="darkgreen">&quot;Nominal rotational speed&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> V=0 <font color="darkgreen">&quot;Pump Internal Volume&quot;</font>;
  <font color="blue">parameter </font>Boolean CheckValve=false <font color="darkgreen">&quot;Reverse flow stopped&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pin_start <font color="darkgreen">&quot;Inlet Pressure Start Value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pout_start <font color="darkgreen">&quot;Outlet Pressure Start Value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wstart <font color="darkgreen">&quot;Mass Flow Rate Start Value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hstart=1e5 <font color="darkgreen">&quot;Fluid Specific Enthalpy Start Value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Choices.Init.Options.Temp</A> initOpt=Choices.Init.Options.noInit <font color="darkgreen">
    &quot;Initialisation option&quot;</font>;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Acceleration"
>Acceleration</A> g=Modelica.Constants.g_n;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w_single(start = wstart/Np0) <font color="darkgreen">&quot;Mass flow rate (single pump)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w = Np*w_single <font color="darkgreen">&quot;Mass flow rate (total)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>VolumeFlowRate</A> q_single(start = wstart/(Np0*rho0)) <font color="darkgreen">
    &quot;Volume flow rate (single pump)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.VolumeFlowRate"
>VolumeFlowRate</A> q=Np*q_single <font color="darkgreen">&quot;Volume flow rate (totale)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> dp <font color="darkgreen">&quot;Outlet pressure minus inlet pressure&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A> head = dp/(rho*g) <font color="darkgreen">&quot;Pump head&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> h(start=hstart) <font color="darkgreen">&quot;Fluid specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hin(start=hstart) <font color="darkgreen">&quot;Enthalpy of entering fluid&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hout(start=hstart) <font color="darkgreen">&quot;Enthalpy of outgoing fluid&quot;</font>;
  <A HREF="ThermoPower.html#ThermoPower.LiquidDensity"
>LiquidDensity</A> rho <font color="darkgreen">&quot;Liquid density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> Tin <font color="darkgreen">&quot;Liquid inlet temperature&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A> n <font color="darkgreen">&quot;Shaft r.p.m.&quot;</font>;
  Integer Np(min=1) <font color="darkgreen">&quot;Number of pumps in parallel&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> W_single <font color="darkgreen">&quot;Power Consumption (single pump)&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> W = Np*W_single <font color="darkgreen">&quot;Power Consumption (total)&quot;</font>;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> W_eps=1e-8 <font color="darkgreen">
    &quot;Small coefficient to avoid numerical singularities&quot;</font>;
  <font color="blue">constant </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A> n_eps=1e-6;
  Real eta <font color="darkgreen">&quot;Pump efficiency&quot;</font>;
  Real s <font color="darkgreen">&quot;Auxiliary Variable&quot;</font>;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> infl(p(start=pin_start),hAB(start=hstart),
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> outfl(p(start=pout_start),hBA(start=hstart),
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.IntegerInput"
>Modelica.Blocks.Interfaces.IntegerInput</A> in_Np <font color="darkgreen">&quot;Number of  parallel pumps&quot;</font>;
<font color="blue">equation </font>
  <font color="darkgreen">// Number of pumps in parallel</font>
  Np = in_Np;
  <font color="blue">if </font><font color="red">cardinality</font>(in_Np)==0<font color="blue"> then</font>
    in_Np = Np0 <font color="darkgreen">&quot;Number of pumps selected by parameter&quot;</font>;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Flow equations</font>
  q_single = w_single/rho;
  <font color="blue">if </font><font color="red">noEvent</font>(s &gt; 0<font color="blue"> or </font>(<font color="blue">not </font>CheckValve))<font color="blue"> then</font>
    <font color="darkgreen">// Flow characteristics when check valve is open</font>
    q_single = s;
    head = (n/n0)^2*<font color="red">flowCharacteristic</font>(q_single*n0/(n+n_eps));
  <font color="blue">else</font>
    <font color="darkgreen">// Flow characteristics when check valve is closed</font>
    head = (n/n0)^2*<font color="red">flowCharacteristic</font>(0) - s;
    q_single = 0;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Power consumption  </font>
  <font color="blue">if </font>usePowerCharacteristic<font color="blue"> then</font>
    W_single = (n/n0)^3*(rho/rho0)*<font color="red">powerCharacteristic</font>(q_single*n0/(n+n_eps)) <font color="darkgreen">
      &quot;Power consumption (single pump)&quot;</font>;
    eta = (dp*q_single)/(W_single + W_eps) <font color="darkgreen">&quot;Hydraulic efficiency&quot;</font>;
  <font color="blue">else</font>
    eta =<font color="red"> efficiencyCharacteristic</font>(q_single*n0/(n+n_eps));
    W_single = dp*q_single/eta;
  <font color="blue">end if</font>;

  <font color="darkgreen">// Fluid properties</font>
  inletFluid.p=infl.p;
  inletFluid.h=hin;
  rho = inletFluid.d;
  Tin = inletFluid.T;

  <font color="darkgreen">// Boundary conditions</font>
  dp = outfl.p - infl.p;
  w = infl.w <font color="darkgreen">&quot;Pump total flow rate&quot;</font>;
  <font color="blue">if </font>w &gt;= 0<font color="blue"> then</font>
    hin = infl.hBA;
  <font color="blue">else</font>
    hin = outfl.hAB;
  <font color="blue">end if</font>;
  infl.hAB = hout;
  outfl.hBA = hout;
  h = hout;

  <font color="darkgreen">// Mass and energy balances</font>
  infl.w + outfl.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  <font color="blue">if </font>V&gt;0<font color="blue"> then</font>
    (rho*V*<font color="red">der</font>(h)) = (outfl.w/Np)*hout + (infl.w/Np)*hin + W_single <font color="darkgreen">
      &quot;Energy balance&quot;</font>;
  <font color="blue">else</font>
    0 = (outfl.w/Np)*hout + (infl.w/Np)*hin + W_single <font color="darkgreen">&quot;Energy balance&quot;</font>;
  <font color="blue">end if</font>;

<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>initOpt == Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="blue">if </font>V&gt;0<font color="blue"> then</font>
      <font color="red">der</font>(h)=0;
    <font color="blue">end if</font>;
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;

<font color="blue">end </font>PumpBase;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE Pump<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.PumpI.png" ALT="ThermoPower.Water.Pump" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.Pump"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.Pump</H2>
<B>Centrifugal pump with ideally controlled speed</B><p>
<IMG SRC="ThermoPower.Water.PumpD.png" ALT="ThermoPower.Water.Pump">
<H3>Information</H3>
<PRE></pre>
<p>This model describes a centrifugal pump (or a group of <tt>Np</tt> pumps in parallel) with controlled speed, either fixed or provided by an external signal.
<p>The model extends <tt>PumpBase</tt>
<p>If the <tt>in_n</tt> input connector is wired, it provides rotational speed of the pumps (rpm); otherwise, a constant rotational speed equal to <tt>n_const</tt> (which can be different from <tt>n0</tt>) is assumed.</p>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>StandardWater</TD><TD>Medium model</TD></TR>
<TR><TD>Integer</TD><TD>Np0</TD><TD>1</TD><TD>Nominal number of pumps in parallel</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V</TD><TD>0</TD><TD>Pump Internal Volume [m3]</TD></TR>
<TR><TD>Boolean</TD><TD>CheckValve</TD><TD>false</TD><TD>Reverse flow stopped</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A></TD><TD>n_const</TD><TD>n0</TD><TD>Constant rotational speed [rev/min]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Characteristics</TD></TR>
<TR><TD colspan="2">replaceable function flowCharacteristic</TD><TD>Functions.PumpCharacteristic...</TD><TD>Head vs. q_flow characteristic at nominal speed and density</TD></TR>
<TR><TD>Boolean</TD><TD>usePowerCharacteristic</TD><TD>false</TD><TD>Use powerCharacteristic (vs. efficiencyCharacteristic)</TD></TR>
<TR><TD colspan="2">replaceable function powerCharacteristic</TD><TD>Functions.PumpCharacteristic...</TD><TD>Power consumption vs. q_flow at nominal speed and density</TD></TR>
<TR><TD colspan="2">replaceable function efficiencyCharacteristic</TD><TD>Functions.PumpCharacteristic...</TD><TD>Efficiency vs. q_flow at nominal speed and density</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rho0</TD><TD>1000</TD><TD>Nominal Liquid Density [kg/m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A></TD><TD>n0</TD><TD>&nbsp;</TD><TD>Nominal rotational speed [rev/min]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pin_start</TD><TD>&nbsp;</TD><TD>Inlet Pressure Start Value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pout_start</TD><TD>&nbsp;</TD><TD>Outlet Pressure Start Value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wstart</TD><TD>&nbsp;</TD><TD>Mass Flow Rate Start Value [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart</TD><TD>1e5</TD><TD>Fluid Specific Enthalpy Start Value [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.IntegerInput"
>IntegerInput</A></TD><TD>in_Np</TD><TD>Number of  parallel pumps</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_n</TD><TD>RPM</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> Pump <font color="darkgreen">&quot;Centrifugal pump with ideally controlled speed&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Water.html#ThermoPower.Water.PumpBase"
>PumpBase</A>;
  <font color="blue">import </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits"
>Modelica.SIunits.Conversions.NonSIunits</A>.*;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A> n_const=n0 <font color="darkgreen">&quot;Constant rotational speed&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> in_n <font color="darkgreen">&quot;RPM&quot;</font>;
<font color="blue">equation </font>
    n = in_n <font color="darkgreen">&quot;Rotational speed&quot;</font>;
  <font color="blue">if </font><font color="red">cardinality</font>(in_n)==0<font color="blue"> then</font>
    in_n = n_const <font color="darkgreen">&quot;Rotational speed provided by parameter&quot;</font>;
  <font color="blue">end if</font>;
<font color="blue">end </font>Pump;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE PumpNPSH<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.PumpI.png" ALT="ThermoPower.Water.PumpNPSH" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.PumpNPSH"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.PumpNPSH</H2>
<IMG SRC="ThermoPower.Water.PumpD.png" ALT="ThermoPower.Water.PumpNPSH">
<H3>Information</H3>
<PRE></pre>Same as Pump. Additionally, the net positive suction head available is computed. Requires a two-phase medium model to compute the saturation properties.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Integer</TD><TD>Np0</TD><TD>1</TD><TD>Nominal number of pumps in parallel</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V</TD><TD>0</TD><TD>Pump Internal Volume [m3]</TD></TR>
<TR><TD>Boolean</TD><TD>CheckValve</TD><TD>false</TD><TD>Reverse flow stopped</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A></TD><TD>n_const</TD><TD>n0</TD><TD>Constant rotational speed [rev/min]</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Characteristics</TD></TR>
<TR><TD colspan="2">replaceable function flowCharacteristic</TD><TD>Functions.PumpCharacteristic...</TD><TD>Head vs. q_flow characteristic at nominal speed and density</TD></TR>
<TR><TD>Boolean</TD><TD>usePowerCharacteristic</TD><TD>false</TD><TD>Use powerCharacteristic (vs. efficiencyCharacteristic)</TD></TR>
<TR><TD colspan="2">replaceable function powerCharacteristic</TD><TD>Functions.PumpCharacteristic...</TD><TD>Power consumption vs. q_flow at nominal speed and density</TD></TR>
<TR><TD colspan="2">replaceable function efficiencyCharacteristic</TD><TD>Functions.PumpCharacteristic...</TD><TD>Efficiency vs. q_flow at nominal speed and density</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rho0</TD><TD>1000</TD><TD>Nominal Liquid Density [kg/m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A></TD><TD>n0</TD><TD>&nbsp;</TD><TD>Nominal rotational speed [rev/min]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pin_start</TD><TD>&nbsp;</TD><TD>Inlet Pressure Start Value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pout_start</TD><TD>&nbsp;</TD><TD>Outlet Pressure Start Value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wstart</TD><TD>&nbsp;</TD><TD>Mass Flow Rate Start Value [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart</TD><TD>1e5</TD><TD>Fluid Specific Enthalpy Start Value [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.IntegerInput"
>IntegerInput</A></TD><TD>in_Np</TD><TD>Number of  parallel pumps</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>in_n</TD><TD>RPM</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> PumpNPSH
  <font color="blue">extends </font><A HREF="ThermoPower_Water.html#ThermoPower.Water.Pump"
>Pump</A>(<font color="blue">redeclare </font><font color="blue">replaceable </font><font color="blue">package</font> Medium =
      <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialTwoPhaseMedium.html#Modelica.Media.Interfaces.PartialTwoPhaseMedium"
>Modelica.Media.Interfaces.PartialTwoPhaseMedium</A>);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Height"
>Height</A> NPSHa <font color="darkgreen">&quot;Net Positive Suction Head available&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> pv <font color="darkgreen">&quot;Saturated liquid pressure&quot;</font>;
<font color="blue">equation </font>
  pv=<font color="red">Medium.saturationPressure</font>(inletFluid.T);
  NPSHa=(infl.p-pv)/(rho*g);
<font color="blue">end </font>PumpNPSH;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE PumpMech<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.PumpMechI.png" ALT="ThermoPower.Water.PumpMech" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.PumpMech"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.PumpMech</H2>
<B>Centrifugal pump with mechanical connector for the shaft</B><p>
<IMG SRC="ThermoPower.Water.PumpMechD.png" ALT="ThermoPower.Water.PumpMech">
<H3>Information</H3>
<PRE></pre>
<p>This model describes a centrifugal pump (or a group of <tt>Np</tt> pumps in parallel) with a mechanical rotational connector for the shaft, to be used when the pump drive has to be modelled explicitly. In the case of <tt>Np</tt> pumps in parallel, the mechanical connector is relative to a single pump.
<p>The model extends <tt>PumpBase</tt>
 <pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>StandardWater</TD><TD>Medium model</TD></TR>
<TR><TD>Integer</TD><TD>Np0</TD><TD>1</TD><TD>Nominal number of pumps in parallel</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V</TD><TD>0</TD><TD>Pump Internal Volume [m3]</TD></TR>
<TR><TD>Boolean</TD><TD>CheckValve</TD><TD>false</TD><TD>Reverse flow stopped</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Characteristics</TD></TR>
<TR><TD colspan="2">replaceable function flowCharacteristic</TD><TD>Functions.PumpCharacteristic...</TD><TD>Head vs. q_flow characteristic at nominal speed and density</TD></TR>
<TR><TD>Boolean</TD><TD>usePowerCharacteristic</TD><TD>false</TD><TD>Use powerCharacteristic (vs. efficiencyCharacteristic)</TD></TR>
<TR><TD colspan="2">replaceable function powerCharacteristic</TD><TD>Functions.PumpCharacteristic...</TD><TD>Power consumption vs. q_flow at nominal speed and density</TD></TR>
<TR><TD colspan="2">replaceable function efficiencyCharacteristic</TD><TD>Functions.PumpCharacteristic...</TD><TD>Efficiency vs. q_flow at nominal speed and density</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rho0</TD><TD>1000</TD><TD>Nominal Liquid Density [kg/m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits_Conversions_NonSIunits.html#Modelica.SIunits.Conversions.NonSIunits.AngularVelocity_rpm"
>AngularVelocity_rpm</A></TD><TD>n0</TD><TD>&nbsp;</TD><TD>Nominal rotational speed [rev/min]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pin_start</TD><TD>&nbsp;</TD><TD>Inlet Pressure Start Value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pout_start</TD><TD>&nbsp;</TD><TD>Outlet Pressure Start Value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wstart</TD><TD>&nbsp;</TD><TD>Mass Flow Rate Start Value [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstart</TD><TD>1e5</TD><TD>Fluid Specific Enthalpy Start Value [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>Choices.Init.Options.noInit</TD><TD>Initialisation option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>infl</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outfl</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.IntegerInput"
>IntegerInput</A></TD><TD>in_Np</TD><TD>Number of  parallel pumps</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Flange_a</A></TD><TD>MechPort</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> PumpMech <font color="darkgreen">
  &quot;Centrifugal pump with mechanical connector for the shaft&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Water.html#ThermoPower.Water.PumpBase"
>PumpBase</A>;
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.PumpMech"
>Icons.Water.PumpMech</A>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</A> phi <font color="darkgreen">&quot;Shaft angle&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>AngularVelocity</A> omega <font color="darkgreen">&quot;Shaft angular velocity&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> MechPort;
<font color="blue">equation </font>
  <font color="darkgreen">// Mechanical boundary condition</font>
  phi = MechPort.phi;
  omega =<font color="red"> der</font>(phi);
  W = omega*MechPort.tau;

  n =<font color="red"> Modelica.SIunits.Conversions.to_rpm</font>(omega) <font color="darkgreen">&quot;Rotational speed&quot;</font>;
<font color="blue">end </font>PumpMech;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE f_chen<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="ThermoPower.Water.f_chen"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.f_chen</H2>
<B>Chen's correlation for two-phase flow in a tube</B><p>
<H3>Information</H3>
<PRE></pre>
<p>Chen's correlation for the computation of the heat transfer coefficient in two-phase flows.
<p><b>Revision history:</b></p>
<ul>
<li><i>20 Dec 2003</i>
    by <a href="mailto:francesco.casella@polimi.it">Francesco Casella</a>:<br>
       First release.</li>
</ul>
<pre></PRE>
<H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>w</TD><TD>&nbsp;</TD><TD>Mass flowrate [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>D</TD><TD>&nbsp;</TD><TD>Tube hydraulic diameter [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Tube cross-section [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>muf</TD><TD>&nbsp;</TD><TD>Liquid dynamic viscosity [Pa.s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>kf</TD><TD>&nbsp;</TD><TD>Liquid thermal conductivity [W/(m.K)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>SpecificHeatCapacity</A></TD><TD>cpf</TD><TD>&nbsp;</TD><TD>Liquid cp [J/(kg.K)]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.LiquidDensity"
>LiquidDensity</A></TD><TD>rhof</TD><TD>&nbsp;</TD><TD>Liquid density [kg/m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SurfaceTension"
>SurfaceTension</A></TD><TD>sigma</TD><TD>&nbsp;</TD><TD>Surface Tension [N/m]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.GasDensity"
>GasDensity</A></TD><TD>rhog</TD><TD>&nbsp;</TD><TD>Vapour density [kg/m3]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>mug</TD><TD>&nbsp;</TD><TD>Vapour dynamic viscosity [Pa.s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A></TD><TD>DTsat</TD><TD>&nbsp;</TD><TD>Saturation temperature difference (wall-bulk) [K]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>Dpsat</TD><TD>&nbsp;</TD><TD>Saturation pressure difference (wall-bulk) [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>ifg</TD><TD>&nbsp;</TD><TD>Latent heat of vaporization [J/kg]</TD></TR>
<TR><TD>Real</TD><TD>x</TD><TD>&nbsp;</TD><TD>Steam quality</TD></TR>
</TABLE>
<H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>hTP</TD><TD>Two-phase total heat transfer coefficient [W/(m2.K)]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> f_chen <font color="darkgreen">&quot;Chen's correlation for two-phase flow in a tube&quot;</font>

  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass flowrate&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> D <font color="darkgreen">&quot;Tube hydraulic diameter&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> A <font color="darkgreen">&quot;Tube cross-section&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A> muf <font color="darkgreen">&quot;Liquid dynamic viscosity&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A> kf <font color="darkgreen">&quot;Liquid thermal conductivity&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>SpecificHeatCapacity</A> cpf <font color="darkgreen">&quot;Liquid cp&quot;</font>;
  <font color="blue">input </font><A HREF="ThermoPower.html#ThermoPower.LiquidDensity"
>LiquidDensity</A> rhof <font color="darkgreen">&quot;Liquid density&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SurfaceTension"
>SurfaceTension</A> sigma <font color="darkgreen">&quot;Surface Tension&quot;</font>;
  <font color="blue">input </font><A HREF="ThermoPower.html#ThermoPower.GasDensity"
>GasDensity</A> rhog <font color="darkgreen">&quot;Vapour density&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A> mug <font color="darkgreen">&quot;Vapour dynamic viscosity&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Temperature"
>Temperature</A> DTsat <font color="darkgreen">&quot;Saturation temperature difference (wall-bulk)&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> Dpsat <font color="darkgreen">&quot;Saturation pressure difference (wall-bulk)&quot;</font>;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> ifg <font color="darkgreen">&quot;Latent heat of vaporization&quot;</font>;
  <font color="blue">input </font>Real x <font color="darkgreen">&quot;Steam quality&quot;</font>;
  <font color="blue">output </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> hTP <font color="darkgreen">
    &quot;Two-phase total heat transfer coefficient&quot;</font>;
<font color="blue">protected </font>
  Real invXtt;
  Real F;
  Real S;
  Real Ref;
  Real Prf;
  Real ReTP;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> hC;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> hNcB;
<font color="blue">algorithm </font>
  invXtt := (x/(1 - x))^0.9*(rhof/rhog)^0.5*(mug/muf)^0.1;
  <font color="blue">if </font>invXtt &lt; 0.1<font color="blue"> then</font>
    F := 1;
  <font color="blue">else</font>
    F := 2.35*(invXtt + 0.213)^0.736;
  <font color="blue">end if</font>;
  Ref := (w/A*(1 - x)*D)/muf;
  Prf := (muf*cpf/kf);
  hC := 0.023*Ref^0.8*Prf^0.4*kf/D*F;
  ReTP := F^1.25*Ref;
  S := 1/(1 + 2.53e-6*ReTP^1.17);
  hNcB := 0.00122*(kf^0.79*cpf^0.45*rhof^0.49)/(sigma^0.5*muf^0.29*ifg^0.24
    *rhog^0.24)*<font color="red">max</font>(0, DTsat)^0.24*<font color="red">max</font>(0, Dpsat)^0.75*S;
  hTP := hC + hNcB;
<font color="blue">end </font>f_chen;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE f_colebrook<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="ThermoPower.Water.f_colebrook"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.f_colebrook</H2>
<B>Fanning friction factor for water/steam flows</B><p>
<H3>Information</H3>
<PRE></pre>
<p>The Fanning friction factor is computed by Colebrook's equation, assuming turbulent, one-phase flow. For low Reynolds numbers, the limit value for turbulent flow is returned.
<p><b>Revision history:</b></p>
<ul>
<li><i>1 Oct 2003</i>
    by <a href="mailto:francesco.casella@polimi.it">Francesco Casella</a>:<br>
       First release.</li>
</ul>
<pre></PRE>
<H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>w</TD><TD>&nbsp;</TD><TD>[kg/s]</TD></TR>
<TR><TD>Real</TD><TD>D_A</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>e</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>mu</TD><TD>&nbsp;</TD><TD>[Pa.s]</TD></TR>
</TABLE>
<H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>f</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> f_colebrook <font color="darkgreen">&quot;Fanning friction factor for water/steam flows&quot;</font>
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w;
  <font color="blue">input </font>Real D_A;
  <font color="blue">input </font>Real e;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A> mu;
  <font color="blue">output </font>Real f;
<font color="blue">protected </font>
  Real Re;
<font color="blue">algorithm </font>
  Re := w*D_A/mu;
  Re := <font color="blue">if </font>Re &gt; 2100<font color="blue"> then </font>Re<font color="blue"> else </font>2100;
  f := 0.332/(<font color="red">log</font>(e/3.7 + 5.47/Re^0.9)^2);
<font color="blue">end </font>f_colebrook;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE f_colebrook_2ph<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="ThermoPower.Water.f_colebrook_2ph"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.f_colebrook_2ph</H2>
<B>Fanning friction factor for a two phase water/steam flow</B><p>
<H3>Information</H3>
<PRE></pre>
<p>The Fanning friction factor is computed by Colebrook's equation, assuming turbulent, homogeneous two-phase flow. For low Reynolds numbers, the limit value for turbulent flow is returned.
<p><b>Revision history:</b></p>
<ul>
<li><i>1 Oct 2003</i>
    by <a href="mailto:francesco.casella@polimi.it">Francesco Casella</a>:<br>
       First release.</li>
</ul>
<pre></PRE>
<H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>w</TD><TD>&nbsp;</TD><TD>[kg/s]</TD></TR>
<TR><TD>Real</TD><TD>D_A</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>
<TR><TD>Real</TD><TD>e</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>mul</TD><TD>&nbsp;</TD><TD>[Pa.s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>muv</TD><TD>&nbsp;</TD><TD>[Pa.s]</TD></TR>
<TR><TD>Real</TD><TD>x</TD><TD>&nbsp;</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>f</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> f_colebrook_2ph <font color="darkgreen">
  &quot;Fanning friction factor for a two phase water/steam flow&quot;</font>
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w;
  <font color="blue">input </font>Real D_A;
  <font color="blue">input </font>Real e;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A> mul;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A> muv;
  <font color="blue">input </font>Real x;
  <font color="blue">output </font>Real f;
<font color="blue">protected </font>
  Real Re;
<font color="blue">protected </font>
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A> mu;
<font color="blue">algorithm </font>
  mu := 1/(x/muv + (1 - x)/mul);
  Re := w*D_A/mu;
  Re := <font color="blue">if </font>Re &gt; 2100<font color="blue"> then </font>Re<font color="blue"> else </font>2100;
  f := 0.332/(<font color="red">log</font>(e/3.7 + 5.47/Re^0.9)^2);
<font color="blue">end </font>f_colebrook_2ph;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE f_dittus_boelter<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="ThermoPower.Water.f_dittus_boelter"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.f_dittus_boelter</H2>
<B>Dittus-Boelter correlation for one-phase flow in a tube</B><p>
<H3>Information</H3>
<PRE></pre>
<p>Dittus-Boelter's correlation for the computation of the heat transfer coefficient in one-phase flows.
<p><b>Revision history:</b></p>
<ul>
<li><i>20 Dec 2003</i>
    by <a href="mailto:francesco.casella@polimi.it">Francesco Casella</a>:<br>
Input variables changed. This function now computes the heat transfer coefficient as a function of all the required fluid properties and flow parameters.</li>
<li><i>1 Oct 2003</i>
    by <a href="mailto:francesco.casella@polimi.it">Francesco Casella</a>:<br>
       First release.</li>
</ul>
<pre></PRE>
<H3>Inputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>w</TD><TD>&nbsp;</TD><TD>[kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>D</TD><TD>&nbsp;</TD><TD>[m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>[m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A></TD><TD>mu</TD><TD>&nbsp;</TD><TD>[Pa.s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A></TD><TD>k</TD><TD>&nbsp;</TD><TD>[W/(m.K)]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>SpecificHeatCapacity</A></TD><TD>cp</TD><TD>&nbsp;</TD><TD>[J/(kg.K)]</TD></TR>
</TABLE>
<H3>Outputs</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A></TD><TD>hTC</TD><TD>[W/(m2.K)]</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">function</font> f_dittus_boelter <font color="darkgreen">
  &quot;Dittus-Boelter correlation for one-phase flow in a tube&quot;</font>

  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> D;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> A;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.DynamicViscosity"
>DynamicViscosity</A> mu;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.ThermalConductivity"
>ThermalConductivity</A> k;
  <font color="blue">input </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificHeatCapacity"
>SpecificHeatCapacity</A> cp;
  <font color="blue">output </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.CoefficientOfHeatTransfer"
>CoefficientOfHeatTransfer</A> hTC;
<font color="blue">protected </font>
  Real Re;
  Real Pr;
<font color="blue">algorithm </font>
  Re := w*D/A/mu;
  Pr := cp*mu/k;
  hTC := 0.023*k/D*Re^0.8*Pr^0.4;
<font color="blue">end </font>f_dittus_boelter;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SteamTurbineBase<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.SteamTurbineBaseI.png" ALT="ThermoPower.Water.SteamTurbineBase" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.SteamTurbineBase"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.SteamTurbineBase</H2>
<B>Steam turbine</B><p>
<IMG SRC="ThermoPower.Water.SteamTurbineBaseD.png" ALT="ThermoPower.Water.SteamTurbineBase">
<H3>Information</H3>
<PRE></pre>
<p>This base model contains the basic interface, parameters and definitions for steam turbine models. It lacks the actual performance characteristics, i.e. two more equations to determine the flow rate and the efficiency.
<p>This model does not include any shaft inertia by itself; if that is needed, connect a <tt>Modelica.Mechanics.Rotational.Inertia</tt> model to one of the shaft connectors.
<p><b>Modelling options</b></p>
<p>The following options are available to calculate the enthalpy of the outgoing steam:
<ul><li><tt>explicitIsentropicEnthalpy = true</tt>: the isentropic enthalpy <tt>hout_iso</tt> is calculated by the <tt>Medium.isentropicEnthalpy</tt> function. <li><tt>explicitIsentropicEnthalpy = false</tt>: the isentropic enthalpy is given equating the specific entropy of the inlet steam <tt>steam_in</tt> and of a fictional steam state <tt>steam_iso</tt>, which has the same pressure of the outgoing steam, both computed with the function <tt>Medium.specificEntropy</tt>.</pp></ul>
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Boolean</TD><TD>explicitIsentropicEnthalpy</TD><TD>true</TD><TD>Outlet enthalpy computed by isentropicEnthalpy function</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Inlet nominal flowrate [kg/s]</TD></TR>
<TR><TD>Real</TD><TD>eta_mech</TD><TD>0.98</TD><TD>Mechanical efficiency</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart_in</TD><TD>&nbsp;</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart_out</TD><TD>&nbsp;</TD><TD>Outlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wstart</TD><TD>&nbsp;</TD><TD>Mass flow rate start value [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartin</TD><TD>&nbsp;</TD><TD>Inlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartout</TD><TD>&nbsp;</TD><TD>Outlet enthalpy start value [J/kg]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>partialArc</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Flange_a</A></TD><TD>shaft_a</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Flange_b</A></TD><TD>shaft_b</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> SteamTurbineBase <font color="darkgreen">&quot;Steam turbine&quot;</font>
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = ThermoPower.Water.StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <font color="blue">parameter </font>Boolean explicitIsentropicEnthalpy=true <font color="darkgreen">
    &quot;Outlet enthalpy computed by isentropicEnthalpy function&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstart_in <font color="darkgreen">&quot;Inlet pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstart_out <font color="darkgreen">&quot;Outlet pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wstart <font color="darkgreen">&quot;Mass flow rate start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hstartin <font color="darkgreen">&quot;Inlet enthalpy start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hstartout <font color="darkgreen">&quot;Outlet enthalpy start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wnom <font color="darkgreen">&quot;Inlet nominal flowrate&quot;</font>;
  <font color="blue">parameter </font>Real eta_mech=0.98 <font color="darkgreen">&quot;Mechanical efficiency&quot;</font>;

  Medium.BaseProperties steam_in(p(start=pstart_in),h(start=hstartin));
  Medium.BaseProperties steam_iso(p(start=pstart_out),h(start=hstartout));

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</A> phi <font color="darkgreen">&quot;shaft rotation angle&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Torque"
>Torque</A> tau <font color="darkgreen">&quot;net torque acting on the turbine&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>AngularVelocity</A> omega <font color="darkgreen">&quot;shaft angular velocity&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w(start=wstart) <font color="darkgreen">&quot;Mass flow rate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hin(start=hstartin) <font color="darkgreen">&quot;Inlet enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hout(start=hstartout) <font color="darkgreen">&quot;Outlet enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hiso(start=hstartout) <font color="darkgreen">&quot;Isentropic outlet enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEntropy"
>Medium.SpecificEntropy</A> sin <font color="darkgreen">&quot;Inlet entropy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> pout(start=pstart_out) <font color="darkgreen">&quot;Outlet pressure&quot;</font>;
  Real PR <font color="darkgreen">&quot;pressure ratio&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> Pm <font color="darkgreen">&quot;Mechanical power input&quot;</font>;
  Real eta_iso <font color="darkgreen">&quot;Isentropic efficiency&quot;</font>;

  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> partialArc;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> shaft_a;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Modelica.Mechanics.Rotational.Interfaces.Flange_b</A> shaft_b;
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>ThermoPower.Water.FlangeA</A> inlet(
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium,
    p(start=pstart_in));
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>ThermoPower.Water.FlangeB</A> outlet(
    <font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium,
    p(start=pstart_out));

<font color="blue">equation </font>
  PR=inlet.p/outlet.p <font color="darkgreen">&quot;Pressure ratio&quot;</font>;
  <font color="blue">if </font><font color="red">cardinality</font>(partialArc)==0<font color="blue"> then</font>
    partialArc =1 <font color="darkgreen">&quot;Default value if not connected&quot;</font>;
  <font color="blue">end if</font>;
  <font color="blue">if </font>explicitIsentropicEnthalpy<font color="blue"> then</font>
    hiso=<font color="red">Medium.isentropicEnthalpy</font>(outlet.p, steam_in.state) <font color="darkgreen">
      &quot;Isentropic enthalpy&quot;</font>;
    <font color="darkgreen">//dummy assignments</font>
    sin=0;
    steam_iso.p=1e5;
    steam_iso.h=1e5;
  <font color="blue">else</font>
     steam_iso.p = pout;
     sin=<font color="red">Medium.specificEntropy</font>(steam_in.state);
     sin=<font color="red">Medium.specificEntropy</font>(steam_iso.state);
     hiso=steam_iso.h;
  <font color="blue">end if</font>;
    hin-hout=eta_iso*(hin-hiso) <font color="darkgreen">&quot;Computation of outlet enthalpy&quot;</font>;
  Pm=eta_mech*w*(hin-hout) <font color="darkgreen">&quot;Mechanical power from the steam&quot;</font>;
  Pm = -tau*omega <font color="darkgreen">&quot;Mechanical power balance&quot;</font>;

  <font color="darkgreen">// Mechanical boundary conditions</font>
  shaft_a.phi = phi;
  shaft_b.phi = phi;
  shaft_a.tau + shaft_b.tau = tau;
  <font color="red">der</font>(phi) = omega;

  <font color="darkgreen">// steam boundary conditions and inlet steam properties</font>
  steam_in.p=inlet.p;
  steam_in.h=inlet.hBA;
  hin=steam_in.h;
  hout=outlet.hBA;
  pout=outlet.p;
  w = inlet.w;

  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  <font color="darkgreen">// assert(w &gt;= -wnom/100, &quot;The turbine model does not support flow reversal&quot;);</font>

  <font color="darkgreen">// The next equation is provided to close the balance but never actually used</font>
  inlet.hAB = outlet.hBA;

<font color="blue">end </font>SteamTurbineBase;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SteamTurbineStodola<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.SteamTurbineBaseI.png" ALT="ThermoPower.Water.SteamTurbineStodola" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.SteamTurbineStodola"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.SteamTurbineStodola</H2>
<B>Steam turbine</B><p>
<IMG SRC="ThermoPower.Water.SteamTurbineBaseD.png" ALT="ThermoPower.Water.SteamTurbineStodola">
<H3>Information</H3>
<PRE></pre>
<p>This model extends <tt>SteamTurbineBase</tt> by adding the actual performance characteristics:
<ul>
<li>Stodola's law
<li>Constant isentropic efficiency
</ul></p>
<p>The inlet flowrate is also proportional to the <tt>partialArc</tt> signal if the corresponding connector is wired. In this case, it is assumed that the flow rate is reduced by partial arc admission, not by throttling (i.e., no loss of thermodynamic efficiency occurs). To simulate throttling, insert a valve model before the turbine inlet.
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>ThermoPower.Water.StandardWa...</TD><TD>Medium model</TD></TR>
<TR><TD>Boolean</TD><TD>explicitIsentropicEnthalpy</TD><TD>true</TD><TD>Outlet enthalpy computed by isentropicEnthalpy function</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Inlet nominal flowrate [kg/s]</TD></TR>
<TR><TD>Real</TD><TD>eta_mech</TD><TD>0.98</TD><TD>Mechanical efficiency</TD></TR>
<TR><TD>Real</TD><TD>eta_iso_nom</TD><TD>0.92</TD><TD>Nominal isentropic efficiency</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>Kt</TD><TD>&nbsp;</TD><TD>Kt coefficient of Stodola's law [m2]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialisation</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart_in</TD><TD>&nbsp;</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstart_out</TD><TD>&nbsp;</TD><TD>Outlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wstart</TD><TD>&nbsp;</TD><TD>Mass flow rate start value [kg/s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartin</TD><TD>&nbsp;</TD><TD>Inlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartout</TD><TD>&nbsp;</TD><TD>Outlet enthalpy start value [J/kg]</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>partialArc</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Flange_a</A></TD><TD>shaft_a</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Flange_b</A></TD><TD>shaft_b</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SteamTurbineStodola <font color="darkgreen">&quot;Steam turbine&quot;</font>
  <font color="blue">extends </font><A HREF="ThermoPower_Water.html#ThermoPower.Water.SteamTurbineBase"
>SteamTurbineBase</A>;
  <font color="blue">parameter </font>Real eta_iso_nom=0.92 <font color="darkgreen">&quot;Nominal isentropic efficiency&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> Kt <font color="darkgreen">&quot;Kt coefficient of Stodola's law&quot;</font>;
<font color="blue">equation </font>
  w = Kt*partialArc*<font color="red">sqrt</font>(steam_in.p*steam_in.d)*<font color="red">Functions.sqrtReg</font>(1-(1/PR)^2) <font color="darkgreen">
    &quot;Stodola's law&quot;</font>;
  eta_iso = eta_iso_nom <font color="darkgreen">&quot;Constant efficiency&quot;</font>;
<font color="blue">end </font>SteamTurbineStodola;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE SteamTurbineUnit<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.SteamTurbineUnitI.png" ALT="ThermoPower.Water.SteamTurbineUnit" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.SteamTurbineUnit"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.SteamTurbineUnit</H2>
<B>Turbine for steam flows</B><p>
<IMG SRC="ThermoPower.Water.SteamTurbineUnitD.png" ALT="ThermoPower.Water.SteamTurbineUnit">
<H3>Information</H3>
<PRE></pre>
<p>This model describes a simplified steam turbine unit, with a high pressure and a low pressure turbine.<p>
The inlet flowrate is proportional to the inlet pressure, and to the <tt>partialArc</tt> signal if the corresponding connector is wired. In this case, it is assumed that the flow rate is reduced by partial arc admission, not by throttling (i.e., no loss of thermodynamic efficiency occurs). To simulate throttling, insert a valve before the turbine unit inlet.
<p>The model assumes that a fraction <tt>hpFraction</tt> of the available hydraulic power is converted by the HP turbine with a time constant of <tt>T_HP</tt>, while the remaining part is converted by the LP turbine with a time constant of <tt>L_HP</tt>.
<p>This model does not include any shaft inertia by itself; if that is needed, connect a <tt>Modelica.Mechanics.Rotational.Inertia</tt> model to one of the shaft connectors.
<p>The model requires the <tt>Modelica.Media</tt> library (<tt>ThermoFluid</tt> does not compute the isentropic enthalpy correctly).
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Real</TD><TD>pnom</TD><TD>&nbsp;</TD><TD>Inlet nominal pressure</TD></TR>
<TR><TD>Real</TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Inlet nominal flowrate</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.PerUnit"
>PerUnit</A></TD><TD>eta_iso</TD><TD>&nbsp;</TD><TD>Isentropic efficiency [pu]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.PerUnit"
>PerUnit</A></TD><TD>eta_mech</TD><TD>0.98</TD><TD>Mechanical efficiency [pu]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.PerUnit"
>PerUnit</A></TD><TD>hpFraction</TD><TD>&nbsp;</TD><TD>Fraction of power provided by the HP turbine [pu]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A></TD><TD>T_HP</TD><TD>&nbsp;</TD><TD>Time constant of HP mechanical power response [s]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A></TD><TD>T_LP</TD><TD>&nbsp;</TD><TD>Time constant of LP mechanical power response [s]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialization</B></TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartin</TD><TD>pnom</TD><TD>Inlet start pressure [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartin</TD><TD>&nbsp;</TD><TD>Inlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartout</TD><TD>&nbsp;</TD><TD>Outlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>Temp</A></TD><TD>initOpt</TD><TD>ThermoPower.Choices.Init.Opt...</TD><TD>Initialization option</TD></TR>
</TABLE>
<H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A></TD><TD>inlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A></TD><TD>outlet</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Flange_a</A></TD><TD>shaft_a</TD><TD>&nbsp;</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Flange_b</A></TD><TD>shaft_b</TD><TD>&nbsp;</TD></TR>
<TR><TD>input <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>RealInput</A></TD><TD>partialArc</TD><TD>&nbsp;</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> SteamTurbineUnit <font color="darkgreen">&quot;Turbine for steam flows&quot;</font>
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.SteamTurbineUnit"
>Icons.Water.SteamTurbineUnit</A>;
  <font color="blue">parameter </font>Real pnom <font color="darkgreen">&quot;Inlet nominal pressure&quot;</font>;
  <font color="blue">parameter </font>Real wnom <font color="darkgreen">&quot;Inlet nominal flowrate&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.PerUnit"
>PerUnit</A> eta_iso <font color="darkgreen">&quot;Isentropic efficiency&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.PerUnit"
>PerUnit</A> eta_mech=0.98 <font color="darkgreen">&quot;Mechanical efficiency&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.PerUnit"
>PerUnit</A> hpFraction <font color="darkgreen">&quot;Fraction of power provided by the HP turbine&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A> T_HP <font color="darkgreen">&quot;Time constant of HP mechanical power response&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A> T_LP <font color="darkgreen">&quot;Time constant of LP mechanical power response&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstartin = pnom <font color="darkgreen">&quot;Inlet start pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hstartin <font color="darkgreen">&quot;Inlet enthalpy start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hstartout <font color="darkgreen">&quot;Outlet enthalpy start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower_Choices_Init_Options.html#ThermoPower.Choices.Init.Options.Temp"
>ThermoPower.Choices.Init.Options.Temp</A> initOpt=ThermoPower.Choices.Init.Options.steadyState <font color="darkgreen">
    &quot;Initialization option&quot;</font>;
  Medium.BaseProperties fluid_in(p(start=pstartin),h(start=hstartin));
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeA"
>FlangeA</A> inlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="ThermoPower_Water.html#ThermoPower.Water.FlangeB"
>FlangeB</A> outlet(<font color="blue">redeclare </font><font color="blue">package</font> Medium = Medium);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_a"
>Modelica.Mechanics.Rotational.Interfaces.Flange_a</A> shaft_a;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Mechanics_Rotational_Interfaces.html#Modelica.Mechanics.Rotational.Interfaces.Flange_b"
>Modelica.Mechanics.Rotational.Interfaces.Flange_b</A> shaft_b;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> w <font color="darkgreen">&quot;Mass flowrate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Angle"
>Angle</A> phi <font color="darkgreen">&quot;Shaft rotation angle&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.AngularVelocity"
>AngularVelocity</A> omega <font color="darkgreen">&quot;Shaft angular velocity&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Torque"
>Torque</A> tau <font color="darkgreen">&quot;Net torque acting on the turbine&quot;</font>;
  Real Kv(unit=&quot;kg/(s.Pa)&quot;) <font color="darkgreen">&quot;Turbine nominal admittance at full throttle&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hin(start=hstartin) <font color="darkgreen">&quot;Inlet enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hout(start=hstartout) <font color="darkgreen">&quot;Outlet enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hiso(start=hstartout) <font color="darkgreen">&quot;Isentropic outlet enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> Pm <font color="darkgreen">&quot;Mechanical power input&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> P_HP <font color="darkgreen">&quot;Mechanical power produced by the HP turbine&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> P_LP <font color="darkgreen">&quot;Mechanical power produced by the LP turbine&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealInput"
>Modelica.Blocks.Interfaces.RealInput</A> partialArc;
<font color="blue">equation </font>
  <font color="blue">if </font><font color="red">cardinality</font>(partialArc)==0<font color="blue"> then</font>
    partialArc =1 <font color="darkgreen">&quot;Default value if not connected&quot;</font>;
  <font color="blue">end if</font>;
  Kv = partialArc*wnom/pnom <font color="darkgreen">&quot;Definition of Kv coefficient&quot;</font>;
  w=Kv*inlet.p <font color="darkgreen">&quot;Flow characteristics&quot;</font>;
  hiso=<font color="red">Medium.isentropicEnthalpy</font>(outlet.p, fluid_in.state) <font color="darkgreen">
    &quot;Isentropic enthalpy&quot;</font>;
  hin-hout=eta_iso*(hin-hiso) <font color="darkgreen">&quot;Computation of outlet enthalpy&quot;</font>;
  Pm=eta_mech*w*(hin-hout) <font color="darkgreen">&quot;Mechanical power from the fluid&quot;</font>;
  T_HP*<font color="red">der</font>(P_HP)=Pm*hpFraction-P_HP <font color="darkgreen">&quot;Power output to HP turbine&quot;</font>;
  T_LP*<font color="red">der</font>(P_LP)=Pm*(1-hpFraction)-P_LP <font color="darkgreen">&quot;Power output to LP turbine&quot;</font>;
  P_HP+P_LP = -tau*omega <font color="darkgreen">&quot;Mechanical power balance&quot;</font>;

  <font color="darkgreen">// Mechanical boundary conditions</font>
  shaft_a.phi = phi;
  shaft_b.phi = phi;
  shaft_a.tau + shaft_b.tau = tau;
  <font color="red">der</font>(phi) = omega;

  <font color="darkgreen">// Fluid boundary conditions and inlet fluid properties</font>
  fluid_in.p=inlet.p;
  fluid_in.h=hin;
  hin=inlet.hBA;
  hout=outlet.hBA;
  w = inlet.w;

  inlet.w + outlet.w = 0 <font color="darkgreen">&quot;Mass balance&quot;</font>;
  <font color="red">assert</font>(w &gt;= 0, &quot;The turbine model does not support flow reversal&quot;);

  <font color="darkgreen">// The next equation is provided to close the balance but never actually used</font>
  inlet.hAB = outlet.hBA;
<font color="blue">initial </font><font color="blue">equation </font>
  <font color="blue">if </font>initOpt == ThermoPower.Choices.Init.Options.noInit<font color="blue"> then</font>
    <font color="darkgreen">// do nothing</font>
  <font color="blue">elseif </font>initOpt == ThermoPower.Choices.Init.Options.steadyState<font color="blue"> then</font>
    <font color="red">der</font>(P_HP) = 0;
    <font color="red">der</font>(P_LP) = 0;
  <font color="blue">else</font>
    <font color="red">assert</font>(false, &quot;Unsupported initialisation option&quot;);
  <font color="blue">end if</font>;

<font color="blue">end </font>SteamTurbineUnit;
</PRE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE EvaporatorBase<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="ThermoPower.Water.EvaporatorBaseI.png" ALT="ThermoPower.Water.EvaporatorBase" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="ThermoPower.Water.EvaporatorBase"></A><A HREF="ThermoPower_Water.html#ThermoPower.Water"
>ThermoPower.Water</A>.EvaporatorBase</H2>
<B>Basic interface for 1-dimensional water/steam fluid flow models</B><p>
<H3>Information</H3>
<PRE></pre>
This model is not yet complete
<pre></PRE>
<H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD>Integer</TD><TD>N</TD><TD>2</TD><TD>Number of nodes for thermal variables</TD></TR>
<TR><TD>Integer</TD><TD>Nt</TD><TD>1</TD><TD>Number of tubes in parallel</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Distance"
>Distance</A></TD><TD>L</TD><TD>&nbsp;</TD><TD>Tube length [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A></TD><TD>H</TD><TD>0</TD><TD>Elevation of outlet over inlet [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A></TD><TD>A</TD><TD>&nbsp;</TD><TD>Cross-sectional area (single tube) [m2]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>omega</TD><TD>&nbsp;</TD><TD>Perimeter of heat transfer surface (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>Dhyd</TD><TD>&nbsp;</TD><TD>Hydraulic Diameter (single tube) [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A></TD><TD>wnom</TD><TD>&nbsp;</TD><TD>Nominal mass flowrate (total) [kg/s]</TD></TR>
<TR><TD>Integer</TD><TD>FFtype</TD><TD>&nbsp;</TD><TD>Friction Factor Type (0: Kf; 1:OpPoint, 2:Cfnom, 3:Colebrook)</TD></TR>
<TR><TD>Real</TD><TD>Kfnom</TD><TD>0</TD><TD>Nominal hydraulic resistance coefficient</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>dpnom</TD><TD>0</TD><TD>Nominal pressure drop (friction term only!) [Pa]</TD></TR>
<TR><TD><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A></TD><TD>rhonom</TD><TD>0</TD><TD>Nominal inlet density [kg/m3]</TD></TR>
<TR><TD>Real</TD><TD>Cfnom</TD><TD>0</TD><TD>Nominal Fanning friction factor</TD></TR>
<TR><TD>Real</TD><TD>e</TD><TD>0</TD><TD>Relative roughness (ratio roughness/diameter)</TD></TR>
<TR><TD>Boolean</TD><TD>DynamicMomentum</TD><TD>false</TD><TD>Inertial phenomena accounted for</TD></TR>
<TR><TD>Integer</TD><TD>HydraulicCapacitance</TD><TD>2</TD><TD>1: Upstream, 2: Downstream</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>csilstart</TD><TD>&nbsp;</TD><TD>Liquid boundary start position [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A></TD><TD>csivstart</TD><TD>&nbsp;</TD><TD>Vapour boundary start position [m]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartin</TD><TD>1e5</TD><TD>Inlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A></TD><TD>hstartout</TD><TD>1e5</TD><TD>Outlet enthalpy start value [J/kg]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartin</TD><TD>1e5</TD><TD>Inlet pressure start value [Pa]</TD></TR>
<TR><TD><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A></TD><TD>pstartout</TD><TD>1e5</TD><TD>Outlet pressure start value [Pa]</TD></TR>
<TR><TD>Real</TD><TD>wnf</TD><TD>0.01</TD><TD>Fraction of nominal flow rate at which linear friction equals turbulent friction</TD></TR>
<TR><TD>Real</TD><TD>Kfc</TD><TD>1</TD><TD>Friction factor correction coefficient</TD></TR>
</TABLE>
<H3>Modelica definition</H3>
<PRE>
<font color="blue">partial </font><font color="blue">model</font> EvaporatorBase <font color="darkgreen">
  &quot;Basic interface for 1-dimensional water/steam fluid flow models&quot;</font>
  <font color="blue">replaceable </font><font color="blue">package</font> Medium = StandardWater <font color="blue">extends </font>
    Modelica.Media.Interfaces.PartialTwoPhaseMedium <font color="darkgreen">&quot;Medium model&quot;</font>;
  Medium.BaseProperties fluid_in <font color="darkgreen">&quot;Fluid properties at the inlet&quot;</font>;
  Medium.BaseProperties fluid_out <font color="darkgreen">&quot;Fluid properties at the outlet&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialTwoPhaseMedium.html#Modelica.Media.Interfaces.PartialTwoPhaseMedium.SaturationProperties"
>Medium.SaturationProperties</A> sat <font color="darkgreen">&quot;Saturation properties&quot;</font>;
  <font color="blue">extends </font><A HREF="ThermoPower_Icons_Water.html#ThermoPower.Icons.Water.Tube"
>Icons.Water.Tube</A>;
  <font color="blue">parameter </font>Integer N(min=2) = 2 <font color="darkgreen">&quot;Number of nodes for thermal variables&quot;</font>;
  <font color="blue">parameter </font>Integer Nt=1 <font color="darkgreen">&quot;Number of tubes in parallel&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Distance"
>Distance</A> L <font color="darkgreen">&quot;Tube length&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Position"
>Position</A> H=0 <font color="darkgreen">&quot;Elevation of outlet over inlet&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Area"
>Area</A> A <font color="darkgreen">&quot;Cross-sectional area (single tube)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> omega <font color="darkgreen">&quot;Perimeter of heat transfer surface (single tube)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> Dhyd <font color="darkgreen">&quot;Hydraulic Diameter (single tube)&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wnom <font color="darkgreen">&quot;Nominal mass flowrate (total)&quot;</font>;
  <font color="blue">parameter </font>Integer FFtype <font color="darkgreen">
    &quot;Friction Factor Type (0: Kf; 1:OpPoint, 2:Cfnom, 3:Colebrook)&quot;</font>;
  <font color="blue">parameter </font>Real Kfnom=0 <font color="darkgreen">&quot;Nominal hydraulic resistance coefficient&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> dpnom=0 <font color="darkgreen">&quot;Nominal pressure drop (friction term only!)&quot;</font>;
  <font color="blue">parameter </font><A HREF="ThermoPower.html#ThermoPower.Density"
>Density</A> rhonom=0 <font color="darkgreen">&quot;Nominal inlet density&quot;</font>;
  <font color="blue">parameter </font>Real Cfnom=0 <font color="darkgreen">&quot;Nominal Fanning friction factor&quot;</font>;
  <font color="blue">parameter </font>Real e=0 <font color="darkgreen">&quot;Relative roughness (ratio roughness/diameter)&quot;</font>;
  <font color="blue">parameter </font>Boolean DynamicMomentum=false <font color="darkgreen">&quot;Inertial phenomena accounted for&quot;</font>;
  <font color="blue">parameter </font>Integer HydraulicCapacitance=2 <font color="darkgreen">&quot;1: Upstream, 2: Downstream&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> csilstart <font color="darkgreen">&quot;Liquid boundary start position&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> csivstart <font color="darkgreen">&quot;Vapour boundary start position&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hstartin=1e5 <font color="darkgreen">&quot;Inlet enthalpy start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.SpecificEnthalpy"
>SpecificEnthalpy</A> hstartout=1e5 <font color="darkgreen">&quot;Outlet enthalpy start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstartin=1e5 <font color="darkgreen">&quot;Inlet pressure start value&quot;</font>;
  <font color="blue">parameter </font><A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Pressure"
>Pressure</A> pstartout=1e5 <font color="darkgreen">&quot;Outlet pressure start value&quot;</font>;
  <font color="blue">parameter </font>Real wnf=0.01 <font color="darkgreen">
    &quot;Fraction of nominal flow rate at which linear friction equals turbulent friction&quot;</font>;
  <font color="blue">parameter </font>Real Kfc=1 <font color="darkgreen">&quot;Friction factor correction coefficient&quot;</font>;
  <font color="blue">constant </font>Real g=Modelica.Constants.g_n;
<font color="darkgreen">/*
  FlangeA infl(p(start=pstartin),w(start=wnom),hAB(start=hstartin),
    redeclare package Medium = Medium)
    annotation (extent=[-120, -20; -80, 20]);
  FlangeB outfl(p(start=pstartout),w(start=-wnom),hBA(start=hstartout),
    redeclare package Medium = Medium)
    annotation (extent=[80, -20; 120, 20]);
  replaceable ThermoPower.Thermal.DHT wall(N=N)
    annotation (extent=[-40, 40; 40, 60]);
*/</font>
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p(start=pstartin, stateSelect=StateSelect.prefer);
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> win(start=wnom) <font color="darkgreen">&quot;Inlet flow rate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wlb(start=wnom) <font color="darkgreen">&quot;Flowrate from liquid volume to boiling volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wbv(start=wnom) <font color="darkgreen">&quot;Flowrate from boiling volume to vapour volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> wout(start=wnom) <font color="darkgreen">&quot;Outlet flow rate&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hin( start=hstartin) <font color="darkgreen">&quot;Inlet specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hout(start=hstartout, stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;Outlet specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hls <font color="darkgreen">&quot;Saturated liquid specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hvs <font color="darkgreen">&quot;Saturated vapour specific enthalpy&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hlb;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> hbv;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Medium.Density</A> rhoin <font color="darkgreen">&quot;Inlet density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Medium.Density</A> rhoout <font color="darkgreen">&quot;Outlet density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Medium.Density</A> rhols <font color="darkgreen">&quot;Saturated liquid density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Medium.Density</A> rhovs <font color="darkgreen">&quot;Saturated vapour density&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vl <font color="darkgreen">&quot;Liquid volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vb <font color="darkgreen">&quot;Boiling volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A> Vv <font color="darkgreen">&quot;Vapour volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> Ml <font color="darkgreen">&quot;Mass of the liquid volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> Mb <font color="darkgreen">&quot;Mass of the boiling volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> Mbl <font color="darkgreen">&quot;Mass of liquid in the boiling volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> Mbv <font color="darkgreen">&quot;Mass of vapour in the boiling volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A> Mv <font color="darkgreen">&quot;Mass of the vapour volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Energy"
>Energy</A> El <font color="darkgreen">&quot;Energy of the liquid volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Energy"
>Energy</A> Eb <font color="darkgreen">&quot;Energy of the boiling volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Energy"
>Energy</A> Ev <font color="darkgreen">&quot;Energy of the vapour volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> Q <font color="darkgreen">&quot;Total power balance&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>MassFlowRate</A> M_flow <font color="darkgreen">&quot;Total mass flow balance&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> Ql <font color="darkgreen">&quot;Thermal power to the liquid volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> Qb <font color="darkgreen">&quot;Thermal power to the boiling volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Power"
>Power</A> Qv <font color="darkgreen">&quot;Thermal power to the vapour volume&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> csil(start=csilstart, stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;Abscissa of liqid boundary&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Length"
>Length</A> csiv(start=csivstart, stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;Abscissa of vapour boundary&quot;</font>;
  <A HREF="file:///C:/Programmi/Dymola 6.1/Modelica/Library/Modelica 2.2.1/help/Modelica_SIunits.html#Modelica.SIunits.Time"
>Time</A> Tr <font color="darkgreen">&quot;Residence time&quot;</font>;

<font color="blue">equation </font>
  Vl=A*csil <font color="darkgreen">&quot;Volume of subcooled liquid&quot;</font>;
  Vb=A*(csiv-csil) <font color="darkgreen">&quot;Volume of boiling liquid&quot;</font>;
  Vv=A*(L-csiv) <font color="darkgreen">&quot;Volume of superheated vapour&quot;</font>;
  Ml=(rhoin+(<font color="blue">if </font>hout&gt;hls<font color="blue"> then </font>rhols<font color="blue"> else </font>rhoout))/2*Vl <font color="darkgreen">
    &quot;Mass of subcooled liquid&quot;</font>;
  Mb=(<font color="blue">if </font>(hout &gt; hvs)<font color="blue"> then </font>
      rhols*rhovs/(rhols-rhovs)*<font color="red">log</font>(rhols/rhovs)<font color="blue"> else </font>
           <font color="blue">if </font>(hout&gt;hls+1e-3)<font color="blue"> then </font>
      rhols*rhoout/(rhols-rhoout)*<font color="red">log</font>(rhols/rhoout)<font color="blue"> else </font>
      rhols)
        * Vb <font color="darkgreen">&quot;Mass of boiling liquid&quot;</font>;
  Mbv=(<font color="blue">if </font>(hout &gt; hvs)<font color="blue"> then </font>
         rhols*rhovs/(rhols-rhovs)*(1-rhovs/(rhols-rhovs)*<font color="red">log</font>(rhols/rhovs))<font color="blue"> else </font>
             <font color="blue">if </font>(hout&gt;hls+1e-3)<font color="blue"> then </font>
         rhols*rhovs/(rhols-rhovs)*(1-rhoout/(rhols-rhoout)*<font color="red">log</font>(rhols/rhoout))<font color="blue"> else </font>
             <font color="blue">if </font>(hout&gt;hls)<font color="blue"> then </font>
         rhovs/(rhols-rhovs)*(rhols-rhoout)/2<font color="blue"> else </font>
         0)
         * Vb <font color="darkgreen">&quot;Mass of vapour in boiling liquid&quot;</font>;
  Mbl=Mb-Mbv <font color="darkgreen">&quot;Mass of liquid in boiling liquid&quot;</font>;
  Mv=Vv*(rhovs+rhoout)/2 <font color="darkgreen">&quot;Mass of superheated vapour&quot;</font>;
  El=Ml*(hin+(<font color="blue">if </font>hout&gt;hls<font color="blue"> then </font>hls<font color="blue"> else </font>hout))/2-p*Vl <font color="darkgreen">
    &quot;Energy of subcooled liquid&quot;</font>;
  Eb=Mbl*hls+Mbv*hvs-p*Vb <font color="darkgreen">&quot;Energy of boiling water&quot;</font>;
  Ev=Mv*(hvs+hout)/2-p*Vv <font color="darkgreen">&quot;Energy of superheated vapour&quot;</font>;
  <font color="red">der</font>(Ml) = win-wlb <font color="darkgreen">&quot;Liquid volume mass balance&quot;</font>;
  <font color="blue">if </font>hout&gt;hls<font color="blue"> then</font>
    <font color="red">der</font>(Mb) = wlb-wbv <font color="darkgreen">&quot;Boiling volume mass balance&quot;</font>;
  <font color="blue">else</font>
    <font color="red">der</font>(csil)=0;
  <font color="blue">end if</font>;
  <font color="blue">if </font>hout&gt;hvs<font color="blue"> then</font>
    <font color="red">der</font>(Mv) = wbv-wout <font color="darkgreen">&quot;Superheated volume mass balance&quot;</font>;
  <font color="blue">else</font>
    <font color="red">der</font>(csiv)=0;
  <font color="blue">end if</font>;
  <font color="red">der</font>(El) = win*hin-wlb*hlb-p*<font color="red">der</font>(Vl)+Ql <font color="darkgreen">&quot;Liquid volume energy balance&quot;</font>;
  <font color="blue">if </font>hout &gt; hls<font color="blue"> then</font>
    <font color="red">der</font>(Eb) = wlb*hlb-wbv*hbv-p*<font color="red">der</font>(Vb)+Qb <font color="darkgreen">&quot;Boiling volume energy balance&quot;</font>;
  <font color="blue">else</font>
    wlb=wout;
  <font color="blue">end if</font>;
  <font color="blue">if </font>hout&gt;hvs<font color="blue"> then</font>
    <font color="red">der</font>(Ev) = wbv*hbv-wout*hout-p*<font color="red">der</font>(Vv)+Qv <font color="darkgreen">
      &quot;Superheated volume energy balance&quot;</font>;
  <font color="blue">else</font>
    wbv=wout;
  <font color="blue">end if</font>;
  hlb=<font color="blue">if </font>(hout&gt;hls)<font color="blue"> then </font>hls<font color="blue"> else </font>hout <font color="darkgreen">
    &quot;Enthalpy at the liquid-boiling interface&quot;</font>;
  hbv=<font color="blue">if </font>(hout&gt;hvs)<font color="blue"> then </font>hvs<font color="blue"> else </font>hout <font color="darkgreen">
    &quot;Enthalpy at the boiling-vapour interface&quot;</font>;
  Tr=(Ml+Mb+Mv)/win <font color="darkgreen">&quot;Residence time&quot;</font>;

  <font color="darkgreen">// Fluid properties</font>
  sat.psat=p;
  sat.Tsat=<font color="red">Medium.saturationTemperature</font>(p);
  fluid_in.p=p;
  fluid_in.h=hin;
  fluid_out.p=p;
  fluid_out.h=hout;

  rhoin=fluid_in.d;
  rhoout=fluid_out.d;
  rhols=<font color="red">Medium.bubbleDensity</font>(sat);
  rhovs=<font color="red">Medium.dewDensity</font>(sat);
  hls=<font color="red">Medium.bubbleEnthalpy</font>(sat);
  hvs=<font color="red">Medium.dewEnthalpy</font>(sat);

  <font color="darkgreen">// Temporary boundary conditions</font>
  Q=Ql+Qb+Qv+win*hin-wout*hout-<font color="red">der</font>(El)-<font color="red">der</font>(Eb)-<font color="red">der</font>(Ev);
  M_flow=win-wout-<font color="red">der</font>(Ml)-<font color="red">der</font>(Mb)-<font color="red">der</font>(Mv);
<font color="blue">end </font>EvaporatorBase;
</PRE>
<HR>
<address>HTML-documentation generated by <a href="http://www.dynasim.se/">Dymola</a> Tue Jul 07 01:26:14 2009.
</address></BODY>
</HTML>
